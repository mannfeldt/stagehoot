(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{330:function(e,t,a){e.exports=a.p+"static/media/golfwood.f1bbe86f.wav"},331:function(e,t,a){e.exports=a.p+"static/media/golfwood2.ca14b160.wav"},332:function(e,t,a){e.exports=a.p+"static/media/golfwood3.38090044.wav"},333:function(e,t,a){e.exports=a.p+"static/media/golfiron.6846921d.wav"},334:function(e,t,a){e.exports=a.p+"static/media/golfiron2.535d13e9.wav"},335:function(e,t,a){e.exports=a.p+"static/media/golfiron3.f554f315.wav"},336:function(e,t,a){e.exports=a.p+"static/media/countdown.5c685d8c.wav"},337:function(e,t,a){e.exports=a.p+"static/media/golfclap.389fcba5.wav"},338:function(e,t,a){e.exports=a.p+"static/media/golfputt.464ec7d0.wav"},339:function(e,t,a){e.exports=a.p+"static/media/golfscore.f6affd73.wav"},347:function(e,t,a){e.exports=a.p+"static/media/driverIcon.664410f5.svg"},348:function(e,t,a){e.exports=a.p+"static/media/ironIcon.aff82a3f.svg"},349:function(e,t,a){e.exports=a.p+"static/media/putterIcon.017c75cd.svg"},350:function(e,t,a){e.exports=a.p+"static/media/golfbag.c7fbd966.svg"},351:function(e,t,a){e.exports=a.p+"static/media/fingerprint.deabfcc6.svg"},406:function(e,t,a){e.exports=a(807)},411:function(e,t,a){},413:function(e,t,a){},576:function(e,t,a){e.exports={cyanColor:"#66b1bb",redColor:"#EF9A9A",purpleColor:"#CE93D8",greenColor:"#9db484"}},798:function(e,t,a){},807:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(50),s=a.n(i),o=(a(411),a(5)),l=a(4),c=a(8),m=a(6),u=a(7),h=a(1),d=(a(413),a(810)),p=a(809),g=a(326),f=a.n(g),v=(a(419),a(421),f.a.initializeApp({apiKey:"AIzaSyB8vYoKiw2DlJycM5bqKKaU4vK_0n7HcsU",authDomain:"stagehoot.firebaseapp.com",databaseURL:"https://stagehoot.firebaseio.com",projectId:"stagehoot",storageBucket:"stagehoot.appspot.com",messagingSenderId:"589747985768"})),y=a(808),b=a(167),E=a.n(b),w=a(128),k=a.n(w),O=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e="Stagehoot";return"ettkilomjol-dev"===v.options.projectId&&(e="Ett Kilo Mj\xf6l DEV"),r.a.createElement("div",{id:"header"},r.a.createElement(E.a,{position:"static"},r.a.createElement(k.a,{className:"toolbar"},r.a.createElement("div",{className:"appbar-container--left"},r.a.createElement(y.a,{className:"appbar-title text-big",to:"/"},e)))))}}]),t}(n.Component),j=a(9),x=a.n(j),C=a(3),S=a(42),q=a.n(S),P=a(43),N=a.n(P),z=a(25),T=a(16),G=a(19),M=a.n(G),A=a(13),I=a.n(A),F=a(29),_=a.n(F),D=a(12),Q=a.n(D),B=a(11),L=a.n(B),W=a(30),K=a.n(W),R=a(69),H=a.n(R),V=a(49),U=a.n(V),Y=a(20),J=a.n(Y),Z=a(24),X=a.n(Z),$=a(22),ee=a(17),te=a.n(ee),ae=a(168),ne=a.n(ae),re=a(54),ie=a.n(re),se=a(63),oe=a.n(se),le=a(45),ce=a.n(le),me=a(46),ue=a.n(me),he=a(41),de=a.n(he),pe=a(328),ge=a.n(pe),fe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={expanded:!1},a.deleteQuestion=a.deleteQuestion.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"deleteQuestion",value:function(){this.props.deleteQuestion(this.props.question)}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(ne.a,{className:e.card},r.a.createElement(q.a,{action:r.a.createElement(ie.a,{onClick:this.deleteQuestion},r.a.createElement(ge.a,null)),title:this.props.question.question,subheader:this.props.question.timelimit?this.props.question.timelimit+" seconds":"default timelimit"}),r.a.createElement(N.a,null,r.a.createElement(oe.a,{variant:"subtitle1",align:"left"},"Correct answers"),r.a.createElement(ce.a,null,this.props.question.correctAnswers.map(function(e,t){return r.a.createElement(ue.a,{key:t},r.a.createElement(de.a,{primary:e}))})),r.a.createElement(oe.a,{variant:"subtitle1",align:"left"},"Wrong answers"),r.a.createElement(ce.a,null,this.props.question.wrongAnswers.map(function(e,t){return r.a.createElement(ue.a,{key:t},r.a.createElement(de.a,{primary:e}))}))))}}]),t}(n.Component),ve=Object($.withStyles)(function(e){return{card:{maxWidth:400}}})(fe),ye=a(100),be=a.n(ye),Ee=a(130),we=a.n(Ee);function ke(e){return"multiple"===e.aType||"boolean"===e.aType?10+Math.floor((e.correctAnswers.join().length+e.wrongAnswers.join().length)/30):"free"===e.aType?20:(e.aType,20)}function Oe(e){return(new DOMParser).parseFromString("<!doctype html><body>".concat(e),"text/html").body.textContent}function je(e){for(var t=[],a=0;a<e.length;a++)t.push(Oe(e[a]));return t}var xe,Ce,Se=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))},a.state={nrOfQuestions:"10",category:"0",difficulty:"0",aType:"0"},a.generateQuestions=a.generateQuestions.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"generateQuestions",value:function(){var e=this.state,t=e.nrOfQuestions,a=e.category,n=e.difficulty,r=e.aType,i=this.props,s=i.addQuestions,o=i.showSnackbar,l="https://opentdb.com/api.php?";"0"!==t&&(l+="amount=".concat(t)),"0"!==a&&(l+="&category=".concat(a)),"0"!==n&&(l+="&difficulty=".concat(n)),"0"!==r&&(l+="&type=".concat(r)),fetch(l).then(function(e){return e.json()}).then(function(e){if(0===e.response_code){for(var t=[],a=0;a<e.results.length;a++){var n=e.results[a],r={question:Oe(n.question),correctAnswers:[Oe(n.correct_answer)],wrongAnswers:je(n.incorrect_answers),qType:"text",aType:n.type,category:n.category,difficulty:n.difficulty};t.push(r)}s(t)}else{var i={variant:"error",message:"Could not generate questions( code: ".concat(e.response_code,")")};o(i)}})}},{key:"render",value:function(){var e=this.state,t=e.nrOfQuestions,a=e.category,n=e.difficulty,i=e.aType;return r.a.createElement("div",null,r.a.createElement(x.a,{container:!0},r.a.createElement(x.a,{item:!0,xs:12,md:6},r.a.createElement(L.a,{fullWidth:!0},r.a.createElement(M.a,{label:"Number of questions",name:"nrOfQuestions",value:t,margin:"normal",onChange:this.handleChange("nrOfQuestions")}))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,{fullWidth:!0},r.a.createElement(_.a,{htmlFor:"category"},"Category"),r.a.createElement(K.a,{value:a||"",onChange:this.handleChangeSelect,name:"category",inputProps:{id:"category"}},r.a.createElement(Q.a,{value:"0"},"Any category"),r.a.createElement(Q.a,{value:"9"},"General Knowledge"),r.a.createElement(Q.a,{value:"10"},"Entertainment: Books"),r.a.createElement(Q.a,{value:"11"},"Entertainment: Film"),r.a.createElement(Q.a,{value:"12"},"Entertainment: Music"),r.a.createElement(Q.a,{value:"13"},"Entertainment: Musicals and Theatres"),r.a.createElement(Q.a,{value:"14"},"Entertainment: Television"),r.a.createElement(Q.a,{value:"15"},"Entertainment: Video Games"),r.a.createElement(Q.a,{value:"16"},"Entertainment: Board Games"),r.a.createElement(Q.a,{value:"17"},"Science and Nature"),r.a.createElement(Q.a,{value:"18"},"Science: Computers"),r.a.createElement(Q.a,{value:"19"},"Science: Mathematics"),r.a.createElement(Q.a,{value:"20"},"Mythology"),r.a.createElement(Q.a,{value:"21"},"Sports"),r.a.createElement(Q.a,{value:"22"},"Geography"),r.a.createElement(Q.a,{value:"23"},"History"),r.a.createElement(Q.a,{value:"24"},"Politics"),r.a.createElement(Q.a,{value:"25"},"Art"),r.a.createElement(Q.a,{value:"26"},"Celebrities"),r.a.createElement(Q.a,{value:"27"},"Animals"),r.a.createElement(Q.a,{value:"28"},"Vehicles"),r.a.createElement(Q.a,{value:"29"},"Entertainment: Comics"),r.a.createElement(Q.a,{value:"30"},"Science: Gadgets"),r.a.createElement(Q.a,{value:"31"},"Entertainment: Japanese Anime and Manga"),r.a.createElement(Q.a,{value:"32"},"Entertainment: Cartoon and Animations")))),r.a.createElement(x.a,{item:!0,xs:12,md:6},r.a.createElement(L.a,{fullWidth:!0},r.a.createElement(_.a,{htmlFor:"difficulty"},"Difficulty"),r.a.createElement(K.a,{value:n||"",onChange:this.handleChangeSelect,name:"difficulty",inputProps:{id:"difficulty"}},r.a.createElement(Q.a,{value:"0"},"Any difficulty"),r.a.createElement(Q.a,{value:"easy"},"Easy"),r.a.createElement(Q.a,{value:"medium"},"Medium"),r.a.createElement(Q.a,{value:"hard"},"Hard")))),r.a.createElement(x.a,{item:!0,xs:12,md:6},r.a.createElement(L.a,{fullWidth:!0},r.a.createElement(_.a,{htmlFor:"aType"},"Answer type"),r.a.createElement(K.a,{value:i||"",onChange:this.handleChangeSelect,name:"aType",inputProps:{id:"aType"}},r.a.createElement(Q.a,{value:"0"},"Any type"),r.a.createElement(Q.a,{value:"multiple"},"Multiple choice"),r.a.createElement(Q.a,{value:"boolean"},"True/False")))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(I.a,{onClick:this.generateQuestions,variant:"contained"},"Generate"))))}}]),t}(n.Component),qe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.handleTrueFalse=function(e){var t=e.target.value;a.setState({correctAnswer:t,wrongAnswerOne:"true"===t?"false":"true"})},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))},a.state={question:"",correctAnswer:"",wrongAnswerOne:"",wrongAnswerTwo:"",wrongAnswerThree:"",timelimit:"10",qType:"text",aType:"multiple",generateQuestions:!0},a.sendQuestion=a.sendQuestion.bind(Object(h.a)(Object(h.a)(a))),a.toggleGenerateQuestion=a.toggleGenerateQuestion.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"sendQuestion",value:function(){var e=this.state,t=e.question,a=e.correctAnswer,n=e.wrongAnswerOne,r=e.wrongAnswerTwo,i=e.wrongAnswerThree,s=e.timelimit,o=e.qType,l=e.aType,c=this.props.addQuestion,m={question:t,correctAnswers:[a],wrongAnswers:[n,r,i],timelimit:s,qType:o,aType:l};this.setState({question:"",correctAnswer:"",wrongAnswerOne:"",wrongAnswerTwo:"",wrongAnswerThree:""}),c(m)}},{key:"toggleGenerateQuestion",value:function(){var e=this.state.generateQuestions;this.setState({generateQuestions:!e})}},{key:"render",value:function(){var e=this.state,t=e.question,a=e.correctAnswer,n=e.wrongAnswerOne,i=e.wrongAnswerTwo,s=e.wrongAnswerThree,o=e.timelimit,l=e.qType,c=e.aType,m=e.generateQuestions,u=this.props,h=u.addQuestions,d=u.showSnackbar,p=u.isTimelimit;return m?r.a.createElement("div",null,r.a.createElement(I.a,{onClick:this.toggleGenerateQuestion,variant:"contained"},"Custom questions"),r.a.createElement(I.a,{onClick:this.toggleGenerateQuestion,disabled:!0,variant:"contained"},"Auto generate questions"),r.a.createElement(Se,{addQuestions:h,showSnackbar:d})):r.a.createElement("div",null,r.a.createElement(x.a,{container:!0},r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(I.a,{onClick:this.toggleGenerateQuestion,disabled:!0,variant:"contained"},"Custom questions"),r.a.createElement(I.a,{onClick:this.toggleGenerateQuestion,variant:"contained"},"Auto generate questions")),r.a.createElement(x.a,{item:!0,xs:12,md:12},r.a.createElement(L.a,{required:!0,fullWidth:!0},r.a.createElement(_.a,{htmlFor:"qtype-required"},"Question type"),r.a.createElement(K.a,{value:l||"",onChange:this.handleChangeSelect,name:"qType",inputProps:{id:"qtype-required"}},r.a.createElement(Q.a,{value:"text"},"Text"),r.a.createElement(Q.a,{value:"image"},"Image"),r.a.createElement(Q.a,{value:"video"},"Video")))),r.a.createElement(x.a,{item:!0,xs:12,md:12},r.a.createElement(L.a,{required:!0,fullWidth:!0},r.a.createElement(_.a,{htmlFor:"aType-required"},"Answer type"),r.a.createElement(K.a,{value:c||"",onChange:this.handleChangeSelect,name:"aType",inputProps:{id:"aType-required"}},r.a.createElement(Q.a,{value:"boolean"},"True/false"),r.a.createElement(Q.a,{value:"player"},"Player"),r.a.createElement(Q.a,{value:"multiple"},"Mulitichoice"),r.a.createElement(Q.a,{value:"free"},"Free text")))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,{fullWidth:!0},r.a.createElement(M.a,{label:"Question",name:"question",value:t,margin:"normal",onChange:this.handleChange("question")}))),"multiple"===c&&r.a.createElement(x.a,{container:!0},r.a.createElement(x.a,{item:!0,xs:12,md:6},r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Correct answer",name:"correctAnswer",margin:"normal",value:a,onChange:this.handleChange("correctAnswer")}))),r.a.createElement(x.a,{item:!0,xs:12,md:6},r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Wrong answer",name:"wrongAnswerOne",margin:"normal",value:n,onChange:this.handleChange("wrongAnswerOne")}))),r.a.createElement(x.a,{item:!0,xs:12,md:6},r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Wrong answer",name:"wrongAnswerTwo",margin:"normal",value:i,onChange:this.handleChange("wrongAnswerTwo")}))),r.a.createElement(x.a,{item:!0,xs:12,md:6},r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Wrong answer",name:"wrongAnswerThree",margin:"normal",value:s,onChange:this.handleChange("wrongAnswerThree")})))),"boolean"===c&&r.a.createElement("div",null,r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(H.a,{component:"legend"},"Answer"),r.a.createElement(we.a,{"aria-label":"answer",name:"correctAnswer",value:a,onChange:this.handleTrueFalse},r.a.createElement(J.a,{value:"true",control:r.a.createElement(be.a,null),label:"True"}),r.a.createElement(J.a,{value:"false",control:r.a.createElement(be.a,null),label:"False"}))))),p&&r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Time limit",name:"timelimit",type:"number",value:o,margin:"normal",onChange:this.handleChange("timelimit")}))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(I.a,{onClick:this.sendQuestion,variant:"contained"},"Add question"))))}}]),t}(n.Component),Pe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.handleChangeBool=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.checked))}},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))},a.state={title:"",gametype:"quiz",gamemode:"normal",timelimit:!0,timescore:!1,questions:[],gamePass:""},a.addQuestion=a.addQuestion.bind(Object(h.a)(Object(h.a)(a))),a.addQuestions=a.addQuestions.bind(Object(h.a)(Object(h.a)(a))),a.deleteQuestion=a.deleteQuestion.bind(Object(h.a)(Object(h.a)(a))),a.createQuiz=a.createQuiz.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"addQuestion",value:function(e){var t=this.state,a=t.questions,n=t.timelimit,r=this.props.showSnackbar,i=e;0===a.length?i.id=1:i.id=Math.max.apply(Math,Object(z.a)(a.map(function(e){return e.id})))+1,n&&!i.timelimit&&(i.timelimit=ke(i)),a.push(i),this.setState({questions:a});r({variant:"success",message:"Added question"})}},{key:"addQuestions",value:function(e){for(var t=this.state,a=t.questions,n=t.timelimit,r=this.props.showSnackbar,i=0;i<e.length;i++){var s=e[i];0===a.length?s.id=1:s.id=Math.max.apply(Math,Object(z.a)(a.map(function(e){return e.id})))+1,n&&!s.timelimit&&(s.timelimit=ke(s)),a.push(s)}this.setState({questions:a});r({variant:"success",message:"Added questions"})}},{key:"deleteQuestion",value:function(e){var t=this.state.questions,a=t.map(function(e){return e.id}).indexOf(e.id);t.splice(a,1),this.setState({questions:t})}},{key:"createQuiz",value:function(){var e=this.props.createQuiz,t=this.state,a=t.timelimit;e({password:t.gamePass,gametype:t.gametype,tile:t.title,quiz:{gamemode:"normal",timelimit:a,timescore:t.timescore,questions:t.questions}})}},{key:"render",value:function(){var e=this,t=this.state,a=t.timelimit,n=t.gamePass,i=t.title,s=t.timescore,o=t.gamemode,l=t.questions,c=this.props.showSnackbar;return r.a.createElement("div",{className:"app-page create-page"},r.a.createElement(x.a,{container:!0,spacing:8},r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(C.b,{variant:"h4"},"New quiz")),r.a.createElement(x.a,{item:!0,xs:12,md:6},r.a.createElement("form",{autoComplete:"off"},r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,{required:!0,fullWidth:!0},r.a.createElement(_.a,{htmlFor:"gametype-required"},"Gamemode"),r.a.createElement(K.a,{value:o||"",onChange:this.handleChangeSelect,name:"gamemode",inputProps:{id:"gamemode-required"}},r.a.createElement(Q.a,{value:"normal"},"Normal"),r.a.createElement(Q.a,{value:"wild"},"Wild")))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(H.a,{component:"legend"},"Game options"),r.a.createElement(U.a,null,r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:a,onChange:this.handleChangeBool("timelimit"),value:"timelimit"}),label:"Time limited questions"}),r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:s,onChange:this.handleChangeBool("timescore"),value:"timescore"}),label:"Time based score"})))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Title",name:"title",value:i,margin:"normal",onChange:this.handleChange("title")})),r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Password",type:"password",name:"gamePass",margin:"normal",value:n,onChange:this.handleChange("gamePass")}))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(I.a,{onClick:this.createQuiz,variant:"contained"},"Create quiz")))),r.a.createElement(x.a,{item:!0,xs:12,md:6},r.a.createElement(qe,{addQuestions:this.addQuestions,addQuestion:this.addQuestion,isTimelimit:!!a,showSnackbar:c})),r.a.createElement(x.a,{container:!0},l.map(function(t,a){return r.a.createElement(x.a,{item:!0,xs:12,md:6,key:t.id},r.a.createElement(ve,{question:t,transitionDelay:a,deleteQuestion:e.deleteQuestion}))}))))}}]),t}(n.Component),Ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.handleChangeBool=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.checked))}},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))},a.state={title:"",gametype:"tetris",gamemode:"survival",password:""},a.validateGame=a.validateGame.bind(Object(h.a)(Object(h.a)(a))),a.createGame=a.createGame.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"createGame",value:function(){var e=this.props.createGame,t=this.state;e({password:t.password,gametype:t.gametype,title:t.title,minigame:{gamemode:t.gamemode}})}},{key:"render",value:function(){var e=this.state,t=e.password,a=e.title,n=e.gamemode;return r.a.createElement("div",{className:"app-page create-page"},r.a.createElement(x.a,{container:!0,spacing:8},r.a.createElement("form",{autoComplete:"off"},r.a.createElement(x.a,{item:!0,xs:4},r.a.createElement(L.a,{required:!0},r.a.createElement(_.a,{htmlFor:"gametype-required"},"Game mode"),r.a.createElement(K.a,{value:n||"",onChange:this.handleChangeSelect,name:"gamemode",inputProps:{id:"gamemode-required"}},r.a.createElement(Q.a,{value:"survival"},"Survival"),r.a.createElement(Q.a,{value:"race"},"Race"))),r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Title",name:"title",value:a,margin:"normal",onChange:this.handleChange("title")})),r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Password",type:"password",name:"password",margin:"normal",value:t,onChange:this.handleChange("password")})),r.a.createElement(I.a,{onClick:this.createGame,variant:"contained"},"Create")))))}}]),t}(n.Component),ze=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.handleChangeBool=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.checked))}},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))},a.state={title:"",gametype:"golf",holes:18,scoremode:"strokes",speedmode:!0,opponentCollision:!1,password:""},a.createGame=a.createGame.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"createGame",value:function(){var e=this.props.createGame,t=this.state,a=t.password,n=t.gametype,r=t.title,i=t.holes;e({password:a,gametype:n,title:r,minigame:{scoremode:t.scoremode,speedmode:t.speedmode,holes:i}})}},{key:"render",value:function(){var e=this.state,t=e.password,a=e.title,n=e.holes,i=e.scoremode,s=e.speedmode;return r.a.createElement("div",{className:"app-page create-page"},r.a.createElement(x.a,{container:!0,spacing:24},r.a.createElement("form",{autoComplete:"off"},r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(C.b,{variant:"h4"},"New Golf game")),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,{required:!0,fullWidth:!0},r.a.createElement(_.a,{htmlFor:"scoremode-required"},"Score mode"),r.a.createElement(K.a,{value:i||"",fullWidth:!0,onChange:this.handleChangeSelect,name:"scoremode",inputProps:{id:"scoremode-required"}},r.a.createElement(Q.a,{value:"strokes"},"Strokes"),r.a.createElement(Q.a,{value:"time"},"Time"),r.a.createElement(Q.a,{value:"compedetive"},"Compedetive")))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Holes to play",name:"holes",type:"number",value:n,margin:"normal",onChange:this.handleChange("holes")}))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:s,onChange:this.handleChangeBool("speedmode"),value:"speedmode"}),label:"Speed mode"}))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Title",name:"title",value:a,margin:"normal",onChange:this.handleChange("title")})),r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Password",type:"password",name:"password",margin:"normal",value:t,onChange:this.handleChange("password")}))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(I.a,{onClick:this.createGame,variant:"contained"},"Create")))))}}]),t}(n.Component),Te=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.handleChangeBool=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.checked))}},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))},a.state={title:"",gametype:"snake",gamemode:"survival",racetarget:20,opponentCollision:!1,eatOpponents:!1,wallCollision:!0,password:"",difficulty:"300"},a.createGame=a.createGame.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"createGame",value:function(){var e=this.props.createGame,t=this.state,a=t.password,n=t.gametype,r=t.title,i=t.gamemode,s=t.wallCollision,o=t.opponentCollision;e({password:a,gametype:n,title:r,minigame:{gamemode:i,wallCollision:s,eatOpponents:t.eatOpponents,opponentCollision:o,racetarget:t.racetarget,difficulty:t.difficulty}})}},{key:"render",value:function(){var e=this.state,t=e.password,a=e.title,n=e.gamemode,i=e.wallCollision,s=e.opponentCollision,o=e.eatOpponents,l=e.racetarget,c=e.difficulty;return r.a.createElement("div",{className:"app-page create-page"},r.a.createElement(x.a,{container:!0,spacing:24},r.a.createElement("form",{autoComplete:"off"},r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(C.b,{variant:"h4"},"New Snake game")),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,{required:!0,fullWidth:!0},r.a.createElement(_.a,{htmlFor:"gametype-required"},"Game mode"),r.a.createElement(K.a,{value:n||"",fullWidth:!0,onChange:this.handleChangeSelect,name:"gamemode",inputProps:{id:"gamemode-required"}},r.a.createElement(Q.a,{value:"survival"},"Survival"),r.a.createElement(Q.a,{value:"race"},"Race")))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,{required:!0,fullWidth:!0},r.a.createElement(_.a,{htmlFor:"gametype-required"},"difficulty"),r.a.createElement(K.a,{value:c||"",fullWidth:!0,onChange:this.handleChangeSelect,name:"difficulty",inputProps:{id:"difficulty-required"}},r.a.createElement(Q.a,{value:"500"},"Easy"),r.a.createElement(Q.a,{value:"300"},"Medium"),r.a.createElement(Q.a,{value:"100"},"Hard"),r.a.createElement(Q.a,{value:"75"},"Pro")))),r.a.createElement(x.a,{item:!0,xs:12},"race"===n&&r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Snake length",name:"racetarget",type:"number",value:l,margin:"normal",onChange:this.handleChange("racetarget")}))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:i,onChange:this.handleChangeBool("wallCollision"),value:"wallCollision"}),label:"Wall collisions"})),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:s,onChange:this.handleChangeBool("opponentCollision"),value:"opponentCollision"}),label:"Opponent collisions"})),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:s&&o,disabled:!s,onChange:this.handleChangeBool("eatOpponents"),value:"eatOpponents"}),label:"Eat opponent on collision"}))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Title",name:"title",value:a,margin:"normal",onChange:this.handleChange("title")})),r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Password",type:"password",name:"password",margin:"normal",value:t,onChange:this.handleChange("password")}))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(I.a,{onClick:this.createGame,variant:"contained"},"Create")))))}}]),t}(n.Component),Ge=a(64),Me=a.n(Ge),Ae=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.handleChangeBool=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.checked))}},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))},a.state={title:"",gametype:"spotify",questions:18,password:"",autoplay:!0,qFeatures:!0,qSize:!0,qTrackOwner:!0,qArtist:!0,qGenre:!0},a.createGame=a.createGame.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"createGame",value:function(){var e=this.props.createGame,t=this.state,a=t.password,n=t.gametype,r=t.title,i=t.questions,s=t.qArtist,o=t.qFeatures,l=t.qSize,c=t.qTrackOwner,m=t.qGenre;e({password:a,gametype:n,title:r,minigame:{autoplay:t.autoplay,questions:i,qGenre:m,qArtist:s,qFeatures:o,qSize:l,qTrackOwner:c}})}},{key:"render",value:function(){var e=this.state,t=e.password,a=e.title,n=e.questions,i=e.qTrackOwner,s=e.qArtist,o=e.qFeatures,l=e.qSize,c=e.qGenre,m=e.autoplay;return r.a.createElement("div",{className:"app-page create-page"},r.a.createElement(x.a,{container:!0,spacing:24},r.a.createElement("form",{autoComplete:"off"},r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(C.b,{variant:"h4"},"New Spotify game")),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"questions to play",name:"questions",type:"number",value:n,margin:"normal",onChange:this.handleChange("questions")}))),r.a.createElement(C.b,{variant:"h5"},"Question types"),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(Me.a,{checked:i,onChange:this.handleChangeBool("qTrackOwner"),value:"qTrackOwner"}),label:"Tracks"})),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(Me.a,{checked:o,onChange:this.handleChangeBool("qFeatures"),value:"qFeatures"}),label:"Features"})),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(Me.a,{checked:s,onChange:this.handleChangeBool("qArtist"),value:"qArtist"}),label:"Artist"})),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(Me.a,{checked:c,onChange:this.handleChangeBool("qGenre"),value:"qGenre"}),label:"Genres"})),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(Me.a,{checked:l,onChange:this.handleChangeBool("qSize"),value:"qSize"}),label:"Playlist size"}))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:m,onChange:this.handleChangeBool("autoplay"),value:"autoplay"}),label:"Autoplay questions"})),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Title",name:"title",value:a,margin:"normal",onChange:this.handleChange("title")})),r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Password",type:"password",name:"password",margin:"normal",value:t,onChange:this.handleChange("password")}))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(I.a,{onClick:this.createGame,variant:"contained"},"Create")))))}}]),t}(n.Component),Ie=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).setGameType=function(e){return function(t){a.setState({gametype:e})}},a.state={gametype:""},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.createGame,t=this.state.gametype;return r.a.createElement("div",{className:"app-page create-page"},!t&&r.a.createElement(x.a,{container:!0,spacing:24},r.a.createElement(x.a,{item:!0,xs:6},r.a.createElement(C.a,{className:"card-button",onClick:this.setGameType("snake")},r.a.createElement(q.a,{title:"Snake"}),r.a.createElement(N.a,null,r.a.createElement(C.b,{variant:"subtitle1",align:"center"},"Create a classic game of snake or change the modes to fit your audience")))),r.a.createElement(x.a,{item:!0,xs:6},r.a.createElement(C.a,{className:"card-button",onClick:this.setGameType("tetris")},r.a.createElement(q.a,{title:"Tetris"}),r.a.createElement(N.a,null,r.a.createElement(C.b,{variant:"subtitle1",align:"center"},"Game is not available yet")))),r.a.createElement(x.a,{item:!0,xs:6},r.a.createElement(C.a,{className:"card-button",onClick:this.setGameType("golf")},r.a.createElement(q.a,{title:"Golf"}),r.a.createElement(N.a,null,r.a.createElement(C.b,{variant:"subtitle1",align:"center"},"Create a multiplayer golf simulation game")))),r.a.createElement(x.a,{item:!0,xs:6},r.a.createElement(C.a,{className:"card-button",onClick:this.setGameType("spotify")},r.a.createElement(q.a,{title:"Spotify"}),r.a.createElement(N.a,null,r.a.createElement(C.b,{variant:"subtitle1",align:"center"},"Get to know your friends Music taste"))))),"snake"===t&&r.a.createElement(Te,{createGame:e}),"tetris"===t&&r.a.createElement(Ne,{createGame:e}),"golf"===t&&r.a.createElement(ze,{createGame:e}),"spotify"===t&&r.a.createElement(Ae,{createGame:e}))}}]),t}(n.Component),Fe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).setGameType=function(e){return function(){a.setState({gametype:e})}},a.state={gametype:"",gameId:""},a.createGame=a.createGame.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"createGame",value:function(e){var t=e;t.gameId=function(){for(var e="",t="ABCDEFGHJKLMNOPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz0123456789",a=0;a<6;a++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}(),t.created=Date.now(),t.status="CREATED",t.phase="setup";var a=this,n=v.database().ref("/games").push();t.key=n.key,n.set(t,function(e){if(e){a.setState({errorText:"Error: ".concat(e)});a.props.showSnackbar({variant:"error",message:"Unexpected internal error"})}else{a.props.showSnackbar({variant:"success",message:"Successfully created!"}),a.setState({gameId:t.gameId,gametype:"done"}),localStorage.setItem("RecentGameId",t.gameId)}})}},{key:"render",value:function(){var e=this.state,t=e.gametype,a=e.gameId,n=this.props.showSnackbar;return r.a.createElement("div",{className:"app-page create-page"},!t&&r.a.createElement(x.a,{container:!0,spacing:24},r.a.createElement(x.a,{item:!0,xs:6},r.a.createElement(C.a,{className:"card-button",onClick:this.setGameType("quiz")},r.a.createElement(q.a,{title:"Quiz"}),r.a.createElement(N.a,null,r.a.createElement(C.b,{variant:"subtitle1",align:"center"},"Create your own quiz or generate one fast and easy")))),r.a.createElement(x.a,{item:!0,xs:6},r.a.createElement(C.a,{className:"card-button",onClick:this.setGameType("minigame")},r.a.createElement(q.a,{title:"Mini Game"}),r.a.createElement(N.a,null,r.a.createElement(C.b,{variant:"subtitle1",align:"center"},"Create a game to play just for fun or team building purposes")))),r.a.createElement(x.a,{item:!0,xs:6},r.a.createElement(C.a,{className:"card-button",onClick:this.setGameType("survey")},r.a.createElement(q.a,{title:"Survey"}),r.a.createElement(N.a,null,r.a.createElement(C.b,{variant:"subtitle1",align:"center"},"Survey your audience")))),r.a.createElement(x.a,{item:!0,xs:6},r.a.createElement(C.a,{className:"card-button",onClick:this.setGameType("discussion")},r.a.createElement(q.a,{title:"Discussion"}),r.a.createElement(N.a,null,r.a.createElement(C.b,{variant:"subtitle1",align:"center"},"Create a discussion on a sppecified topic"))))),"quiz"===t&&r.a.createElement(Pe,{createQuiz:this.createGame,showSnackbar:n}),"minigame"===t&&r.a.createElement(Ie,{createGame:this.createGame,showSnackbar:n}),"done"===t&&r.a.createElement("div",null,r.a.createElement(C.b,{variant:"h2"},r.a.createElement("span",null,"Created game PIN: ")," ",r.a.createElement("span",{className:"dynamic-text"},a)),r.a.createElement(y.a,{to:"/host"},"Host game")))}}]),t}(n.Component),_e=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChangeBool=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.checked))}},a.state={surveyPlayers:!1,answerStreak:!0,nameGenerator:!1,remoteMode:!1,useTeams:!1,randomizeQuestionOrder:!1,autoPlayQuestions:!1},a.startGame=a.startGame.bind(Object(h.a)(Object(h.a)(a))),a.createTeamGame=a.createTeamGame.bind(Object(h.a)(Object(h.a)(a))),a.createClassicGame=a.createClassicGame.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"createTeamGame",value:function(){this.startGame(!0)}},{key:"createClassicGame",value:function(){this.startGame(!1)}},{key:"startGame",value:function(e){var t={},a=this.props.game.quiz;a.surveyPlayers=this.state.surveyPlayers,a.answerStreak=this.state.answerStreak,a.nameGenerator=this.state.nameGenerator,a.remoteMode=this.state.remoteMode,a.useTeams=e,a.autoPlayQuestions=this.state.autoPlayQuestions,a.randomizeQuestionOrder=this.state.randomizeQuestionOrder,a.currentQuestion=0,t.quiz=a,t.phase="connection",t.status="IN_PROGRESS",this.props.gameFunc.update(t)}},{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},r.a.createElement(C.b,{variant:"h4"},"Game Settings"),r.a.createElement(I.a,{onClick:this.createClassicGame,variant:"contained"},"Classic"),r.a.createElement(I.a,{onClick:this.createTeamGame,variant:"contained"},"Team mode"),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(U.a,null,r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:this.state.nameGenerator,onChange:this.handleChangeBool("nameGenerator"),value:"nameGenerator"}),label:"Generate names for players"}),r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:this.state.remoteMode,onChange:this.handleChangeBool("remoteMode"),value:"remoteMode"}),label:"Remote playmode"}),r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:this.state.answerStreak,onChange:this.handleChangeBool("answerStreak"),value:"answerStreak"}),label:"Use answer scorestreak"}),r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:this.state.surveyPlayers,onChange:this.handleChangeBool("surveyPlayers"),value:"surveyPlayers"}),label:"Survey players after game"}),r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:this.state.randomizeQuestionOrder,onChange:this.handleChangeBool("randomizeQuestionOrder"),value:"randomizeQuestionOrder"}),label:"Randomize question order"}),r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:this.state.autoPlayQuestions,onChange:this.handleChangeBool("autoPlayQuestions"),value:"autoPlayQuestions"}),label:"Auto play questions"}))))}}]),t}(n.Component),De=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"nextPhase",value:function(){this.props.gameFunc.update({phase:"starting"})}},{key:"render",value:function(){var e=this.props.game.players;return e=e?Object.values(e):[],r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(C.b,{variant:"h2"},r.a.createElement("span",null,"Join game at: "),r.a.createElement("span",{className:"dynamic-text"},"mannfeldt.github.io/stagehoot")),r.a.createElement(C.b,{variant:"h2"},r.a.createElement("span",null,"Enter game PIN: "),r.a.createElement("span",{className:"dynamic-text"},this.props.game.gameId)),r.a.createElement(C.b,{variant:"subtitle1"},this.props.game.title)),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(x.a,{container:!0},e.map(function(e,t){return r.a.createElement(x.a,{key:t,item:!0,xs:3},r.a.createElement(C.b,{paragraph:!0,variant:"body1",className:"dynamic-text"},e.name))}))),r.a.createElement("div",{className:"quiz-bottom-section"},r.a.createElement(I.a,{onClick:this.nextPhase,variant:"contained"},"Start")))}}]),t}(n.Component),Qe=(a(576),function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return"slow"===this.props.speed?r.a.createElement("div",{className:"demo_slow"},r.a.createElement("div",{className:"demo_slow__colored-blocks"},r.a.createElement("div",{className:"demo_slow__colored-blocks-rotater"},r.a.createElement("div",{className:"demo_slow__colored-block"}),r.a.createElement("div",{className:"demo_slow__colored-block"}),r.a.createElement("div",{className:"demo_slow__colored-block"}),r.a.createElement("div",{className:"demo_slow__colored-block"})),r.a.createElement("div",{className:"demo_slow__colored-blocks-inner"}),r.a.createElement("div",{className:"demo_slow__text"},"Ready")),r.a.createElement("div",{className:"demo_slow__inner"},r.a.createElement("svg",{className:"demo_slow__numbers",viewBox:"0 0 100 100"},r.a.createElement("defs",null,r.a.createElement("path",{className:"demo_slow__num-path-1",d:"M40,28 55,22 55,78"}),r.a.createElement("path",{className:"demo_slow__num-join-1-2",d:"M55,78 55,83 a17,17 0 1,0 34,0 a20,10 0 0,0 -20,-10"}),r.a.createElement("path",{className:"demo_slow__num-path-2",d:"M69,73 l-35,0 l30,-30 a16,16 0 0,0 -22.6,-22.6 l-7,7"}),r.a.createElement("path",{className:"demo_slow__num-join-2-3",d:"M28,69 Q25,44 34.4,27.4"}),r.a.createElement("path",{className:"demo_slow__num-path-3",d:"M30,20 60,20 40,50 a18,15 0 1,1 -12,19"})),r.a.createElement("path",{className:"demo_slow__numbers-path",d:"M-10,20 60,20 40,50 a18,15 0 1,1 -12,19\r Q25,44 34.4,27.4\r l7,-7 a16,16 0 0,1 22.6,22.6 l-30,30 l35,0 L69,73\r a20,10 0 0,1 20,10 a17,17 0 0,1 -34,0 L55,83\r l0,-61 L40,28"})))):r.a.createElement("div",{className:"demo"},r.a.createElement("div",{className:"demo__colored-blocks"},r.a.createElement("div",{className:"demo__colored-blocks-rotater"},r.a.createElement("div",{className:"demo__colored-block"}),r.a.createElement("div",{className:"demo__colored-block"}),r.a.createElement("div",{className:"demo__colored-block"}),r.a.createElement("div",{className:"demo__colored-block"})),r.a.createElement("div",{className:"demo__colored-blocks-inner"}),r.a.createElement("div",{className:"demo__text"},"Ready")),r.a.createElement("div",{className:"demo__inner"},r.a.createElement("svg",{className:"demo__numbers",viewBox:"0 0 100 100"},r.a.createElement("defs",null,r.a.createElement("path",{className:"demo__num-path-1",d:"M40,28 55,22 55,78"}),r.a.createElement("path",{className:"demo__num-join-1-2",d:"M55,78 55,83 a17,17 0 1,0 34,0 a20,10 0 0,0 -20,-10"}),r.a.createElement("path",{className:"demo__num-path-2",d:"M69,73 l-35,0 l30,-30 a16,16 0 0,0 -22.6,-22.6 l-7,7"}),r.a.createElement("path",{className:"demo__num-join-2-3",d:"M28,69 Q25,44 34.4,27.4"}),r.a.createElement("path",{className:"demo__num-path-3",d:"M30,20 60,20 40,50 a18,15 0 1,1 -12,19"})),r.a.createElement("path",{className:"demo__numbers-path",d:"M-10,20 60,20 40,50 a18,15 0 1,1 -12,19\r Q25,44 34.4,27.4\r l7,-7 a16,16 0 0,1 22.6,22.6 l-30,30 l35,0 L69,73\r a20,10 0 0,1 20,10 a17,17 0 0,1 -34,0 L55,83\r l0,-61 L40,28"}))))}}]),t}(n.PureComponent)),Be=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={counter:a.startCounter()},a.nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"startCounter",value:function(){var e=this,t=5,a=setInterval(function(){t--,e.setState({counter:t}),0===t&&(e.nextPhase(),clearInterval(a))},1e3);return 5}},{key:"nextPhase",value:function(){this.props.gameFunc.update({phase:"awaiting_question"})}},{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},r.a.createElement(C.b,{variant:"h2"},"Starting quiz"),r.a.createElement(Qe,{speed:"slow"}))}}]),t}(n.Component),Le=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={counter:a.startCounter()},a.nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"startCounter",value:function(){var e=this,t=5,a=setInterval(function(){t--,e.setState({counter:t}),0===t&&(e.nextPhase(),clearInterval(a))},1e3);return 5}},{key:"nextPhase",value:function(){this.props.gameFunc.update({phase:"show_question"})}},{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},r.a.createElement(C.b,{variant:"h2"},"Loading next question"),r.a.createElement(Qe,{speed:"slow"}))}}]),t}(n.Component),We=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={question:""},a.nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.game.quiz.questions[this.props.game.quiz.currentQuestion];this.setState({question:e});var t=3e3+20*e.question.length;setTimeout(this.nextPhase,t)}},{key:"nextPhase",value:function(){var e=[];if("multiple"===this.state.question.aType?(e=this.state.question.wrongAnswers.concat(this.state.question.correctAnswers),e=this.shuffle(e)):"boolean"===this.state.question.aType&&(e=["True","False"]),e.length){var t={phase:"answer"};t.quiz=this.props.game.quiz,t.quiz.questions[t.quiz.currentQuestion].answers=e,this.props.gameFunc.update(t)}else this.props.gameFunc.update({phase:"answer"})}},{key:"shuffle",value:function(e){for(var t=e.length;t>0;){var a=Math.floor(Math.random()*t),n=e[--t];e[t]=e[a],e[a]=n}return e}},{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(C.b,{variant:"h2"},this.state.question.question)),r.a.createElement("div",{className:"quiz-middle-section"}),r.a.createElement("div",{className:"quiz-bottom-section"}))}}]),t}(n.Component),Ke=a(62),Re=a.n(Ke),He=a(173),Ve=a.n(He),Ue=a(175),Ye=a.n(Ue),Je=a(174),Ze=a.n(Je),Xe=a(176),$e=a.n(Xe),et=[{icon:r.a.createElement(Ve.a,null),color:"#73c7d2"},{icon:r.a.createElement(Ze.a,null),color:"#d78a8a"},{icon:r.a.createElement(Ye.a,null),color:"#b984c2"},{icon:r.a.createElement($e.a,null),color:"#b1ca94"}],tt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=et[this.props.index],a=this.props.classes;return r.a.createElement("div",{className:"full-height"},this.props.answerQuestion&&r.a.createElement(Re.a,{onClick:function(){e.props.answerQuestion(e.props.answer)},className:a.playAnswer,style:{backgroundColor:t.color}},r.a.createElement("div",{className:"button-answer-icon"},t.icon),this.props.remoteMode&&r.a.createElement("div",{className:a.answer},this.props.answer)),!this.props.answerQuestion&&r.a.createElement(Re.a,{className:a.paper,style:{backgroundColor:t.color}},r.a.createElement("div",{className:a.icon},t.icon),r.a.createElement("div",{className:a.answer},this.props.answer)))}}]),t}(n.Component),at=Object($.withStyles)(function(e){return{root:{flexGrow:1},paper:{paddingTop:2*e.spacing.unit,paddingBottom:2*e.spacing.unit,textAlign:"center",color:e.palette.text.secondary,height:"100%"},playAnswer:{width:"50vw",height:"100%",textAlign:"center",color:e.palette.text.secondary},icon:{float:"left",fontSize:"28",color:"white",marginLeft:"10px"},answer:{fontSize:18,fontWeight:500,color:"white"}}})(tt),nt=a(169),rt=a.n(nt),it=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.text,n=e.value,i=e.startValue,s=null===n?i:n;s<0&&(s=0);var o=s/(i<1?0:i);return r.a.createElement("div",{className:t.container},r.a.createElement(C.b,{variant:"caption",className:t.text},a),r.a.createElement(rt.a,{className:t.circle,classes:{colorSecondary:t.circle},variant:"static",value:100*o,thickness:4,size:300}))}}]),t}(n.PureComponent),st=Object($.withStyles)(function(e){return{text:{marginBottom:"-200px",fontSize:"86px",paddingTop:"160px"},circle:{color:"#6JpDK4"}}})(it),ot=a(101),lt=a.n(ot),ct=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",null,r.a.createElement(C.b,{variant:"h5"},"Answers collected"),r.a.createElement(lt.a,{className:e.bar,variant:"determinate",value:this.props.value}))}}]),t}(n.Component),mt=Object($.withStyles)(function(e){return{bar:{color:"#32386D"}}})(ct),ut=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={counter:null,timelimit:0,started:!1,isTimelimited:!0,question:{question:"",answers:[]}},a.nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.game.quiz.questions[this.props.game.quiz.currentQuestion];if(this.setState({question:t,isTimelimited:this.props.game.quiz.timelimit,timelimit:10*t.timelimit}),this.props.game.quiz.timelimit)var a=this.props.game.players?Object.keys(this.props.game.players):[],n=10*t.timelimit,r=setInterval(function(){for(var i=0,s=0;s<a.length;s++)e.props.game.players[a[s]].answers&&e.props.game.players[a[s]].answers[t.id]&&i++;n--,e.setState({counter:n,started:!0}),(n<=-5||i===a.length)&&(e.nextPhase(),clearInterval(r))},100)}},{key:"nextPhase",value:function(){this.props.gameFunc.update({phase:"result_question"})}},{key:"render",value:function(){var e=[];this.props.game&&(e=this.props.game.quiz.questions[this.props.game.quiz.currentQuestion].answers);for(var t=0,a=this.props.game.players?Object.keys(this.props.game.players):[],n=0;n<a.length;n++)this.props.game.players[a[n]].answers&&this.props.game.players[a[n]].answers[this.props.game.quiz.questions[this.props.game.quiz.currentQuestion].id]&&t++;var i=t/a.length*100;return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(C.b,{variant:"h2"},this.state.question.question)),r.a.createElement("div",{className:"quiz-middle-section"},!this.state.isTimelimited&&r.a.createElement(I.a,{onClick:this.nextPhase},"Next"),this.state.isTimelimited&&r.a.createElement(st,{startValue:this.state.timelimit,value:this.state.counter,text:Math.ceil(this.state.counter/10)}),r.a.createElement("div",{className:"quiz-answercounter-container"},r.a.createElement(mt,{value:i}))),r.a.createElement("div",{className:"quiz-bottom-section"},r.a.createElement(x.a,{container:!0,className:"align-bottom"},e.map(function(e,t){return r.a.createElement(x.a,{key:t,item:!0,xs:6},r.a.createElement(at,{answer:e,index:t}))}))))}}]),t}(n.Component),ht=a(106),dt=["#80DEEA","#EF9A9A","#CE93D8","#C5E1A5"],pt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).getChartData=a.getChartData.bind(Object(h.a)(Object(h.a)(a))),a.getChartOptions=a.getChartOptions.bind(Object(h.a)(Object(h.a)(a))),a.getChartHeight=a.getChartHeight.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getChartData",value:function(){for(var e={labels:[],datasets:[{data:[],label:"podium",backgroundColor:[],borderWidth:1}]},t=this.props.game.players?Object.keys(this.props.game.players):[],a=[],n=0;n<t.length;n++){var r={},i=this.props.game.players[t[n]],s=0;if(i.answers){for(var o=0;o<Object.keys(i.answers).length;o++){var l=this.props.game.quiz.questions[o],c=i.answers[l.id];c&&(s+=c.score)}r.score=s,r.name=i.name,a.push(r)}}a.sort(function(e,t){return t.score-e.score});for(var m=a.length>20?20:a.length,u=0;u<m;u++)e.labels.push(a[u].name),e.datasets[0].data.push(a[u].score),e.datasets[0].backgroundColor.push(dt[u%4]);return e}},{key:"getChartHeight",value:function(){var e=70+30*this.getChartData().labels.length;return e>740&&(e=740),e}},{key:"getChartOptions",value:function(){var e=(740-this.getChartHeight())/2;return{maintainAspectRatio:!1,showTooltips:!1,responsiveAnimationDuration:1e3,animation:{easing:"easeInOutCubic",duration:"2000",onProgress:function(e){e.animationObject.onAnimationProgress=function(){var t=this.chart.ctx,a=this.chart;t.textAlign="center",t.textBaseline="bottom",t.font="20px Roboto";var n=e.animationObject.currentStep/e.animationObject.numSteps,r=a.getDatasetMeta(0);r.hidden||r.data.forEach(function(e,r){var i=Math.floor(a.data.datasets[0].data[r]*n).toString();t.fillStyle=dt[r%4];var s=e.tooltipPosition();t.fillText(i,s.x+2+6*i.length,s.y+e._model.height/2)})}}},scales:{yAxes:[{ticks:{beginAtZero:!0},display:!0,beginAtZero:!0}],xAxes:[{display:!0,beginAtZero:!0}]},legend:{display:!1},tooltips:{enabled:!1},events:[],layout:{padding:{left:0,right:60,top:e,bottom:e}}}}},{key:"getWinnerString",value:function(){return"Congratulations [name of player]! "}},{key:"render",value:function(){return r.a.createElement("div",{style:{maxHeight:740}},r.a.createElement(ht.b,{data:this.getChartData,height:740,options:this.getChartOptions()}),r.a.createElement(C.b,{variant:"subtitle1"},this.getWinnerString()))}}]),t}(n.Component),gt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"h2"},"Final score"),r.a.createElement(pt,{game:this.props.game})),r.a.createElement("div",{className:"align-bottom "},r.a.createElement("div",null,r.a.createElement(I.a,{onClick:this.props.gameFunc.restart},"Replay quiz"),r.a.createElement(I.a,{onClick:this.props.gameFunc.quit},"Quit quiz"),r.a.createElement(I.a,{onClick:function(){return alert("show results")}},"Show results"),r.a.createElement(I.a,{onClick:function(){return alert("start survey")}},"Start survey"),r.a.createElement(I.a,null,r.a.createElement(y.a,{to:"/create"},"Host game")))))}}]),t}(n.Component),ft=[{icon:r.a.createElement(Ve.a,null),color:"#80DEEA"},{icon:r.a.createElement(Ze.a,null),color:"#EF9A9A"},{icon:r.a.createElement(Ye.a,null),color:"#CE93D8"},{icon:r.a.createElement($e.a,null),color:"#C5E1A5"}],vt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).getChartData=a.getChartData.bind(Object(h.a)(Object(h.a)(a))),a.getChartOptions=a.getChartOptions.bind(Object(h.a)(Object(h.a)(a))),a.getChartHeight=a.getChartHeight.bind(Object(h.a)(Object(h.a)(a))),a.getAnswerData=a.getAnswerData.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getAnswerData",value:function(){for(var e={data:[],topPlayer:{score:0,playerKey:""},correctAnswers:[]},t=[],a=this.props.game.players?Object.keys(this.props.game.players):[],n=this.props.game.quiz.questions[this.props.game.quiz.currentQuestion],r=0;r<a.length;r++){var i=this.props.game.players[a[r]];if(i.answers){var s=i.answers[n.id];s&&(t.push(s.answer),s.score>e.topPlayer.score&&(e.topPlayer.score=s.score,e.topPlayer.playerKey=i.key))}}for(var o=0;o<n.answers.length;o++){for(var l=0,c=0;c<t.length;c++)n.answers.indexOf(t[c])===o&&l++;e.data.push(l),n.correctAnswers.indexOf(n.answers[o])>-1&&e.correctAnswers.push(o)}return e}},{key:"getChartData",value:function(){var e={labels:[],datasets:[{data:[],label:"asdf",backgroundColor:[],borderWidth:1}]},t=this.getAnswerData();e.datasets[0].borderColor=[],e.datasets[0].data=t.data;for(var a=0;a<t.data.length;a++)e.labels.push(""),e.datasets[0].backgroundColor.push(ft[a].color);return e}},{key:"getChartHeight",value:function(){var e=this.getAnswerData(),t=65+25*Math.max.apply(Math,Object(z.a)(e.data));return t>300?300:t}},{key:"getChartOptions",value:function(){var e=this;return{maintainAspectRatio:!1,showTooltips:!1,responsiveAnimationDuration:1e3,animation:{easing:"easeInOutCubic",duration:"2000",onProgress:function(t){var a=e.getAnswerData();t.animationObject.onAnimationProgress=function(){var e=this.chart.ctx,n=this.chart;e.textAlign="center",e.fillStyle="black",e.textBaseline="bottom",e.font="24px Roboto";var r=t.animationObject.currentStep/t.animationObject.numSteps,i=n.getDatasetMeta(0);i.hidden||i.data.forEach(function(t,i){var s=Math.floor(n.data.datasets[0].data[i]*r),o=t.tooltipPosition();if(e.fillStyle=ft[i].color,e.fillText(s,o.x,o.y-2),e.beginPath(),e.rect(o.x-t._view.width/2,n.height-32,t._view.width,22),e.fill(),a.correctAnswers.indexOf(i)>-1){var l=new Image;l.src="/stagehoot/baseline-done_outline-24px.svg",l.height=100,l.width=100;var c=n.height-34;e.drawImage(l,o.x-12,c)}})}}},scales:{yAxes:[{ticks:{beginAtZero:!0},display:!1,beginAtZero:!0}],xAxes:[{display:!1}]},legend:{display:!1},tooltips:{enabled:!1},events:[],layout:{padding:{left:0,right:0,top:25,bottom:40}}}}},{key:"render",value:function(){return r.a.createElement(ht.a,{data:this.getChartData,height:this.getChartHeight(),options:this.getChartOptions()})}}]),t}(n.Component),yt=a(103),bt=a.n(yt),Et=a(48),wt=a.n(Et),kt=a(86),Ot=a.n(kt),jt=a(102),xt=a.n(jt),Ct=a(104),St=a.n(Ct),qt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChangePage=function(e,t){a.setState({page:t})},a.handleChangeRowsPerPage=function(e){a.setState({rowsPerPage:e.target.value})},a.state={leaderboardData:a.getLeaderboardData(),page:0,rowsPerPage:10},a.startScoreCounter=a.startScoreCounter.bind(Object(h.a)(Object(h.a)(a))),a.getScoreCellWidth=a.getScoreCellWidth.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){setTimeout(this.startScoreCounter,2e3)}},{key:"startScoreCounter",value:function(){var e=this,t=setInterval(function(){for(var a=e.state.leaderboardData,n=!0,r=0;r<a.players.length;r++){var i=a.players[r];i.currentQuestionScore>0&&(n=!1,i.currentQuestionScore--,i.totalScore++)}a.players.sort(function(e,t){return t.totalScore<e.totalScore?-1:t.totalScore>e.totalScore?1:0}),e.setState({leaderboard:a}),n&&clearInterval(t)},10)}},{key:"getLeaderboardData",value:function(){for(var e={players:[]},t=this.props.game.players?Object.keys(this.props.game.players):[],a=this.props.game.quiz.questions[this.props.game.quiz.currentQuestion],n=[],r=0;r<t.length;r++){var i={},s=this.props.game.players[t[r]],o=0;if(s.answers)for(var l=0;l<this.props.game.quiz.questions.length;l++){var c=this.props.game.quiz.questions[l],m=s.answers[c.id];m&&(m.questionId===a.id?(i.currentQuestionScore=m.score,i.lastScore=m.score):o+=m.score)}i.totalScore=o,i.name=s.name,i.key=s.key,n.push(i)}return n.sort(function(e,t){return t.totalScore<e.totalScore?-1:t.totalScore>e.totalScore?1:0}),e.players=n,e}},{key:"getLeaderboardScore",value:function(e){return 0===e.currentQuestionScore?"".concat(e.totalScore," (+").concat(e.lastScore,")"):"".concat(e.totalScore,"           ")}},{key:"getScoreCellWidth",value:function(){for(var e=0,t=this.getLeaderboardData(),a=0;a<t.players.length;a++){var n=t.players[a],r="".concat(n.totalScore," (+").concat(n.lastScore,")");r.length>e&&(e=r.length)}return 6*e+65}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,n=a.leaderboardData,i=a.rowsPerPage,s=a.page;return r.a.createElement("div",{className:t.root},r.a.createElement(xt.a,{className:t.table},r.a.createElement(bt.a,null,n.players.slice(s*i,s*i+i).map(function(t,a){return r.a.createElement(Ot.a,{key:t.key},r.a.createElement(wt.a,{padding:"dense"},a+1),r.a.createElement(wt.a,null,t.name),r.a.createElement(wt.a,{style:{width:e.getScoreCellWidth()}},e.getLeaderboardScore(t)))}))),n.players.length>10&&r.a.createElement(St.a,{component:"div",count:n.players.length,rowsPerPage:i,page:s,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}]),t}(n.Component),Pt=Object($.withStyles)(function(e){return{root:{width:"100%"},table:{maxWidth:700,whiteSpace:"nowrap"}}})(qt),Nt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a.nextQuestion=a.nextQuestion.bind(Object(h.a)(Object(h.a)(a))),a.finalizeQuiz=a.finalizeQuiz.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"nextQuestion",value:function(){var e={};e.quiz=this.props.game.quiz,e.quiz.currentQuestion=e.quiz.currentQuestion+1,e.phase="awaiting_question",this.props.gameFunc.update(e)}},{key:"finalizeQuiz",value:function(){this.props.gameFunc.update({phase:"final_result"})}},{key:"render",value:function(){var e=[],t="";this.props.game&&(e=(t=this.props.game.quiz.questions[this.props.game.quiz.currentQuestion]).answers);var a="undefined"===typeof this.props.game.quiz.questions[this.props.game.quiz.currentQuestion+1];return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(C.b,{variant:"h6",style:{float:"right"}},"Game PIN:".concat(this.props.game.gameId," ")),r.a.createElement(C.b,{variant:"h5"},t.question)),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(x.a,{container:!0},r.a.createElement(x.a,{item:!0,md:6,xs:12},r.a.createElement("div",{className:"quiz-answer-chart"},r.a.createElement(vt,{game:this.props.game}))),r.a.createElement(x.a,{item:!0,md:6,xs:12},r.a.createElement("div",null,r.a.createElement(Pt,{game:this.props.game})))),r.a.createElement("div",null,a&&r.a.createElement(I.a,{onClick:this.finalizeQuiz},"Finalize result"),!a&&r.a.createElement(I.a,{onClick:this.nextQuestion},"Next question"),r.a.createElement(I.a,{onClick:this.props.gameFunc.restart},"Restart quiz"),r.a.createElement(I.a,{onClick:this.props.gameFunc.quit},"Quit quiz"),r.a.createElement(I.a,{onClick:this.props.gameFunc.end},"End quiz"))),r.a.createElement("div",{className:"quiz-bottom-section"},r.a.createElement(x.a,{className:"align-bottom",container:!0},e.map(function(e,t){return r.a.createElement(x.a,{key:t,item:!0,xs:6},r.a.createElement(at,{answer:e,index:t}))}))))}}]),t}(n.Component),zt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},"HostEnd toggleHeader()")}}]),t}(n.Component),Tt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"host-container"},"setup"===this.props.game.phase&&r.a.createElement(_e,{game:this.props.game,gameFunc:this.props.gameFunc}),"connection"===this.props.game.phase&&r.a.createElement(De,{game:this.props.game,gameFunc:this.props.gameFunc}),"starting"===this.props.game.phase&&r.a.createElement(Be,{game:this.props.game,gameFunc:this.props.gameFunc}),"awaiting_question"===this.props.game.phase&&r.a.createElement(Le,{game:this.props.game,gameFunc:this.props.gameFunc}),"show_question"===this.props.game.phase&&r.a.createElement(We,{game:this.props.game,gameFunc:this.props.gameFunc}),"answer"===this.props.game.phase&&r.a.createElement(ut,{game:this.props.game,gameFunc:this.props.gameFunc}),"result_question"===this.props.game.phase&&r.a.createElement(Nt,{game:this.props.game,gameFunc:this.props.gameFunc}),"final_result"===this.props.game.phase&&r.a.createElement(gt,{game:this.props.game,gameFunc:this.props.gameFunc}),"end"===this.props.game.phase&&r.a.createElement(zt,{game:this.props.game,gameFunc:this.props.gameFunc}))}}]),t}(n.Component),Gt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.handleChangeBool=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.checked))}},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))},a.startGame=function(e){var t=a.props,n=t.game,r=t.gameFunc,i=a.state,s={surveyPlayers:i.surveyPlayers,nameGenerator:i.nameGenerator,multiplayerMode:e,wallCollision:i.wallCollision,opponentCollision:i.opponentCollision,eatOpponents:i.eatOpponents,racetarget:i.racetarget,difficulty:i.difficulty,gamemode:i.gamemode};n.minigame=s,n.phase="connection",n.status="IN_PROGRESS",r.update(n)},a.state={surveyPlayers:!1,nameGenerator:!1,gamemode:e.game.minigame.gamemode,racetarget:e.game.minigame.racetarget,opponentCollision:e.game.minigame.opponentCollision,eatOpponents:e.game.minigame.eatOpponents,wallCollision:e.game.minigame.wallCollision,difficulty:e.game.minigame.difficulty},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.surveyPlayers,n=t.nameGenerator,i=t.wallCollision,s=t.opponentCollision,o=t.eatOpponents,l=t.racetarget,c=t.difficulty,m=t.gamemode;return r.a.createElement("div",{className:"phase-container"},r.a.createElement(C.b,{variant:"h4"},"Game Settings"),r.a.createElement(I.a,{onClick:function(){return e.startGame("classic")},variant:"contained"},"Classic"),r.a.createElement(I.a,{onClick:function(){return e.startGame("coop")},variant:"contained"},"Co-op multiplayer"),r.a.createElement(I.a,{onClick:function(){return e.startGame("team")},variant:"contained"},"Team multiplayer"),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(U.a,null,r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:n,onChange:this.handleChangeBool("nameGenerator"),value:"nameGenerator"}),label:"Generate names for players"}),r.a.createElement(L.a,{required:!0},r.a.createElement(_.a,{htmlFor:"gametype-required"},"Game mode"),r.a.createElement(K.a,{value:m||"",onChange:this.handleChangeSelect,name:"gamemode",inputProps:{id:"gamemode-required"}},r.a.createElement(Q.a,{value:"survival"},"Survival"),r.a.createElement(Q.a,{value:"race"},"Race"))),"race"===m&&r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Snake length",name:"racetarget",type:"number",value:l,margin:"normal",onChange:this.handleChange("racetarget")})),r.a.createElement(L.a,{required:!0},r.a.createElement(_.a,{htmlFor:"gametype-required"},"difficulty"),r.a.createElement(K.a,{value:c||"",onChange:this.handleChangeSelect,name:"difficulty",inputProps:{id:"difficulty-required"}},r.a.createElement(Q.a,{value:"500"},"Easy"),r.a.createElement(Q.a,{value:"300"},"Medium"),r.a.createElement(Q.a,{value:"100"},"Hard"),r.a.createElement(Q.a,{value:"75"},"Pro"))),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:i,onChange:this.handleChangeBool("wallCollision"),value:"wallCollision"}),label:"Wall collisions"})),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:s,onChange:this.handleChangeBool("opponentCollision"),value:"opponentCollision"}),label:"Opponent collisions"})),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:s&&o,disabled:!s,onChange:this.handleChangeBool("eatOpponents"),value:"eatOpponents"}),label:"Eat opponent on collision"})),r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:a,onChange:this.handleChangeBool("surveyPlayers"),value:"surveyPlayers"}),label:"Survey players after game"}))))}}]),t}(n.Component),Mt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"nextPhase",value:function(){this.props.gameFunc.update({phase:"starting"})}},{key:"render",value:function(){var e=this.props.game,t=e.players;return t=t?Object.values(t):[],r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(C.b,{variant:"h2"},r.a.createElement("span",null,"Join game with Game PIN: "),r.a.createElement("span",{className:"dynamic-text"},e.gameId)),r.a.createElement(C.b,{variant:"h4",style:{marginTop:40}},"mannfeldt.github.io/stagehoot"),r.a.createElement(C.b,{variant:"subtitle1",style:{marginTop:20}},e.title)),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(x.a,{container:!0},t.map(function(e){return r.a.createElement(x.a,{key:e.key,item:!0,xs:3},r.a.createElement(C.b,{paragraph:!0,variant:"body1",className:"dynamic-text"},e.name))}))),r.a.createElement("div",{className:"quiz-bottom-section"},r.a.createElement(I.a,{onClick:this.nextPhase,variant:"contained"},"Start")))}}]),t}(n.Component),At=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a.startCounter(),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"startCounter",value:function(){var e=this;setInterval(function(){e.setState(function(e){return{counter:e.counter+1}})},1e3);return 5}},{key:"nextPhase",value:function(){this.props.gameFunc.update({phase:"gameplay"})}},{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},r.a.createElement(C.b,{variant:"h2"},"Starting game"),r.a.createElement(Qe,{speed:"slow"}))}}]),t}(n.Component),It=20;function Ft(e,t){var a=e.filter(function(e){return"down"===e.direction&&e.body}),n=Object(z.a)(new Set(a.map(function(e){return e.body[0].x}))),r=8*It,i=2*It;return{x:Bt(t-2*r,r,n),y:i}}function _t(e,t){var a=e.filter(function(e){return"up"===e.direction&&e.body}),n=Object(z.a)(new Set(a.map(function(e){return e.body[0].x}))),r=8*It,i=t.width-2*r,s=t.height-3*It;return{x:Bt(i,r,n),y:s}}function Dt(e,t){var a=e.filter(function(e){return"left"===e.direction&&e.body}),n=Object(z.a)(new Set(a.map(function(e){return e.body[0].y}))),r=8*It,i=t.height-2*r;return{x:t.width-3*It,y:Bt(i,r,n)}}function Qt(e,t){var a=e.filter(function(e){return"right"===e.direction&&e.body}),n=Object(z.a)(new Set(a.map(function(e){return e.body[0].y}))),r=8*It;return{x:2*It,y:Bt(t-2*r,r,n)}}function Bt(e,t,a){var n=Math.round(Math.random()*e/It)*It+t;return a.some(function(e){return e===n||e===n-It||e===n+It})?Bt(e,t,a):n}function Lt(e){var t=e.body;return!(t.length<5)&&t.slice(4).some(function(e){return e.x===t[0].x&&e.y===t[0].y})}function Wt(e,t,a){var n=e.x<0,r=e.y<0,i=e.x>a-It,s=e.y>t-It;return n||r||i||s}var Kt,Rt,Ht=20,Vt=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).togglePausGame=function(){a.setState(function(e){return{isPaused:!e.isPaused,overlay:!1}})};var n=Math.floor(window.innerHeight/Ht)*Ht,r=Math.floor(window.innerWidth/Ht)*Ht,i=2*e.game.minigame.snakes.length;return a.state={gameTicker:null,ticks:0,winners:[],snakes:function(e,t){for(var a=0,n=e.length;a<n;a++){var r=e[a];r.direction=r.actions[a%4],r.moves=[];var i=void 0;switch(r.direction){case"right":i=Qt(e,t.height),r.body=[{x:i.x,y:i.y},{x:i.x-It,y:i.y},{x:i.x-2*It,y:i.y},{x:i.x-3*It,y:i.y}];break;case"left":i=Dt(e,t),r.body=[{x:i.x,y:i.y},{x:i.x+It,y:i.y},{x:i.x+2*It,y:i.y},{x:i.x+3*It,y:i.y}];break;case"up":i=_t(e,t),r.body=[{x:i.x,y:i.y},{x:i.x,y:i.y+It},{x:i.x,y:i.y+2*It},{x:i.x,y:i.y+3*It}];break;case"down":i=Ft(e,t.width),r.body=[{x:i.x,y:i.y},{x:i.x,y:i.y-It},{x:i.x,y:i.y-2*It},{x:i.x,y:i.y-3*It}]}}return e}(e.game.minigame.snakes,{height:n,width:r}),foods:function(e){for(var t=[],a=0;a<e;a++)t.push({active:!1});return t}(i),settings:{snake:{size:Ht,speed:e.game.minigame.difficulty,border:"#000",respawntime:3},food:{background:"#EC5E0B",border:"#73AA24"},canvas:{height:n,width:r,background:"#F5F5F5",border:"#000"}}},a.drawSnakes=a.drawSnakes.bind(Object(h.a)(Object(h.a)(a))),a.generateFood=a.generateFood.bind(Object(h.a)(Object(h.a)(a))),a.generateSnakes=a.generateSnakes.bind(Object(h.a)(Object(h.a)(a))),a.resetCanvas=a.resetCanvas.bind(Object(h.a)(Object(h.a)(a))),a.drawFood=a.drawFood.bind(Object(h.a)(Object(h.a)(a))),a.detectCollisions=a.detectCollisions.bind(Object(h.a)(Object(h.a)(a))),a.initControllerListener=a.initControllerListener.bind(Object(h.a)(Object(h.a)(a))),a.generateFoods=a.generateFoods.bind(Object(h.a)(Object(h.a)(a))),a.isEndGame=a.isEndGame.bind(Object(h.a)(Object(h.a)(a))),a.togglePausGame=a.togglePausGame.bind(Object(h.a)(Object(h.a)(a))),a.renderOverlay=a.renderOverlay.bind(Object(h.a)(Object(h.a)(a))),a.nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.state,t=e.snakes,a=e.settings,n=document.querySelector("#snakeboard");Ce=n.querySelector("canvas"),xe=Ce.getContext("2d"),this.resetCanvas(),this.generateSnakes(),this.generateFoods();var r=this,i=setInterval(function(){if(r.state.isPaused){if(r.state.overlay)return;r.renderOverlay()}else 0===r.state.winners.length?(r.resetCanvas(),r.generateSnakes(),r.generateFoods(),r.detectCollisions(),r.isEndGame()):r.nextPhase()},a.snake.speed);this.setState({gameTicker:i});for(var s=0,o=t.length;s<o;s++){var l=t[s];this.initControllerListener(l)}}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"nextPhase",value:function(){var e=this.state,t=e.gameTicker,a=e.snakes,n=e.winners,r=e.ticks,i=this.props,s=i.game,o=i.gameFunc;clearInterval(t),s.minigame.snakes=a,s.minigame.winners=n,s.minigame.ticks=r,s.phase="final_result",o.update(s)}},{key:"initControllerListener",value:function(e){var t=this.props.game,a=v.database().ref("/games/".concat(t.key,"/minigame/snakes/").concat(e.id)),n=this;a.on("value",function(t){var a=t.val();a&&!n.state.isPaused?n.setState(function(t){var n=Object(z.a)(t.snakes);return a.move&&n[e.id].moves.push(a.move),{snakes:n}}):console.log("move error")})}},{key:"isEndGame",value:function(){var e=this.state.snakes,t=this.props.game.minigame,a=t.gamemode,n=t.racetarget;if(!("survival"===a&&e.filter(function(e){return!e.dead}).length>1)&&("race"!==a||e.some(function(e){return e.body.length>=n}))){var r=[];if("survival"===a){var i=e.filter(function(e){return!e.dead});if(1===i.length)r=i;else{var s=e.reduce(function(e,t){return e.score>t.score?e:t});r.push(s)}}else"race"===a&&(r=e.filter(function(e){return e.body.length>=n}));this.setState(function(){return{winners:r,isPaused:!0,overlay:!1}})}}},{key:"resetCanvas",value:function(){var e=this.state.settings;Ce.width=e.canvas.width,Ce.height=e.canvas.height,xe.fillStyle=e.canvas.background,xe.fillRect(0,0,Ce.width,Ce.height)}},{key:"generateSnakes",value:function(){for(var e=this.state,t=e.snakes,a=e.foods,n=e.settings,r=this.props.game,i=[],s=!r.minigame.wallCollision,o=function(e,o){var l=t[e];if(l.respawning)return Date.now()>l.respawntime&&(l.dead=!1,l.respawning=!1),i.push(l),"continue";if(l.dead){if("survival"===r.minigame.gamemode)return l.body=[],i.push(l),"continue";if("race"===r.minigame.gamemode){var c=n.canvas.width-Ht,m=function(e,t){return{x:Math.round(Math.random()*(t-14*It)/It)*It+4*It,y:Math.round(Math.random()*(e-2*It)/It)*It+2*It}}(n.canvas.height-Ht,c);return l.body=[{x:m.x,y:m.y},{x:m.x-Ht,y:m.y},{x:m.x-2*Ht,y:m.y},{x:m.x-3*Ht,y:m.y}],l.direction="right",l.respawning=!0,l.respawntime=Date.now()+1e3*n.snake.respawntime,i.push(l),"continue"}}var u,h,d={up:{x:l.body[0].x,y:s&&0===l.body[0].y?Ce.height-Ht:l.body[0].y-Ht},down:{x:l.body[0].x,y:s&&l.body[0].y>=Ce.height-Ht?0:l.body[0].y+Ht},right:{x:s&&l.body[0].x>=Ce.width-Ht?0:l.body[0].x+Ht,y:l.body[0].y},left:{x:s&&0===l.body[0].x?Ce.width-Ht:l.body[0].x-Ht,y:l.body[0].y}},p=l.moves.shift();u=p,h=l.direction,u&&{left:"right",right:"left",up:"down",down:"up"}[u]!==h&&(l.direction=p);var g=d[l.direction];l.body.unshift(g);var f=a.find(function(e){return e.active&&l.body[0].x===e.x&&l.body[0].y===e.y});f?(l.score+=10,f.active=!1):l.body.pop(),i.push(l)},l=0,c=t.length;l<c;l++)o(l);this.setState(function(e){return{snakes:i,foods:a,ticks:e.ticks+1}}),this.drawSnakes(i)}},{key:"drawSnakes",value:function(e){var t=this.state,a=t.settings,n=t.ticks;xe.globalCompositeOperation="multiply",xe.strokestyle=a.snake.border;for(var r=0,i=e.length;r<i;r++){var s=e[r];s.respawning&&n%2===0?xe.fillStyle=a.canvas.background:xe.fillStyle=s.color;for(var o=0,l=s.body.length;o<l;o++){var c=s.body[o];xe.fillRect(c.x,c.y,Ht,Ht),xe.strokeRect(c.x,c.y,Ht,Ht)}}}},{key:"generateFoods",value:function(){for(var e=this.state.foods,t=0,a=e.length;t<a;t++){var n=e[t];n.active||(n=this.generateFood()),this.drawFood(n),e[t]=n}this.setState(function(){return{foods:e}})}},{key:"generateFood",value:function(){var e=this.state,t=e.snakes,a=e.settings,n=a.canvas.width-Ht,r=a.canvas.height-Ht,i=Math.round(Math.random()*n/Ht)*Ht,s=Math.round(Math.random()*r/Ht)*Ht;return t.some(function(e){return e.body.some(function(e){return e.x===i&&e.y===s})})?this.generateFood():{active:!0,x:i,y:s}}},{key:"drawFood",value:function(e){var t=this.state.settings;xe.fillStyle=t.food.background,xe.strokestyle=t.food.border,xe.fillRect(e.x,e.y,Ht,Ht),xe.strokeRect(e.x,e.y,Ht,Ht)}},{key:"detectCollisions",value:function(){for(var e=this.state.snakes,t=this.props.game.minigame,a=0;a<e.length;a++)e[a].dead||(Lt(e[a])&&(e[a].dead=!0),t.wallCollision&&Wt(e[a].body[0],Ce.height,Ce.width)&&(e[a].dead=!0));t.opponentCollision&&(e=function(e,t){for(var a=0,n=e.length;a<n;a++)if(!e[a].dead)for(var r=e[a],i=0;i<n;i++)if(i!==a&&!e[i].dead)for(var s=e[i],o=0,l=s.body.length;o<l;o++)s.body[o].x===r.body[0].x&&s.body[o].y===r.body[0].y&&(0===o?(r.dead=!0,s.dead=!0):t?1===o?s.dead=!0:(s.body.length=o,l=o):r.dead=!0);return e}(e,t.eatOpponents)),this.setState(function(){return{snakes:e}})}},{key:"renderOverlay",value:function(){var e=this.state,t=e.ticks,a=e.snakes,n=e.winners,r=this.props.game;this.setState(function(){return{overlay:!0}}),xe.globalAlpha=.4,xe.textAlign="center",xe.font="100px roboto",xe.fillStyle="#000000",1===t?xe.fillText("Click to start",Ce.width/2,Ce.height/2):n.length>0?xe.fillText("Game over",Ce.width/2,Ce.height/2):xe.fillText("Paused",Ce.width/2,Ce.height/2),xe.globalAlpha=1,xe.font="20px roboto";for(var i=0;i<a.length;i++){var s=a[i];if(s.body[0]){var o=Math.max(Ht,s.body[0].x),l=Math.max(Ht,s.body[0].y);o>=Ce.width&&(o=Ce.width-2*Ht),l>=Ce.height&&(l=Ce.height-2*Ht);var c=1===s.playerKeys.length?r.players[s.playerKeys[0]].name:s.name;xe.fillStyle=s.color;var m={right:{textAlign:"center",yPos:l-Ht/5},left:{textAlign:"start",yPos:l-Ht/5},up:{textAlign:"start",yPos:l-Ht/5},down:{textAlign:"start",yPos:l+2*Ht}};xe.textAlign=m[s.direction].textAlign,xe.fillText(c,o,m[s.direction].yPos)}}}},{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container",id:"snakeboard",role:"button",tabIndex:0,onClick:this.togglePausGame,onKeyDown:this.togglePausGame},r.a.createElement("canvas",null))}}]),t}(n.Component),Ut=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},"tetris.js")}}]),t}(n.Component),Yt=window.innerWidth,Jt=window.innerHeight,Zt=!0,Xt={x:400,y:300},$t=[],ea=[],ta=400,aa=new Image;function na(){Yt!=window.innerWidth&&(Kt.width=Yt=window.innerWidth),Jt!=window.innerHeight&&(Kt.height=Jt=window.innerHeight),Rt.save(),Zt?(Zt=!1,Rt.globalAlpha=1):Rt.globalAlpha=.2,Rt.drawImage(aa,0,0,Yt,Jt),Rt.restore();for(var e=[],t=0;t<ea.length;t++){ea[t].update(),ea[t].render(Rt);var a=Math.sqrt(Math.pow(Xt.x-ea[t].pos.x,2)+Math.pow(Xt.y-ea[t].pos.y,2)),n=ea[t].pos.y<2*Jt/3&&100*Math.random()<=1;ea[t].pos.y<Jt/5||ea[t].vel.y>=0||a<50||n?ea[t].explode():e.push(ea[t])}ea=e;for(var r=[],i=0;i<$t.length;i++)$t[i].update(),$t[i].exists()&&($t[i].render(Rt),r.push($t[i]));for($t=r;$t.length>ta;)$t.shift()}function ra(e){this.pos={x:e?e.x:0,y:e?e.y:0},this.vel={x:0,y:0},this.shrink=.97,this.size=2,this.resistance=1,this.gravity=0,this.flick=!1,this.alpha=1,this.fade=0,this.color=0}function ia(e){ra.apply(this,[{x:e,y:Jt}]),this.explosionColor=0}function sa(){!function(e){if(ea.length<10){var t=new ia(e);t.explosionColor=10*Math.floor(360*Math.random()/10),t.vel.y=-3*Math.random()-4,t.vel.x=6*Math.random()-3,t.size=8,t.shrink=.999,t.gravity=.01,ea.push(t)}}(Xt.x)}aa.src="https://www.golfworldtravel.se/wp-content/uploads/2013/12/Arabella-Sheraton-Golf-4.jpg",ra.prototype.update=function(){this.vel.x*=this.resistance,this.vel.y*=this.resistance,this.vel.y+=this.gravity,this.pos.x+=this.vel.x,this.pos.y+=this.vel.y,this.size*=this.shrink,this.alpha-=this.fade},ra.prototype.render=function(e){if(this.exists()){e.save(),e.globalCompositeOperation="lighter";var t=this.pos.x,a=this.pos.y,n=this.size/2,r=e.createRadialGradient(t,a,.1,t,a,n);r.addColorStop(.1,"rgba(255,255,255,".concat(this.alpha,")")),r.addColorStop(.8,"hsla(".concat(this.color,", 100%, 50%, ").concat(this.alpha,")")),r.addColorStop(1,"hsla(".concat(this.color,", 100%, 50%, 0.1)")),e.fillStyle=r,e.beginPath(),e.arc(this.pos.x,this.pos.y,this.flick?Math.random()*this.size:this.size,0,2*Math.PI,!0),e.closePath(),e.fill(),e.restore()}},ra.prototype.exists=function(){return this.alpha>=.1&&this.size>=1},ia.prototype=new ra,ia.prototype.constructor=ia,ia.prototype.explode=function(){for(var e=10*Math.random()+80,t=0;t<e;t++){var a=new ra(this.pos),n=Math.random()*Math.PI*2,r=15*Math.cos(Math.random()*Math.PI/2);a.vel.x=Math.cos(n)*r,a.vel.y=Math.sin(n)*r,a.size=10,a.gravity=.2,a.resistance=.92,a.shrink=.05*Math.random()+.93,a.flick=!0,a.color=this.explosionColor,$t.push(a)}},ia.prototype.render=function(e){if(this.exists()){e.save(),e.globalCompositeOperation="lighter";var t=this.pos.x,a=this.pos.y,n=this.size/2,r=e.createRadialGradient(t,a,.1,t,a,n);r.addColorStop(.1,"rgba(255, 255, 255 ,".concat(this.alpha,")")),r.addColorStop(1,"rgba(0, 0, 0, ".concat(this.alpha,")")),e.fillStyle=r,e.beginPath(),e.arc(this.pos.x,this.pos.y,this.flick?Math.random()*this.size/2+this.size/2:this.size,0,2*Math.PI,!0),e.closePath(),e.fill(),e.restore()}};var oa=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).replayGame=a.replayGame.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){Kt=document.getElementById("fireworkscanvas"),Rt=Kt.getContext("2d"),Kt.width=window.innerWidth,Kt.height=window.innerHeight,setInterval(sa,800),setInterval(na,20)}},{key:"replayGame",value:function(){this.props.gameFunc.update({phase:"starting"})}},{key:"render",value:function(){var e=this.props,t=e.gameFunc,a=e.game,n=Kt?Kt.height:window.innerHeight,i=Kt?Kt.width:window.innerWidth,s=a.players[a.minigame.leaderboard[0].playerKey],o=a.minigame.leaderboard[0].totalScore;return r.a.createElement("div",{className:"phase-container"},r.a.createElement("canvas",{id:"fireworkscanvas"}),r.a.createElement("div",{style:{position:"absolute",top:0,marginTop:n/2,marginLeft:i/2}},r.a.createElement(C.b,{variant:"h2",style:{color:"white"}},"".concat(s.name," vinner med ").concat(o," po\xe4ng"))),r.a.createElement("div",{style:{position:"absolute",top:0,marginTop:n}},r.a.createElement("div",null,r.a.createElement(I.a,{onClick:this.replayGame},"Replay game"),r.a.createElement(I.a,{onClick:t.restart},"Re-host game"),r.a.createElement(I.a,{onClick:t.quit},"Quit game"),r.a.createElement(I.a,{onClick:function(){return alert("show results")}},"Show results"),r.a.createElement(I.a,{onClick:function(){return alert("start survey")}},"Start survey"),r.a.createElement(I.a,null,r.a.createElement(y.a,{to:"/create"},"Create new game")))))}}]),t}(n.Component),la=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.game;return r.a.createElement("div",{className:"phase-container"},r.a.createElement(C.b,null,"hur seer detta ut konstigt med dollarsign?HostEnd toggleheader()".concat(e.title)))}}]),t}(n.PureComponent);function ca(e,t){var a=t;if(a<2)return[e];var n,r=e.length,i=[],s=0;if(r%a===0)for(n=Math.floor(r/a);s<r;)i.push(e.slice(s,s+=n));else for(;s<r;)n=Math.ceil((r-s)/a),a-=1,i.push(e.slice(s,s+=n));return i}var ma=["#F44336","#9C27B0","#2196F3","#4CAF50","#FFEB3B","#FF9800","#607D8B","#795548","#E91E63","#3F51B5","#673AB7","#00BCD4","#03A9F4","#8BC34A","#CDDC39","#009688","#FFC107","#FF5722"],ua=["Stan","Jane","Sara","Dan","Lisa","Joe","Rose","Ray","Lyra","Sam","Lucy","Ben","Noa","Mark","Eve","Ned","Ann","Todd"],ha=20,da=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).startCounter(),a.nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"startCounter",value:function(){var e=this,t=5,a=setInterval(function(){0===(t-=1)&&(e.nextPhase(),clearInterval(a))},1e3);return 5}},{key:"nextPhase",value:function(){var e,t=this.props,a=t.game,n=t.gameFunc,r={classic:function(e){for(var t=Object.keys(e),a=[],n=0;n<t.length;n++){var r={playerKeys:[e[t[n]].key],actions:["up","down","right","left"],score:0,color:ma[n%ma.length],name:ua[n%ua.length],id:n};a.push(r)}return a}(a.players),team:function(e){for(var t=Object.keys(e),a=[],n=0;n<t.length;n++){var r={playerKeys:[e[t[n]].key],direction:"right",id:n,score:0,body:[{x:300,y:100},{x:300-ha,y:100},{x:300-2*ha,y:100},{x:300-3*ha,y:100}]};a.push(r)}return a}(a.players),coop:function(e){var t=[],a={playerKeys:Object.keys(e),direction:"right",actions:["up","down","right","left"],score:0,color:ma[Math.floor(Math.random()*ma.length)],name:ua[Math.floor(Math.random()*ua.length)],id:0,body:[{x:300,y:90},{x:300-ha,y:90},{x:300-2*ha,y:90},{x:300-3*ha,y:90}]};return t.push(a),t}(a.players)};e=r[a.minigame.multiplayerMode];for(var i=0;i<e.length;i++)for(var s=ca(e[i].actions,e[i].playerKeys.length),o=0;o<e[i].playerKeys.length;o++){var l=a.players[e[i].playerKeys[o]];l.snakeId=e[i].id,l.controlActions=s[o]}a.minigame.snakes=e,a.phase="gameplay",n.update(a)}},{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},r.a.createElement(C.b,{variant:"h2"},"Starting game"),r.a.createElement(Qe,{speed:"slow"}))}}]),t}(n.Component),pa=a(57),ga=a(51),fa=a(330),va=a.n(fa),ya=a(331),ba=a.n(ya),Ea=a(332),wa=a.n(Ea),ka=a(333),Oa=a.n(ka),ja=a(334),xa=a.n(ja),Ca=a(335),Sa=a.n(Ca),qa=a(336),Pa=a.n(qa),Na=a(337),za=a.n(Na),Ta=a(338),Ga=a.n(Ta),Ma=a(339),Aa=a.n(Ma),Ia=a(340),Fa=a(341),_a=a.n(Fa),Da=10,Qa=7,Ba=10,La=3,Wa=12,Ka="green",Ra=[{name:"Albatross",score:-3},{name:"Eagle",score:-2},{name:"Birdie",score:-1},{name:"Par",score:0},{name:"Bogey",score:1},{name:"Double bogey",score:2},{name:"Triple bogey",score:3},{name:"Quadruple bogey",score:4}],Ha=[{name:"Wood",type:"wood",id:0,loft:22,powerFactor:3.8,max:800},{name:"Hybrid",type:"iron",id:1,loft:26,powerFactor:3.6,max:800},{name:"3 Iron",type:"iron",id:2,loft:31,powerFactor:3.2,max:700},{name:"4 Iron",type:"iron",id:3,loft:34,powerFactor:3.15,max:700},{name:"5 Iron",type:"iron",id:4,loft:37,powerFactor:3.1,max:700},{name:"6 Iron",type:"iron",id:5,loft:40,powerFactor:3.05,max:700},{name:"7 Iron",type:"iron",id:6,loft:43,powerFactor:3,max:700},{name:"8 Iron",type:"iron",id:7,loft:46,powerFactor:2.95,max:700},{name:"9 Iron",type:"iron",id:8,loft:49,powerFactor:2.9,max:700},{name:"Wedge",type:"iron",id:9,loft:62,powerFactor:2.75,max:700},{name:"Chipper",type:"iron",id:10,loft:78,powerFactor:2.6,max:700},{name:"Putter",type:"putt",id:11,loft:1,powerFactor:1.6,max:400}],Va=["orange","brown","gray"];function Ua(e,t){return Math.floor(Math.random()*(t-e+1))+e}var Ya,Ja,Za=new ga.Material,Xa=new ga.Material,$a=new ga.Material,en=new ga.ContactMaterial(Za,Xa,{friction:1,restitution:.5}),tn=new ga.ContactMaterial(Za,$a,{friction:.1,restitution:0,relaxation:8}),an=Math.pow(2,1),nn=Math.pow(2,2);function rn(){var e=new ga.World({gravity:[0,60]});return e.sleepMode=ga.World.BODY_SLEEPING,e.addContactMaterial(en),e.addContactMaterial(tn),e}function sn(e){var t=new ga.Circle({radius:La,collisionGroup:an,collisionMask:nn});t.material=Za;var a=new ga.Body({mass:1,position:e});return a.addShape(t),a.angularDamping=.8,a.damping=.18,a.sleepTimeLimit=1,a.sleepSpeedLimit=2,a}function on(e,t){return e>t?Math.floor((e-t)/4):Math.floor((t-e)/4)}function ln(e){var t=new Audio,a=document.createElement("source");return a.type="audio/mpeg",a.src=e,t.appendChild(a),t}function cn(e,t){var a=(90-e.loft)/90,n=e.loft/90,r=t;return{x:Math.min(Math.ceil(r*a*e.powerFactor),e.max),y:Math.min(Math.ceil(r*n*e.powerFactor),e.max)}}function mn(e){var t=e.width;if(0!==e.points[0][0])throw new Error("invalid points: first x !== 0");if(e.points[e.points.length-1][0]!==t)throw new Error("invalid points: last x !== WIDTH (".concat(t,")"));var a=e.points.findIndex(function(t){return t[0]>e.hole[0]}),n=e.hole[0]-Ba/2,r=e.hole[0]+Ba/2;if(n<=e.points[a-1][0])throw new Error("invalid points: hole x1 cannot be <= the previous x");if(r>=e.points[a][0])throw new Error("invalid points: hole x2 cannot be >= the previous x");var i=[[e.hole[0]-Ba/2,e.hole[1]],[e.hole[0]-Ba/2,e.hole[1]+Qa],[e.hole[0],e.hole[1]+Da],[e.hole[0]+Ba/2,e.hole[1]+Qa],[e.hole[0]+Ba/2,e.hole[1]]],s=e.points.slice(0,a).concat(i).concat(e.points.slice(a));return Object(pa.a)({},e,{points:s})}function un(e){var t=e.height,a=e.width,n=e.points.filter(function(t){return t[0]<e.hole[0]}),r=e.points.filter(function(t){return t[0]>e.hole[0]}),i=n.concat([[n[n.length-1][0],t],[0,t]]),s=[[e.hole[0]-Ba/2,e.hole[1]+Qa],[e.hole[0],e.hole[1]+Da],[e.hole[0]+Ba/2,e.hole[1]+Qa],[e.hole[0]+Ba/2,t],[e.hole[0]-Ba/2,t]],o=r.concat([[a,t],[r[0][0],t]]);return[i,s,o].map(function(e){var t=new ga.Body({mass:0});t.fromPolygon(e);var a=!0,n=!1,r=void 0;try{for(var i,o=t.shapes[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var l=i.value;l.material=e===s?$a:Xa,l.collisionGroup=nn,l.collisionMask=an}}catch(c){n=!0,r=c}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}return t})}function hn(e){var t=new ga.Box({width:Ba,height:Da});t.sensor=!0,t.collisionGroup=nn,t.collisionMask=an;var a=new ga.Body({position:[e[0],e[1]+Math.ceil(1.4*Da)]});return a.damping=0,a.addShape(t),a}function dn(e,t){for(var a=[],n=e;n>0;){var r=50;n<r&&(r=n);var i=Ua(t,r);n-i<t&&(i=n),a.push(i),n-=i}return function(e){for(var t=e.length;t;t-=1){var a=Math.floor(Math.random()*t),n=e[t-1];e[t-1]=e[a],e[a]=n}}(a),a}function pn(e,t){var a={3:1===e?25:25-2*e,4:1===e?25:25-2*e,5:1===e?25:25-2*e};return Math.abs(Math.round(a[t.par]))}function gn(e,t){return Math.round((t.time/1e3*1.5-e)/10)}function fn(e,t,a){if(a)return{points:[[0,400],[e,400]],hole:[e/1.5,400],spawn:[100,400],color:"brown",par:4,height:t,time:2e4,width:e};var n,r=dn(e,12),i=r.length,s=Ua(2,4);if(e>1e3){var o=Ua(1,18);n=o>8?4:o>4?5:3}else n=5;for(var l,c,m,u,h={hole:{5:i-Ua(2,Math.floor(i/4)),4:i-Ua(Math.floor(i/4),Math.floor(i/2.5)),3:i-Ua(Math.floor(i/2.5),Math.floor(i/2))},time:{5:1e5,4:8e4,3:6e4},flatRatio:{5:40,4:30,3:20}},d=h.hole[n],p=h.time[n],g=[],f=Math.floor(.4*t),v=f+Math.min(400,.5*t),y=0;y<=i;y++){var b=r[y-1],E=void 0,w=void 0;if((E=0===y?0:g[y-1][0]+b)>e&&(E=e),0===y)w=Ua(t-150,t-20);else{var k=g[y-1][1];if(Ua(1,h.flatRatio[n])>10)w=k;else{var O=k-40,j=k+40;O<f&&(j-=O-f,O=f),j>v&&(O-=j-v,j=v),w=Ua(O,j)}}y===s&&(l=E-Math.round(b/2),c=w=g[y-1][1]),y===d&&(m=E-Math.round(b/2),u=w=g[y-1][1]),g.push([E,w])}return{points:g,hole:[m,u],spawn:[l,c],color:Object(Ia.sample)(Va),par:n,time:p,height:t,width:e}}var vn;var yn=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))};var n=Math.floor(window.innerHeight-160),r=Math.floor(window.innerWidth),i={wood:[{audio:ln(va.a),minpower:400},{audio:ln(ba.a),minpower:300},{audio:ln(wa.a),minpower:200}],golfclap:{audio:ln(za.a)},iron:[{audio:ln(Oa.a),minpower:350},{audio:ln(xa.a),minpower:250},{audio:ln(Sa.a),minpower:150}],putt:[{audio:ln(Ga.a),minpower:8}],ballInHole:{audio:ln(Aa.a)},countdown:{audio:ln(Pa.a)}};return a.state={levelData:null,world:null,level:null,startTime:null,expTime:null,holeSensor:null,time:0,canvasHeight:n,canvasWidth:r,leaderId:null,matchEndTime:null,testacceleration:195,testClubIndex:2,testBallIndex:0,balls:null,nextLevelTimer:null,scorers:[],totalScores:[],currentlevelScores:[],leaderboard:[],soundEffects:i},a.init=a.init.bind(Object(h.a)(Object(h.a)(a))),a.ensurePlayersInBounds=a.ensurePlayersInBounds.bind(Object(h.a)(Object(h.a)(a))),a.swing=a.swing.bind(Object(h.a)(Object(h.a)(a))),a.drawGround=a.drawGround.bind(Object(h.a)(Object(h.a)(a))),a.drawLevelCompleteHud=a.drawLevelCompleteHud.bind(Object(h.a)(Object(h.a)(a))),a.drawPlayHud=a.drawPlayHud.bind(Object(h.a)(Object(h.a)(a))),a.renderFrame=a.renderFrame.bind(Object(h.a)(Object(h.a)(a))),a.animate=a.animate.bind(Object(h.a)(Object(h.a)(a))),a.testSwing=a.testSwing.bind(Object(h.a)(Object(h.a)(a))),a.syncPlayersObjectToFirebase=a.syncPlayersObjectToFirebase.bind(Object(h.a)(Object(h.a)(a))),a.initControllerListener=a.initControllerListener.bind(Object(h.a)(Object(h.a)(a))),a.isLevelCompleted=a.isLevelCompleted.bind(Object(h.a)(Object(h.a)(a))),a.nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a.distributeScore=a.distributeScore.bind(Object(h.a)(Object(h.a)(a))),a.isLoadNextLevel=a.isLoadNextLevel.bind(Object(h.a)(Object(h.a)(a))),a.loadNextLevel=a.loadNextLevel.bind(Object(h.a)(Object(h.a)(a))),a.saveGame=a.saveGame.bind(Object(h.a)(Object(h.a)(a))),a.setEventHandlers=a.setEventHandlers.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.init()}},{key:"shouldComponentUpdate",value:function(){return!0}},{key:"setEventHandlers",value:function(e){var t=this;e.on("beginContact",function(e){var a=t.state,n=a.balls,r=a.holeSensor,i=a.startTime,s=a.expTime,o=a.scorers,l=a.soundEffects,c=a.level,m=t.props.game,u=Object.values(m.players);if(e.bodyA===r||e.bodyB===r){var h=e.bodyA===r?e.bodyB:e.bodyA;if(!h.scored){var d=h.playerKey;l.ballInHole.audio.currentTime=0,l.ballInHole.audio.play(),h.scored=!0;var p=s;m.minigame.speedmode&&s>Date.now()+3e4&&(p=s-15e3);var g=Math.floor((Date.now()-i)/1e3),f={playerKey:d,time:g,strokes:h.strokes,hole:m.minigame.round,par:c.par};o.push(f),t.setState(function(){return{balls:n,expTime:p,scorers:o}});var v=u.map(function(e){return e.key===d?Object(pa.a)({},e,{state:"SCORED",scoreTime:g}):e});t.syncPlayersToFirebase(v)}}}),e.on("postStep",function(e){var a=t.state,n=a.balls,r=a.level,i=t.props.game,s=Object.values(i.players),o=n.filter(function(e){return 0===e.velocity[0]&&0===e.velocity[1]});if(0!==o.length){var l=s.filter(function(e){return"MOVING"===e.state&&o.some(function(t){return e.key===t.playerKey})});if(0!==l.length){var c=s.map(function(e,t){return l.some(function(t){return t.key===e.key})?Object(pa.a)({},e,{state:"STILL",distance:on(r.hole[0],n[e.ballIndex].interpolatedPosition[0])}):e});t.syncPlayersToFirebase(c)}}})}},{key:"ensurePlayersInBounds",value:function(){var e=this.state,t=e.balls,a=e.canvasWidth,n=(e.level,t.map(function(e){var t=e;return(e.interpolatedPosition[0]<0||e.interpolatedPosition[0]>a)&&(t.position=[e.lastPos[0],e.lastPos[1]-20],t.velocity=[0,0]),t}));this.setState(function(){return{balls:n}})}},{key:"drawBalls",value:function(){for(var e,t,a,n,r=this.state.balls,i=this.props.game,s=Object.values(i.players),o=s.length,l=0;l<o;l++){var c=s[l],m=r[c.ballIndex].interpolatedPosition;e=m[0],t=m[1],a=c.color,n="gray",c.state,Ya.lineWidth=1,Ya.fillStyle=a,Ya.strokeStyle=n,Ya.beginPath(),Ya.arc(e,t,La,0,2*Math.PI),Ya.fill(),Ya.closePath(),Ya.beginPath(),Ya.arc(e,t,La-Ya.lineWidth/2,0,2*Math.PI),Ya.stroke(),Ya.closePath()}}},{key:"drawGround",value:function(){var e=this.state,t=e.level,a=e.canvasHeight,n=e.canvasWidth,r=t.points;Ya.fillStyle=t.color;Ya.lineWidth=3,Ya.beginPath();var i=r[0];Ya.moveTo(i[0],i[1]),r.slice(1).forEach(function(e){Ya.lineTo(e[0],e[1])}),Ya.lineTo(n+3,r[r.length-1][1]),Ya.lineTo(n+3,a+3),Ya.lineTo(-3,a+3),Ya.lineTo(-3,r[0][1]),Ya.strokeStyle=Ka,Ya.stroke(),Ya.fill(),Ya.closePath()}},{key:"drawLevelCompleteHud",value:function(){var e=this.state,t=e.nextLevelTimer,a=(e.level,e.canvasHeight,e.canvasWidth),n=e.leaderboard,r=this.props.game;Ya.font="24px roboto",Ya.fillStyle="#000000",Ya.fillText("Level completed!",15,24),Ya.font="20px roboto",Ya.textAlign="right",Ya.fillText("pin: ".concat(r.gameId),a-20,24),Ya.textAlign="left";var i=Math.floor((t-Date.now())/1e3);Ya.fillText(i,a/2,24);for(var s=0;s<n.length;s++){var o=n[s];Ya.fillText("".concat(r.players[o.playerKey].name,": ").concat(o.totalScore," po\xe4ng"),a/2,60+30*s)}}},{key:"drawPlayHud",value:function(){var e=this.state,t=e.expTime,a=e.level,n=(e.canvasHeight,e.canvasWidth),r=e.soundEffects,i=e.scorers,s=this.props.game;Ya.font="24px roboto",Ya.fillStyle="#000000",Ya.fillText("Hole ".concat(s.minigame.round," Par ").concat(a.par),15,24),Ya.font="20px roboto",Ya.textAlign="right",Ya.fillText("pin: ".concat(s.gameId),n-30,24),Ya.textAlign="left";var o=Math.floor((t-Date.now())/1e3);10===o&&r.countdown.audio.play(),Ya.textAlign="center",Ya.fillText(o,n/2,24),Ya.textAlign="left";i.filter(function(e){return e.hole===s.minigame.round}).slice(0,3).forEach(function(e,t){return Ya.fillText("".concat(s.players[e.playerKey].name," gjorde ").concat(function(e,t){if(1===e)return"Hole in one!";var a=e-t,n=Ra.find(function(e){return e.score===a});return n?n.name:"".concat(a," over par")}(e.strokes,e.par)," efter ").concat(e.time," sekunder"),n/2,40*(1+t))})}},{key:"testSwing",value:function(){var e=this.state,t=e.testacceleration,a=e.testClubIndex,n=e.testBallIndex,r=cn(Ha[a],t);this.swing(r,n,!0)}},{key:"swing",value:function(e,t,a){var n=this.state,r=n.balls,i=n.holeSensor,s=n.soundEffects,o=this.props.game.players,l=function(e){var t=e.y/(e.x+e.y)*90;return t<5?"putt":t<Ha.find(function(e){return"iron"===e.type}).loft-1?"wood":"iron"}(e),c=e.x+e.y,m=s[l].find(function(e){return c>e.minpower});m&&(m.audio.currentTime=0,m.audio.play());var u=r.find(function(e){return e.ballIndex===t});o[u.playerKey].state="MOVING";var h=i.interpolatedPosition[0],d=u.interpolatedPosition[0],p=Object(pa.a)({},e,{y:-e.y});d>h&&(p.x=-p.x),this.syncPlayersObjectToFirebase(o),u.velocity[0]=p.x,u.velocity[1]=p.y,u.strokes+=1,u.lastPos=Object(z.a)(u.position),this.setState(function(){return{balls:r}})}},{key:"createLevel",value:function(){var e=this.state;e.canvasHeight,e.canvasWidth,this.props.game}},{key:"init",value:function(){var e=this,t=this.props.game,a=this.state,n=a.canvasHeight,r=a.canvasWidth;Ja=document.getElementById("golfcanvas"),(Ya=Ja.getContext("2d")).lineWidth=5;var i=mn(fn(r,n,!1)),s=rn(),o=un(i),l=hn(i.hole),c=!0,m=!1,u=void 0;try{for(var h,d=o[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var p=h.value;s.addBody(p)}}catch(j){m=!0,u=j}finally{try{c||null==d.return||d.return()}finally{if(m)throw u}}s.addBody(l);for(var g,f=Object.keys(t.players),v=f.length,y=[],b=[],E=function(e){for(var t=[],a=Math.random(),n=0;n<e;n++){a+=.618033988749895,a%=1;var r=_a.a.fromRatio({h:a,s:.5,v:.95});t.push(r.toHexString())}return t}(v),w=0;w<v;w++){var k=sn([(g=i.spawn)[0],g[1]-La]);k.playerKey=f[w],k.ballIndex=w,k.scored=!1,k.strokes=0,k.lastPos=Object(z.a)(k.position),s.addBody(k);var O=Object.assign({ballIndex:w,key:f[w],color:E[w],state:"STILL",distance:on(i.hole[0],i.spawn[0]),score:0},t.players[f[w]]);b.push(k),y.push(O)}this.setState(function(){return{world:s,level:i,balls:b,holeSensor:l,startTime:Date.now(),expTime:Date.now()+i.time}}),y.forEach(function(t){return e.initControllerListener(t)}),this.setEventHandlers(s),this.syncToFirebase(y,i),requestAnimationFrame(this.animate)}},{key:"syncPlayersToFirebase",value:function(e){var t=this.props,a=t.game;t.gameFunc;a.players=e.reduce(function(e,t){var a=e;return a[t.key]=t,a},a.players),this.saveGame(a)}},{key:"syncPlayersObjectToFirebase",value:function(e){var t=this.props,a=t.game;t.gameFunc;a.players=e,this.saveGame(a)}},{key:"syncToFirebase",value:function(e,t){var a=this.props,n=a.game;a.gameFunc;n.players=e.reduce(function(e,t){var a=e;return a[t.key]=t,a},n.players),n.status="IN_PROGRESS",n.minigame.levelColor=t.color,n.minigame.round=1,this.saveGame(n)}},{key:"saveGame",value:function(e){this.props.gameFunc.update(e)}},{key:"nextPhase",value:function(){var e=this.props,t=e.game,a=(e.gameFunc,this.state),n=a.soundEffects,r=a.leaderboard;"".concat(t.minigame.round)===t.minigame.holes?(t.minigame.leaderboard=r.map(function(e){return Object(pa.a)({},e,{currentRoundScore:null})}),t.phase="final_result"):(n.golfclap.audio.play(),t.phase="level_completed",this.setState(function(){return{nextLevelTimer:Date.now()+1e4}})),this.saveGame(t)}},{key:"animate",value:function(e){var t=this.state.world,a=this.props.game.phase;requestAnimationFrame(this.animate);var n=vn?(e-vn)/400:0;t.step(1/60,n,10),vn=e,"gameplay"===a?(this.ensurePlayersInBounds(),this.renderFrame(),this.drawPlayHud(),this.isLevelCompleted()&&(this.distributeScore(),this.nextPhase())):"level_completed"===a&&(this.renderFrame(),this.drawLevelCompleteHud(),this.isLoadNextLevel()&&this.loadNextLevel())}},{key:"loadNextLevel",value:function(){var e=this.props,t=e.game,a=(e.gameFunc,this.state),n=a.balls,r=a.canvasHeight,i=mn(fn(a.canvasWidth,r,!1)),s=rn(),o=un(i),l=hn(i.hole),c=!0,m=!1,u=void 0;try{for(var h,d=o[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var p=h.value;s.addBody(p)}}catch(f){m=!0,u=f}finally{try{c||null==d.return||d.return()}finally{if(m)throw u}}s.addBody(l),n.forEach(function(e){e.position=[i.spawn[0],i.spawn[1]-La],e.velocity=[0,0],e.scored=!1,e.strokes=0,e.lastPos=Object(z.a)(e.position),s.addBody(e)}),this.setEventHandlers(s);var g=Object.values(t.players).map(function(e){return Object(pa.a)({},e,{state:"STILL",distance:on(i.hole[0],i.spawn[0])})}).reduce(function(e,t){var a=e;return a[t.key]=t,a},t.players);this.setState(function(){return{world:s,level:i,balls:n,holeSensor:l,startTime:Date.now(),expTime:Date.now()+i.time}}),t.phase="gameplay",t.players=g,t.minigame.round+=1,this.saveGame(t)}},{key:"distributeScore",value:function(){var e,t=this.props.game,a=this.state,n=a.scorers,r=(a.leaderboard,a.level),i=Object(z.a)(n),s=Object.values(t.players),o=n.filter(function(e){return e.hole===t.minigame.round});switch((!o||o.length<s.length)&&s.forEach(function(e){if(!o||!o.some(function(t){return t.playerKey===e.key})){var a={playerKey:e.key,par:r.par,strokes:12,time:1.5*r.time/1e3,hole:t.minigame.round};i.push(a)}}),t.minigame.scoremode){case"strokes":e=s.map(function(e){var a=i.filter(function(t){return t.playerKey===e.key});return{currentRoundScore:pn(a.find(function(e){return e.hole===t.minigame.round}).strokes,r),totalScore:a.reduce(function(e,t){return e+pn(t.strokes,r)},0),playerKey:e.key}}).sort(function(e,t){return t.totalScore-e.totalScore});break;case"time":e=s.map(function(e){var a=i.filter(function(t){return t.playerKey===e.key});return{currentRoundScore:gn(a.find(function(e){return e.hole===t.minigame.round}).time,r),totalScore:a.reduce(function(e,t){return e+gn(t.time,r)},0),playerKey:e.key}}).sort(function(e,t){return t.totalScore-e.totalScore});break;case"compedetive":e=s.map(function(e){var a=i.filter(function(t){return t.playerKey===e.key}),n=a.find(function(e){return e.hole===t.minigame.round});return{currentRoundScore:n.strokes-n.par,totalScore:a.reduce(function(e,t){return e+(t.strokes-n.par)},0),playerKey:e.key}}).sort(function(e,t){return e.totalScore-t.totalScore})}this.setState(function(){return{leaderboard:e,scorers:i}})}},{key:"initControllerListener",value:function(e){var t=this.props.game,a=(this.state.balls,v.database().ref("/games/".concat(t.key,"/players/").concat(e.key,"/swing"))),n=this;a.on("value",function(t){var a=n.props.game.players[e.key],r=t.val();r?n.swing(r,a.ballIndex):console.log("move error")})}},{key:"isLoadNextLevel",value:function(){var e=this.state.nextLevelTimer;return Date.now()>e}},{key:"isLevelCompleted",value:function(){var e=this.state,t=e.expTime,a=e.balls;return Date.now()>t||!a.some(function(e){return!e.scored})}},{key:"renderFrame",value:function(){var e=this.state,t=e.canvasHeight,a=e.canvasWidth;Ya.clearRect(0,0,a,t),Ya.save(),this.drawGround(),this.drawBalls()}},{key:"render",value:function(){var e=this.state,t=e.canvasHeight,a=e.canvasWidth,n=e.testClubIndex,i=e.testacceleration,s=e.testBallIndex,o=e.balls;return r.a.createElement("div",{className:"phase-container",id:"golfboard"},r.a.createElement("canvas",{id:"golfcanvas",height:t,width:a}),r.a.createElement("button",{type:"button",onClick:this.testSwing},"swing"),r.a.createElement(L.a,null,r.a.createElement(_.a,{htmlFor:"clubc-required"},"Club"),r.a.createElement(K.a,{value:n||0,onChange:this.handleChangeSelect,name:"testClubIndex",inputProps:{id:"club-required"}},Ha.map(function(e,t){return r.a.createElement(Q.a,{key:e.id,value:e.id},e.name)}))),r.a.createElement(M.a,{label:"Acceleration",name:"testacceleration",type:"number",value:i,margin:"normal",onChange:this.handleChange("testacceleration")}),o&&r.a.createElement(L.a,null,r.a.createElement(_.a,{htmlFor:"ball-required"},"Ball"),r.a.createElement(K.a,{value:s||0,onChange:this.handleChangeSelect,name:"testBallIndex",inputProps:{id:"ball-required"}},o.map(function(e,t){return r.a.createElement(Q.a,{key:e.ballIndex,value:e.ballIndex},e.ballIndex)}))))}}]),t}(n.Component),bn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).startCounter(),a.nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"startCounter",value:function(){var e=this,t=5,a=setInterval(function(){0===(t-=1)&&(e.nextPhase(),clearInterval(a))},1e3);return 5}},{key:"nextPhase",value:function(){var e=this.props,t=e.game,a=e.gameFunc;t.phase="gameplay",a.update(t)}},{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},r.a.createElement(C.b,{variant:"h2"},"Starting game"),r.a.createElement(Qe,{speed:"slow"}))}}]),t}(n.Component),En=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.handleChangeBool=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.checked))}},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))},a.startGame=function(e){var t=a.props,n=t.game,r=t.gameFunc,i=a.state,s={surveyPlayers:i.surveyPlayers,nameGenerator:i.nameGenerator,multiplayerMode:e,wallCollision:i.wallCollision,opponentCollision:i.opponentCollision,eatOpponents:i.eatOpponents,racetarget:i.racetarget,difficulty:i.difficulty,gamemode:i.gamemode};n.minigame=s,n.phase="connection",n.status="IN_PROGRESS",r.update(n)},a.state={surveyPlayers:!1,nameGenerator:!1,gamemode:e.game.minigame.gamemode,racetarget:e.game.minigame.racetarget,opponentCollision:e.game.minigame.opponentCollision,eatOpponents:e.game.minigame.eatOpponents,wallCollision:e.game.minigame.wallCollision,difficulty:e.game.minigame.difficulty},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.surveyPlayers,n=t.nameGenerator,i=t.wallCollision,s=t.opponentCollision,o=t.eatOpponents,l=t.racetarget,c=t.difficulty,m=t.gamemode;return r.a.createElement("div",{className:"phase-container"},r.a.createElement(C.b,{variant:"h4"},"Game Settings"),r.a.createElement(I.a,{onClick:function(){return e.startGame("classic")},variant:"contained"},"Classic"),r.a.createElement(I.a,{onClick:function(){return e.startGame("coop")},variant:"contained"},"Co-op multiplayer"),r.a.createElement(I.a,{onClick:function(){return e.startGame("team")},variant:"contained"},"Team multiplayer"),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(U.a,null,r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:n,onChange:this.handleChangeBool("nameGenerator"),value:"nameGenerator"}),label:"Generate names for players"}),r.a.createElement(L.a,{required:!0},r.a.createElement(_.a,{htmlFor:"gametype-required"},"Game mode"),r.a.createElement(K.a,{value:m||"",onChange:this.handleChangeSelect,name:"gamemode",inputProps:{id:"gamemode-required"}},r.a.createElement(Q.a,{value:"survival"},"Survival"),r.a.createElement(Q.a,{value:"race"},"Race"))),"race"===m&&r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Snake length",name:"racetarget",type:"number",value:l,margin:"normal",onChange:this.handleChange("racetarget")})),r.a.createElement(L.a,{required:!0},r.a.createElement(_.a,{htmlFor:"gametype-required"},"difficulty"),r.a.createElement(K.a,{value:c||"",onChange:this.handleChangeSelect,name:"difficulty",inputProps:{id:"difficulty-required"}},r.a.createElement(Q.a,{value:"500"},"Easy"),r.a.createElement(Q.a,{value:"300"},"Medium"),r.a.createElement(Q.a,{value:"100"},"Hard"),r.a.createElement(Q.a,{value:"75"},"Pro"))),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:i,onChange:this.handleChangeBool("wallCollision"),value:"wallCollision"}),label:"Wall collisions"})),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:s,onChange:this.handleChangeBool("opponentCollision"),value:"opponentCollision"}),label:"Opponent collisions"})),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:s&&o,disabled:!s,onChange:this.handleChangeBool("eatOpponents"),value:"eatOpponents"}),label:"Eat opponent on collision"})),r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:a,onChange:this.handleChangeBool("surveyPlayers"),value:"surveyPlayers"}),label:"Survey players after game"}))))}}]),t}(n.Component),wn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.handleChangeBool=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.checked))}},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))},a.startGame=function(e){var t=a.props,n=t.game,r=t.gameFunc,i=a.state,s=i.surveyPlayers,o=i.nameGenerator,l=i.holes,c=i.difficulty,m=i.gamemode,u=i.scoremode,h={surveyPlayers:s,nameGenerator:o,speedmode:i.speedmode,multiplayerMode:e,holes:l,difficulty:c,gamemode:m,scoremode:u};n.minigame=h,n.phase="connection",n.status="IN_PROGRESS",r.update(n)},a.state={surveyPlayers:!1,nameGenerator:!1,gamemode:e.game.minigame.gamemode,holes:e.game.minigame.holes,scoremode:e.game.minigame.scoremode,speedmode:e.game.minigame.speedmode,difficulty:e.game.minigame.difficulty},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.surveyPlayers,n=t.nameGenerator,i=t.holes,s=(t.difficulty,t.gamemode,t.scoremode),o=t.speedmode;return r.a.createElement("div",{className:"phase-container"},r.a.createElement(C.b,{variant:"h4"},"Game Settings"),r.a.createElement(I.a,{onClick:function(){return e.startGame("classic")},variant:"contained"},"Start"),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(U.a,null,r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:n,onChange:this.handleChangeBool("nameGenerator"),value:"nameGenerator"}),label:"Generate names for players"}),r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"holes to play",name:"holes",type:"number",value:i,margin:"normal",onChange:this.handleChange("holes")})),r.a.createElement(L.a,{required:!0},r.a.createElement(_.a,{htmlFor:"scoremode-required"},"Score mode"),r.a.createElement(K.a,{value:s||"",onChange:this.handleChangeSelect,name:"scoremode",inputProps:{id:"scoremode-required"}},r.a.createElement(Q.a,{value:"strokes"},"Strokes"),r.a.createElement(Q.a,{value:"time"},"Time"),r.a.createElement(Q.a,{value:"compedetive"},"Compedetive"))),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:o,onChange:this.handleChangeBool("speedmode"),value:"speedmode"}),label:"Speed mode"})),r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:a,onChange:this.handleChangeBool("surveyPlayers"),value:"surveyPlayers"}),label:"Survey players after game"}))))}}]),t}(n.Component),kn=24e5,On="cac8bf9ba7b34b3a8f727eecdef1a2a8",jn="https://spotify.i.lithium.com/t5/image/serverpage/image-id/25294i2836BD1C1A31BDF2/",xn=10,Cn=["user-top-read","user-read-private","playlist-read-private","playlist-read-collaborative"],Sn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.handleChangeBool=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.checked))}},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))},a.startGame=function(e){var t=a.props,n=t.game,r=t.gameFunc,i=a.state,s=i.surveyPlayers,o=i.nameGenerator,l=i.questions,c=i.gamemode,m=i.autoplay;n.minigame.surveyPlayers=s,n.minigame.nameGenerator=o,n.minigame.multiplayerMode=e,n.minigame.gamemode=c,n.minigame.autoplay=m,n.minigame.questions=l,n.minigame.currentq=0,n.phase="connection",n.status="IN_PROGRESS",r.update(n)},a.state={surveyPlayers:!1,questions:e.game.minigame.questions,nameGenerator:!1,autoplay:e.game.minigame.autoplay,gamemode:e.game.minigame.gamemode,invalidSpotifyToken:!localStorage.getItem("spotifytoken")||Date.now()-localStorage.getItem("spotifytoken_timestamp")>kn},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.state.invalidSpotifyToken,t=localStorage.getItem("spotifytoken");if(e){var a=window.location.origin+window.location.pathname;localStorage.setItem("spotify_type","host"),window.location="".concat("https://accounts.spotify.com/authorize","?client_id=").concat(On,"&redirect_uri=").concat(a,"&scope=").concat(Cn.join("%20"),"&response_type=token&show_dialog=true")}(new Headers).append("Authorization","Bearer ".concat(t))}},{key:"render",value:function(){var e=this,t=this.state,a=t.nameGenerator,n=t.questions,i=t.invalidSpotifyToken,s=t.autoplay;return i?r.a.createElement("span",null,"Loading..."):r.a.createElement("div",{className:"phase-container"},r.a.createElement(C.b,{variant:"h4"},"Game Settings"),r.a.createElement(I.a,{onClick:function(){return e.startGame("classic")},color:"primary"},"Start"),r.a.createElement(L.a,{component:"fieldset"},r.a.createElement(U.a,null,r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:a,onChange:this.handleChangeBool("nameGenerator"),value:"nameGenerator"}),label:"Generate names for players"}),r.a.createElement(J.a,{control:r.a.createElement(X.a,{checked:s,onChange:this.handleChangeBool("autoplay"),value:"autoplay"}),label:"Autoplay questions"}),r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Questions to play",name:"questions",type:"number",value:n,margin:"normal",onChange:this.handleChange("questions")})))))}}]),t}(n.Component),qn=a(78),Pn=a.n(qn),Nn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"nextPhase",value:function(){this.props.gameFunc.update({phase:"gameplay"})}},{key:"render",value:function(){var e=this.props,t=e.game,a=e.classes,n=t.players;return n=n?Object.values(n):[],r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(C.b,{className:a.header},r.a.createElement("span",null,"Join game with Game PIN: "),r.a.createElement("span",{className:a.pin},t.gameId)),r.a.createElement(C.b,{className:a.subheader},"mannfeldt.github.io/stagehoot"),r.a.createElement(C.b,{className:a.title},t.title)),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(x.a,{container:!0,direction:"row",justify:"center",alignItems:"flex-start"},n.map(function(e){return r.a.createElement(x.a,{key:e.key,item:!0,style:{padding:"15px 30px 30px 30px"}},e.avatar?r.a.createElement("img",{className:a.avatar,src:e.avatar,alt:e.name}):r.a.createElement(Pn.a,{classes:{root:a.icon}}),r.a.createElement(C.b,{className:a.secondaryText},e.name))}))),r.a.createElement("div",{className:"quiz-bottom-section"},r.a.createElement(I.a,{onClick:this.nextPhase,color:"primary"},"Start")))}}]),t}(n.Component),zn=Object($.withStyles)(function(e){return{container:{display:"flex",alignItems:"center",justifyContent:"center",flexFlow:"column"},avatar:{marginBottom:5,height:120,borderRadius:"50%",webkitBboxShadow:"0 0 10px rgba(0,0,0,.3)",boxShadow:"0 0 10px rgba(0,0,0,.3)"},icon:{height:120,width:120,marginTop:5},primaryText:{fontSize:18,color:"#fff",fontWeight:500},secondaryText:{fontSize:16,color:"#fff",fontWeight:400,opacity:.6},pin:{fontSize:32},header:{fontSize:28,padding:45,fontWeight:400,color:"#fff"},subheader:{fontSize:24,padding:45,fontWeight:400,color:"#fff",opacity:.7}}})(Nn),Tn=(n.Component,a(37)),Gn=a.n(Tn),Mn=a(56),An=a(107),In=a.n(An);var Fn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).getChartData=a.getChartData.bind(Object(h.a)(Object(h.a)(a))),a.getChartOptions=a.getChartOptions.bind(Object(h.a)(Object(h.a)(a))),a.getChartHeight=a.getChartHeight.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getChartData",value:function(){var e=this.props,t=e.game,a=e.correctAnswer,n={labels:[],datasets:[{data:[],label:"podium",backgroundColor:[],borderWidth:1}]};if(!t.answers)return n;for(var r=function(e){var t=Object.values(e.answers).filter(function(t){return t.question===e.minigame.currentq}),a=Object.values(e.players).map(function(e){return{name:e.name,playerKey:e.key,nr:t.reduce(function(t,a){return t+(a.answer&&a.answer.includes(e.key)?1:0)},0)}});return a.sort(function(e,t){return t.nr-e.nr}),a}(t),i=r.length>30?30:r.length,s=0;s<i;s++){n.labels.push(r[s].name),n.datasets[0].data.push(r[s].nr);var o=a.includes(r[s].playerKey)?"#1DB954":"#b3b3b3";n.datasets[0].backgroundColor.push(o)}return n}},{key:"getChartHeight",value:function(){var e=50+22*this.getChartData().labels.length;return e>620&&(e=620),e}},{key:"getChartOptions",value:function(){return{maintainAspectRatio:!1,showTooltips:!1,responsiveAnimationDuration:1e3,scales:{yAxes:[{ticks:{beginAtZero:!0,min:0,fontSize:13,fontColor:"rgba(255, 255, 255, 0.7)"},display:!0,beginAtZero:!0,maxBarThickness:3}],xAxes:[{display:!0,beginAtZero:!0,ticks:{beginAtZero:!0,min:0,fontSize:16,fontColor:"rgba(255, 255, 255, 0.7)",userCallback:function(e,t,a){return Math.floor(e)===e?e:null}}}]},legend:{display:!1},tooltips:{enabled:!1},events:[],layout:{padding:{left:60,right:60,bottom:620-this.getChartHeight()}}}}},{key:"render",value:function(){var e=this.getChartOptions();return r.a.createElement("div",{style:{maxHeight:620}},r.a.createElement(ht.b,{data:this.getChartData,height:620,options:e}))}}]),t}(n.Component),_n=a(170),Dn=a.n(_n),Qn=a(55),Bn=a.n(Qn),Ln=a(343),Wn=a.n(Ln),Kn=a(344),Rn=a.n(Kn),Hn=a(342),Vn=a.n(Hn);function Un(e){return 0===e.currentqScore?"".concat(e.totalScore):"".concat(e.totalScore," (+").concat(e.currentqScore,")")}var Yn=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChangePage=function(e,t){a.setState({page:t})},a.handleChangeRowsPerPage=function(e){a.setState({rowsPerPage:e.target.value})},a.state={leaderboard:e.leaderboardData,page:0,rowsPerPage:10},a.startScoreCounter=a.startScoreCounter.bind(Object(h.a)(Object(h.a)(a))),a.getScoreCellWidth=a.getScoreCellWidth.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){for(var e=this.state.leaderboard,t=0;t<e.length;t++){var a=e[t];a.totalScore+=a.currentqScore}e.sort(function(e,t){return t.totalScore-e.totalScore});for(var n=function(t){var a=e[t],n=Object(z.a)(e).sort(function(e,t){return t.totalScore-t.currentqScore-(e.totalScore-e.currentqScore)}).findIndex(function(e){return e.key===a.key}),r=e.findIndex(function(e){return e.key===a.key});a.posChange=n-r},r=0;r<e.length;r++)n(r);this.setState({leaderboard:e})}},{key:"getScoreCellWidth",value:function(){for(var e=this.state.leaderboard,t=0,a=0;a<e.length;a++){var n=Un(e[a]);n.length>t&&(t=n.length)}return 6*t+65}},{key:"startScoreCounter",value:function(){var e=this,t=setInterval(function(){for(var a=!0,n=e.state.leaderboard,r=0;r<n.length;r++){var i=n[r];i.addedScore||(i.addedScore=0),i.currentqScore>0&&(a=!1,i.currentqScore-=1,i.addedScore+=1,i.totalScore+=1)}n.sort(function(e,t){return t.totalScore-e.totalScore});for(var s=function(e){var t=n[e],a=Object(z.a)(n).sort(function(e,t){return t.totalScore-t.addedScore-(e.totalScore-e.addedScore)}).findIndex(function(e){return e.key===t.key}),r=n.findIndex(function(e){return e.key===t.key});t.posChange=a-r},o=0;o<n.length;o++)s(o);e.setState({leaderboard:n}),a&&clearInterval(t)},10)}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.leaderboard,n=t.rowsPerPage,i=t.page;return r.a.createElement("div",{className:e.root},r.a.createElement(xt.a,{className:e.table},r.a.createElement(Dn.a,null,r.a.createElement(Ot.a,null,r.a.createElement(wt.a,{padding:"dense"},"#"),r.a.createElement(wt.a,{padding:"dense"}),r.a.createElement(wt.a,{align:"right"},"Namn"),r.a.createElement(wt.a,{align:"right"},"Po\xe4ng"))),r.a.createElement(bt.a,null,a.slice(i*n,i*n+n).map(function(t,a){return r.a.createElement(Ot.a,{key:t.key},r.a.createElement(wt.a,{padding:"dense",className:e.faded,style:{width:40}},a+1),r.a.createElement(wt.a,{padding:"dense",style:{width:80}},!t.posChange&&r.a.createElement(Vn.a,{style:{opacity:.7}}),t.posChange>0&&r.a.createElement(Wn.a,{style:{color:"#1DB954"}}),t.posChange<0&&r.a.createElement(Rn.a,{style:{color:"red"}})),r.a.createElement(wt.a,null,r.a.createElement("div",{className:e.player},t.avatar?r.a.createElement(Bn.a,{alt:t.name,src:t.avatar}):r.a.createElement(Bn.a,null,r.a.createElement(Pn.a,null)),r.a.createElement("div",{className:e.playerText},r.a.createElement(C.b,null,t.name)))),r.a.createElement(wt.a,{align:"right",className:e.faded,style:{width:100}},t.totalScore))}))),a.length>10&&r.a.createElement(St.a,{component:"div",count:a.length,rowsPerPage:n,page:i,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}]),t}(n.Component),Jn=Object($.withStyles)(function(e){return{root:{width:"100%"},table:{maxWidth:700,whiteSpace:"nowrap",margin:"0 auto"},player:{display:"inline-flex",alignItems:"center"},playerText:{marginLeft:15},faded:{opacity:.7}}})(Yn),Zn=a(77),Xn=a.n(Zn),$n=a(129),er=a.n($n);var tr=Object($.withStyles)(function(e){return{primary:{fontSize:16},root:{backgroundColor:"inherit"},avatar:{height:120,width:120},itemtext:{fontSize:30}}})(function(e){var t=e.classes,a=e.players;if(!a||0===a.length)return null;var n=a.length>3;return r.a.createElement("div",null,r.a.createElement(ce.a,{dense:n,className:t.root},r.a.createElement(x.a,{container:!0,direction:"row",justify:"center",alignItems:"flex-start"},a.map(function(e){return r.a.createElement(x.a,{key:e.key,item:!0},r.a.createElement(er.a,{in:!0},r.a.createElement(ue.a,{className:t.listitem},r.a.createElement(Xn.a,null,e.avatar?r.a.createElement(Bn.a,{className:t.avatar,alt:e.name,src:e.avatar}):r.a.createElement(Bn.a,null,r.a.createElement(Pn.a,null))),r.a.createElement(de.a,{className:t.itemtext,primary:e.name}))))}))))});var ar=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={view:"correct"},a.nextQuestion=a.nextQuestion.bind(Object(h.a)(Object(h.a)(a))),a.finalizeQuiz=a.finalizeQuiz.bind(Object(h.a)(Object(h.a)(a))),a.getCorrectAnswer=a.getCorrectAnswer.bind(Object(h.a)(Object(h.a)(a))),a.getLeaderboardData=a.getLeaderboardData.bind(Object(h.a)(Object(h.a)(a))),a.answersCollected=a.answersCollected.bind(Object(h.a)(Object(h.a)(a))),a.getPlayers=a.getPlayers.bind(Object(h.a)(Object(h.a)(a))),a.toggleView=a.toggleView.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){if(this.props.game.minigame.autoplay){var e=this.getCorrectAnswer()||[];setTimeout(this.toggleView,Math.min(6e3,2e3+500*e.length))}}},{key:"getCorrectAnswer",value:function(){var e=this.props,t=(e.game,e.tracks),a=e.question,n=e.playlists;if(!a)return null;switch(a.qtype){case"track_owner":return t.filter(function(e){return e.id===a.track.id}).map(function(e){return e.playerKey});case"popularity":case"danceability":case"energy":case"valence":case"tempo":case"totalTracks":if("max"===a.subtype){var r=n.reduce(function(e,t){return e[a.qtype]>t[a.qtype]?e:t})[a.qtype];return n.filter(function(e){return e[a.qtype]===r}).map(function(e){return e.playerKey})}if("min"===a.subtype){var i=n.reduce(function(e,t){return e[a.qtype]<t[a.qtype]?e:t})[a.qtype];return n.filter(function(e){return e[a.qtype]===i}).map(function(e){return e.playerKey})}return null;case"artist":var s=n.reduce(function(e,t){return t.artists[a.artist]>e?t.artists[a.artist]:e},0);return n.filter(function(e){return e.artists[a.artist]===s}).map(function(e){return e.playerKey});case"genre":var o=n.reduce(function(e,t){return t.genres[a.genre]>e?t.genres[a.genre]:e},0);return n.filter(function(e){return e.genres[a.genre]===o}).map(function(e){return e.playerKey});default:return null}}},{key:"getLeaderboardData",value:function(e){var t=this.props.game,a=Object.values(t.players);if(!t.answers)return[];var n=Object.values(t.answers);return a.map(function(a){var r=0,i=n.find(function(e){return e.playerKey===a.key&&e.question===t.minigame.currentq});return i&&i.answer&&(i.answer=i.answer.filter(function(e){return"default"!==e}),r=i.answer.reduce(function(t,a){return e&&e.includes(a)?t+1:t-1},0)),{name:a.name,key:a.key,avatar:a.avatar,currentqScore:Math.max(0,r),totalScore:a.score}})}},{key:"getPlayers",value:function(e){var t=this.props.game,a=[];return e?(e.forEach(function(e){var n=t.players[e];a.push({name:n.name,avatar:n.avatar,key:n.key})}),a):a}},{key:"toggleView",value:function(){var e=this.state.view,t=this.props.game,a=t.minigame.currentq+1>=t.minigame.questions;"correct"===e?(t.minigame.autoplay&&setTimeout(this.toggleView,Math.min(1e4,3e3+500*Object.values(t.players).length)),this.setState(function(){return{view:"answer"}})):"answer"===e&&(t.minigame.autoplay&&(a?setTimeout(this.finalizeQuiz,Math.min(1e4,3e3+500*Object.values(t.players).length)):setTimeout(this.nextQuestion,Math.min(1e4,2e3+500*Object.values(t.players).length))),this.setState(function(){return{view:"leaderboard"}}))}},{key:"finalizeQuiz",value:function(){var e=this.props;e.gameFunc,e.game}},{key:"nextQuestion",value:function(){var e=this.props,t=e.game,a=e.gameFunc,n=e.nextQuestion,r=this.getLeaderboardData(this.getCorrectAnswer()),i=Object(pa.a)({},t);i.phase="gameplay",i.minigame.currentq+=1,r.forEach(function(e){i.players[e.key].score+=e.currentqScore}),a.update(i),n()}},{key:"playWinningSong",value:function(e){var t=this.props.tracks,a=e[Math.floor(Math.random()*e.length)],n=t.filter(function(e){return e.playerKey===a.key&&e.audio}).sort(function(){return Math.random()-.5})[0],r=new Audio(n.audio);r.volume=.1,r.play(),r.onended=function(){},r.canplay=function(){},r.ontimeupdate=function(){var e=r.duration-r.currentTime;e<=3?r.volume=e/3:r.volume<1&&(r.volume=Math.min(1,r.volume+.2))}}},{key:"answersCollected",value:function(){var e=this.props.game;if(!e.answers)return!1;var t=Object.values(e.answers).filter(function(t){return t.question===e.minigame.currentq});return t.length===Object.keys(e.players).length}},{key:"render",value:function(){var e=this.props,t=e.game,a=e.gameFunc,n=e.classes,i=this.state.view,s=t.minigame.currentq+1>=t.minigame.questions,o=this.getCorrectAnswer(),l=this.getLeaderboardData(o),c=this.getPlayers(o);if("leaderboard"===i){var m;if(s){var u=function(e){var t=e.reduce(function(e,t){return e.totalScore+e.currentqScore>t.totalScore+t.currentqScore?e:t}),a=t.totalScore+t.currentqScore;return e.filter(function(e){return e.totalScore+e.currentqScore===a}).map(function(e){return e.key})}(l);m=this.getPlayers(u),this.playWinningSong(m)}return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(x.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",className:n.headcontainer},r.a.createElement(x.a,{item:!0},r.a.createElement(C.b,{className:n.subheader},"Fr\xe5ga ".concat(t.minigame.currentq+1," av ").concat(t.minigame.questions,"  "))),r.a.createElement(x.a,{item:!0},s?r.a.createElement(C.b,{className:n.header},"Winner"):r.a.createElement(C.b,{className:n.header},"Leaderboard")),r.a.createElement(x.a,{item:!0},r.a.createElement(C.b,{className:n.subheader},"".concat(t.gameId)))),r.a.createElement(In.a,null),s&&r.a.createElement(tr,{players:m})),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement("div",null,r.a.createElement(Jn,{leaderboardData:l}))),r.a.createElement("div",{className:"quiz-bottom-section"},!t.minigame.autoplay&&r.a.createElement("div",{className:n.actions},s&&r.a.createElement(I.a,{onClick:this.finalizeQuiz,color:"primary"},"Finalize result"),!s&&r.a.createElement(I.a,{onClick:this.nextQuestion,color:"primary"},"Next question"),r.a.createElement(I.a,{onClick:a.restart,color:"secondary"},"Restart quiz"),r.a.createElement(I.a,{onClick:a.quit,color:"secondary"},"Quit quiz"),r.a.createElement(I.a,{onClick:a.end,color:"secondary"},"End quiz"))))}return"answer"===i?r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(x.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",className:n.headcontainer},r.a.createElement(x.a,{item:!0},r.a.createElement(C.b,{className:n.subheader},"Fr\xe5ga ".concat(t.minigame.currentq+1," av ").concat(t.minigame.questions,"  "))),r.a.createElement(x.a,{item:!0},r.a.createElement(C.b,{className:n.header},"Svarsf\xf6rdelning")),r.a.createElement(x.a,{item:!0},r.a.createElement(C.b,{className:n.subheader},"".concat(t.gameId)))),r.a.createElement(In.a,null)),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement("div",null,r.a.createElement(Fn,{game:t,correctAnswer:o||[]}))),r.a.createElement("div",{className:"quiz-bottom-section"},!t.minigame.autoplay&&r.a.createElement("div",{className:n.actions},r.a.createElement(I.a,{onClick:this.toggleView,color:"primary"},"Next")))):r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(x.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",className:n.headcontainer},r.a.createElement(x.a,{item:!0},r.a.createElement(C.b,{className:n.subheader},"Fr\xe5ga ".concat(t.minigame.currentq+1," av ").concat(t.minigame.questions,"  "))),r.a.createElement(x.a,{item:!0},r.a.createElement(C.b,{className:n.header},"R\xe4tt svar")),r.a.createElement(x.a,{item:!0},r.a.createElement(C.b,{className:n.subheader},"".concat(t.gameId)))),r.a.createElement(In.a,null)),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement("div",null,r.a.createElement(tr,{players:c}))),r.a.createElement("div",{className:"quiz-bottom-section"},!t.minigame.autoplay&&r.a.createElement("div",{className:n.actions},r.a.createElement(I.a,{onClick:this.toggleView,color:"primary"},"Next"))))}}]),t}(n.Component),nr=Object($.withStyles)(function(e){return{actions:{position:"absolute",bottom:15,left:"50%",marginLeft:"-426px"},itemtext:{overflow:"hidden"},header:{fontSize:28,padding:15,fontWeight:400},subheader:{fontSize:24,padding:15,opacity:.7,fontWeight:400},itemtextDense:{paddingLeft:2,paddingRight:2,overflow:"hidden"},listitem:{paddingLeft:12,paddingRight:38},container:{height:"100vh",width:"100vw"},headcontainer:{padding:15}}})(ar),rr=a(345);a(744);var ir=Object($.withStyles)(function(e){return{progress:{width:"100%",height:3,marginTop:10},linearColorPrimary:{backgroundColor:"#404040"},linearBarColorPrimary:{backgroundColor:"#1DB954"},hidden:{display:"none"},nosize:{width:0,height:0}}})(function(e){var t=e.progress,a=e.classes;return r.a.createElement(r.a.Fragment,null,r.a.createElement(lt.a,{className:a.progress,variant:"determinate",value:t,classes:{colorPrimary:a.linearColorPrimary,barColorPrimary:a.linearBarColorPrimary}}),r.a.createElement(rr.Progress,{percent:t,status:"success",className:a.nosize,symbolClassName:a.hidden}))});function sr(e){var t=e.filter(function(e){return e.audio&&e.artists});return t.filter(function(e,a){return a===t.findIndex(function(t){return t.id===e.id})})}function or(e){return e.reduce(function(e,t){return e+t.popularity},0)/e.length}function lr(e,t){var a=[];return e.forEach(function(e){a["".concat(e)]=a["".concat(e)]+1||1}),a.forEach(function(e){a["".concat(e)]=a["".concat(e)]/t}),a}function cr(e){e.sort(function(e,t){return("track_owner"===t.qtype)-("track_owner"===e.qtype)});var t=e.splice(0,Math.min(3,e.length-1)),a=e.splice(0,e.length);return a.sort(function(e,t){return"track_owner"===e.qtype&&"track_owner"!==t.qtype?Math.random()-.6:"track_owner"!==e.qtype&&"track_owner"===t.qtype?Math.random()-.4:Math.random()-.5}),t.concat(a)}function mr(e,t,a){var n=[],r=[];return e.forEach(function(e){var i=t.filter(function(t){return t.playerKey===e.playerKey&&!r.includes(t.id)});i.sort(function(){return Math.random()-.5});var s=i.filter(function(e,t){return t===i.findIndex(function(t){return t.img===e.img&&t.playerKey===e.playerKey})});s.length>a?s.length=a:(s=i.filter(function(e,t){return t===i.findIndex(function(t){return t.img===e.img&&t.playerKey===e.playerKey&&t.artists===e.artists})})).length>a&&(s.length=a),r.push.apply(r,Object(z.a)(s.map(function(e){return e.id}))),n.push.apply(n,Object(z.a)(s))}),n}function ur(e){var t={};return e.forEach(function(e){e&&(t["".concat(e)]=t["".concat(e)]+1||1)}),t}function hr(e){var t={},a=[];return e.forEach(function(e){a.push.apply(a,Object(z.a)(e.artistList))}),a.forEach(function(e){t["".concat(e)]=t["".concat(e)]+1||1}),t}function dr(e,t,a){var n=[];if(a.qFeatures){var r=e.length<10?10:15;n.push({qtype:"popularity",atype:"single",subtype:"max",text:"Vem har den trendigaste spellistan?",time:r}),n.push({qtype:"popularity",atype:"single",subtype:"min",text:"Vem har den minst trendiga spellistan?",time:r}),n.push({qtype:"danceability",atype:"single",subtype:"max",text:"Vem har den dansv\xe4nligaste spellistan?",time:r}),n.push({qtype:"danceability",atype:"single",subtype:"min",text:"Vem har den minst dansv\xe4nliga spellistan?",time:r}),n.push({qtype:"tempo",atype:"single",subtype:"max",text:"Vems spellista har h\xf6gst tempo?",time:r}),n.push({qtype:"tempo",atype:"single",subtype:"min",text:"Vems spellista har l\xe4gst tempo?",time:r}),n.push({qtype:"energy",atype:"single",subtype:"max",text:"Vem har den mest energifyllda spellistan?",time:r}),n.push({qtype:"valence",atype:"single",subtype:"max",text:"Vem har den gladaste spellistan?",time:r}),n.push({qtype:"valence",atype:"single",subtype:"min",text:"Vem har den dystraste spellistan?",time:r})}if(a.qSize){var i=e.length<10?10:15;n.push({qtype:"totalTracks",atype:"single",subtype:"min",text:"Vem har kortast spellista?",time:i}),n.push({qtype:"totalTracks",atype:"single",subtype:"max",text:"Vem har l\xe4ngst spellista?",time:i})}if(a.qArtist){var s=[];e.forEach(function(e){var t={qtype:"artist",subtype:"max",atype:"single",artist:e.topArtist.name,text:"Vem har flest l\xe5tar med ".concat(e.topArtist.name,"?"),img:e.topArtist.img,artistId:e.topArtist.id};s.some(function(e){return e.artistId===t.artistId})||s.push(t)}),s.length>t.length&&(s.length=Math.floor(t.length)),n.push.apply(n,s)}if(a.qGenre){var o=[];e.forEach(function(t){var a=Object.keys(t.genres).reduce(function(e,a){return t.genres[e]>t.genres[a]&&"pop"!==e?e:a}),n={qtype:"genre",subtype:"max",atype:"single",genre:a,text:'Vem har st\xf6rst andel l\xe5tar i genren "'.concat(a,'"?'),time:e.length<10?15:20};o.some(function(e){return e.text===n.text})||o.push(n);var r={qtype:"genre",subtype:"max",atype:"single",genre:Object.keys(t.genres).reduce(function(e,n){return t.genres[e]>t.genres[n]&&e!==a?e:n}),text:'Vem har st\xf6rst andel l\xe5tar i genren "'.concat(a,'"?'),time:e.length<10?15:20};o.some(function(e){return e.text===r.text})||o.push(r)}),o.length>t.length/2&&(o.length=Math.floor(t.length/2)),n.push.apply(n,o)}return a.qTrackOwner&&(t.sort(function(){return Math.random()-.5}),n.push.apply(n,Object(z.a)(t.map(function(e){return{qtype:"track_owner",atype:"multi",track:e,text:"Vem har denna l\xe5t i sin spellista?"}})))),console.table(n),n}function pr(e){return!(e.tracks.total<xn)}function gr(e){var t=Math.floor(e/60);t=t>=10?t:"0".concat(t);var a=Math.floor(e%60);return a=a>=10?a:"0".concat(a),"".concat(t,":").concat(a)}var fr=Object($.withStyles)(function(e){return{timeContainer:{display:"flex",marginTop:60,width:680},timeTextLeft:{marginRight:20,marginLeft:40,fontSize:16,color:"#fff",opacity:.6,fontWeight:400},timeTextRight:{marginRight:40,marginLeft:20,fontSize:16,color:"#fff",opacity:.6,fontWeight:400}}})(function(e){var t=e.time,a=e.duration,n=e.classes,i=gr(t),s=gr(a),o=t/(a-.5)*100;return r.a.createElement("div",{className:n.timeContainer},r.a.createElement(C.b,{className:n.timeTextLeft},i),r.a.createElement(ir,{progress:o}),r.a.createElement(C.b,{className:n.timeTextRight},s))});var vr=Object($.withStyles)(function(e){return{container:{display:"flex",alignItems:"center",justifyContent:"center",flexFlow:"column"},img:{marginBottom:45,maxHeight:540,webkitBboxShadow:"0 0 10px rgba(0,0,0,.3)",boxShadow:"0 0 10px rgba(0,0,0,.3)"},timeContainer:{display:"flex",marginTop:60,width:680},progress:{width:"100%",height:3,marginTop:10},linearColorPrimary:{backgroundColor:"#404040"},linearBarColorPrimary:{backgroundColor:"#1DB954"},timeTextLeft:{marginRight:20,marginLeft:40,fontSize:16,color:"#fff",opacity:.6,fontWeight:400},timeTextRight:{marginRight:40,marginLeft:20,fontSize:16,color:"#fff",opacity:.6,fontWeight:400},primaryText:{fontSize:18,color:"#fff",fontWeight:500},secondaryText:{fontSize:16,color:"#fff",fontWeight:400,opacity:.6},header:{fontSize:28,padding:45,fontWeight:400}}})(function(e){var t=e.track,a=e.classes,n=e.text;return r.a.createElement("div",{className:a.container},r.a.createElement(C.b,{className:a.header},n),r.a.createElement("img",{src:t.img,alt:"cover art",className:a.img,onError:function(e){e.target.onerror=null,e.target.src=jn}}),r.a.createElement("div",{className:a.footer},r.a.createElement(C.b,{className:a.primaryText},t.name),r.a.createElement(C.b,{className:a.secondaryText},t.artists),r.a.createElement(fr,{time:t.currentTime,duration:t.duration})))});function yr(e,t){var a=new Headers;return a.append("Authorization","Bearer ".concat(e)),{method:t,headers:a}}function br(e,t){return Er.apply(this,arguments)}function Er(){return(Er=Object(Mn.a)(Gn.a.mark(function e(t,a){var n,r,i,s,o,l;return Gn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=yr(a,"GET"),r=!0,i=0,s=[];case 4:if(!r){e.next=15;break}return e.next=7,fetch("https://api.spotify.com/v1/playlists/".concat(t,"/tracks?offset=").concat(i,"&market=from_token"),n);case 7:return o=e.sent,e.next=10,o.json();case 10:l=e.sent,s.push.apply(s,Object(z.a)(l.items)),l.items.length<100?r=!1:i+=100,e.next=4;break;case 15:return e.abrupt("return",s);case 16:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function wr(e,t){return kr.apply(this,arguments)}function kr(){return(kr=Object(Mn.a)(Gn.a.mark(function e(t,a){var n,r,i,s,o,l,c,m;return Gn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=yr(a,"GET"),r=[],50;t.length>0;)r.push(t.splice(0,50));i=[],s=0;case 6:if(!(s<r.length)){e.next=19;break}return o=r[s],l=o.join(","),e.next=11,fetch("https://api.spotify.com/v1/artists?ids=".concat(l),n);case 11:return c=e.sent,e.next=14,c.json();case 14:m=e.sent,i.push.apply(i,Object(z.a)(m.artists));case 16:s++,e.next=6;break;case 19:return e.abrupt("return",i);case 20:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Or(e,t){return jr.apply(this,arguments)}function jr(){return(jr=Object(Mn.a)(Gn.a.mark(function e(t,a){var n,r,i;return Gn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=yr(a,"GET"),e.next=3,fetch("https://api.spotify.com/v1/artists/".concat(t,"/top-tracks?market=from_token"),n);case 3:return r=e.sent,e.next=6,r.json();case 6:return i=e.sent,e.abrupt("return",i.tracks);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function xr(e,t){return Cr.apply(this,arguments)}function Cr(){return(Cr=Object(Mn.a)(Gn.a.mark(function e(t,a){var n,r,i,s,o,l,c,m;return Gn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=yr(a,"GET"),r=[],100;t.length>0;)r.push(t.splice(0,100));i=[],s=0;case 6:if(!(s<r.length)){e.next=19;break}return o=r[s],l=o.join(","),e.next=11,fetch("https://api.spotify.com/v1/audio-features?ids=".concat(l),n);case 11:return c=e.sent,e.next=14,c.json();case 14:m=e.sent,i.push.apply(i,Object(z.a)(m.audio_features));case 16:s++,e.next=6;break;case 19:return e.abrupt("return",i);case 20:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Sr(e,t){return qr.apply(this,arguments)}function qr(){return(qr=Object(Mn.a)(Gn.a.mark(function e(t,a){var n,r,i,s;return Gn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=yr(a,"GET"),r=encodeURI(t),e.next=4,fetch("https://api.spotify.com/v1/search?q=genre%3A%22".concat(r,"%22&type=track&market=from_token&limit=50"),n);case 4:return i=e.sent,e.next=7,i.json();case 7:return s=e.sent,e.abrupt("return",s.tracks);case 9:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Pr=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))},a.handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}};var n=Object.values(e.game.players).length;return a.state={spotifytoken:localStorage.getItem("spotifytoken")||"",tokentimestamp:localStorage.getItem("spotifytoken_timestamp")||"",playlists:[],tracks:[],questionTracks:[],questions:[],usedQuestions:[],topArtists:[],questionPlaying:!1,progress:0,progressText:"",songCurrentTime:0,counter:0,songDuration:n<10?20:30},a.nextPhase=a.nextPhase.bind(Object(h.a)(Object(h.a)(a))),a.playQuestion=a.playQuestion.bind(Object(h.a)(Object(h.a)(a))),a.saveGame=a.saveGame.bind(Object(h.a)(Object(h.a)(a))),a.nextQuestion=a.nextQuestion.bind(Object(h.a)(Object(h.a)(a))),a.getArtistTopTrack=a.getArtistTopTrack.bind(Object(h.a)(Object(h.a)(a))),a.initQuiz=a.initQuiz.bind(Object(h.a)(Object(h.a)(a))),a.setProgress=a.setProgress.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(Mn.a)(Gn.a.mark(function e(){var t,a,n,r,i,s,o,l,c,m,u,h=this;return Gn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.game,a=this.state,n=a.spotifytoken,r=a.tokentimestamp,i=performance.now(),(!n||Date.now()-r>kn)&&("https://accounts.spotify.com/authorize",s=window.location.origin+window.location.pathname,localStorage.setItem("spotify_type","host"),window.location="".concat("https://accounts.spotify.com/authorize","?client_id=").concat(On,"&redirect_uri=").concat(s,"&scope=").concat(Cn.join("%20"),"&response_type=token&show_dialog=true")),o=Object.values(t.players),l=Math.ceil(t.minigame.questions/o.length),c=80/o.length,m=Gn.a.mark(function e(a){var r,s,m,u,d,p,g,f,v,y,b,E,w,k;return Gn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o[a],h.setProgress(0,!0,"L\xe4ser spellista f\xf6r ".concat(r.name)),e.next=4,br(r.playlist,n);case 4:if(s=e.sent,h.setProgress(c/2,!0),m=s.filter(function(e){return e&&e.track&&e.track.id}).filter(function(e,t,a){return a.findIndex(function(t){return t.track.id===e.track.id})===t}),u=m.map(function(e){return{name:e.track.name,audio:e.track.preview_url,artists:e.track.artists.map(function(e){return e.name}).join(", "),artistList:e.track.artists.map(function(e){return e.name}),img:e.track.album.images.length>0?e.track.album.images[0].url:jn,playerKey:r.key,playerName:r.name,id:e.track.id,popularity:e.track.popularity}}),d={playerKey:r.key,playerName:r.name,totalTracks:u.length},!t.minigame.qArtist&&!t.minigame.qGenre){e.next=20;break}return p=m.map(function(e){return e.track.artists.map(function(e){return e.id}).join(",")}).join(",").split(","),g=ur(p),f=Object.keys(g),e.next=15,wr(f,n);case 15:v=e.sent,y=[],v.forEach(function(e){for(var t=g[e.id],a=0;a<t;a++)y.push.apply(y,Object(z.a)(e.genres))}),d.genres=lr(y,d.totalTracks),t.minigame.qArtist&&(d.artists=hr(u),b=Object.keys(d.artists).reduce(function(e,t){return d.artists[e]>d.artists[t]&&u.find(function(t){return t.artists.includes(e)&&t.audio})?e:t}),E=v.find(function(e){return e.name===b}),d.topArtist={id:E.id,name:E.name,img:E.images.length>0?E.images[0].url:jn});case 20:if(!t.minigame.qFeatures){e.next=30;break}return d.popularity=or(u),w=u.map(function(e){return e.id}),e.next=25,xr(w,n);case 25:k=e.sent,d.danceability=k.reduce(function(e,t){return e+t.danceability},0)/k.length,d.energy=k.reduce(function(e,t){return e+t.energy},0)/k.length,d.tempo=k.reduce(function(e,t){return e+t.tempo},0)/k.length,d.valence=k.reduce(function(e,t){return e+t.valence},0)/k.length;case 30:h.setProgress(c/2,!0),h.setState(function(e){return{playlists:Object(z.a)(e.playlists).concat([d]),tracks:Object(z.a)(e.tracks).concat(Object(z.a)(u))}},function(){if(a+1===o.length){h.setProgress(85,!1,"Genererar fr\xe5gor");var e=h.state,n=e.playlists,r=dr(n,mr(n,sr(e.tracks),l),t.minigame);r.sort(function(){return Math.random()-.5}),r.length>t.minigame.questions&&(r.length=t.minigame.questions);var s=cr(r);h.setProgress(90,!1),h.setState(function(){return console.table(s),{questions:s}},function(){var e=h.state.questions;e.length<t.minigame.questions&&(t.minigame.questions=e.length,h.saveGame(t));var a=performance.now();console.log("componentDidMount took ".concat(a-i," milliseconds.")),h.initQuiz()})}});case 32:case"end":return e.stop()}},e,this)}),u=0;case 9:if(!(u<o.length)){e.next=14;break}return e.delegateYield(m(u),"t0",11);case 11:u++,e.next=9;break;case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"shouldComponentUpdate",value:function(){return!0}},{key:"getArtistTopTrack",value:function(){var e=Object(Mn.a)(Gn.a.mark(function e(t){var a,n,r,i;return Gn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state.spotifytoken,e.next=3,Or(t.artistId,a);case 3:return n=e.sent,r=Math.floor(Math.random()*Math.min(10,n.length)),i={img:t.img,audio:n[r].preview_url},e.abrupt("return",i);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getGenreTopTrack",value:function(){var e=Object(Mn.a)(Gn.a.mark(function e(t){var a,n,r,i,s,o;return Gn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state.spotifytoken,e.next=3,Sr(t.genre,a);case 3:return n=e.sent,r=n.items.filter(function(e){return e.preview_url}),i=Math.floor(Math.random()*Math.min(10,r.length)),s=r[i],o={name:s.name,img:s.album.images.length>0?s.album.images[0].url:jn,audio:s.preview_url,artists:s.artists.map(function(e){return e.name}).join(", ")},e.abrupt("return",o);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setProgress",value:function(e,t,a){this.setState(function(n){return{progress:t?n.progress+e:e,progressText:a||n.progressText}})}},{key:"initQuiz",value:function(){var e=Object(Mn.a)(Gn.a.mark(function e(){var t,a,n,r,i,s,o,l,c,m=this;return Gn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state,a=t.questions,n=t.tracks,r=this.props.game,i=performance.now(),s=Object(z.a)(a),o=Gn.a.mark(function e(t,a){var r,i;return Gn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=s[t],e.t0=r.qtype,e.next="artist"===e.t0?4:"genre"===e.t0?9:13;break;case 4:return e.next=6,m.getArtistTopTrack(r);case 6:return r.track=e.sent,r.track.audio||(i=n.find(function(e){return e.artists.includes(r.artist)&&e.audio}))&&(r.track.audio=i.audio),e.abrupt("break",14);case 9:return e.next=11,m.getGenreTopTrack(r);case 11:return r.track=e.sent,e.abrupt("break",14);case 13:return e.abrupt("break",14);case 14:case"end":return e.stop()}},e,this)}),l=0,c=s.length;case 6:if(!(l<c)){e.next=11;break}return e.delegateYield(o(l,c),"t0",8);case 8:l++,e.next=6;break;case 11:this.setProgress(100,!1),this.setState(function(){return{questions:s}},function(){if("gameplay"===r.phase){var e=performance.now();console.log("initQuiz took ".concat(e-i," milliseconds.")),m.playQuestion()}});case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"nextQuestion",value:function(){this.playQuestion()}},{key:"playQuestion",value:function(){var e=this,t=this.state,a=t.questions,n=(t.tracks,t.songDuration),r=a[this.props.game.minigame.currentq];if(this.setState({questionPlaying:!0}),r.track){var i=new Audio(r.track.audio);i.onerror=function(){console.log("error on track audio:".concat(r.track)),setTimeout(e.nextPhase(),15e3)},i.volume=0,i.play(),i.ontimeupdate=function(){var t=(n||i.duration)-i.currentTime;if(t<=0)return i.pause(),void e.nextPhase();t<=3?i.volume=t/3:i.volume<1&&(i.volume=Math.min(1,i.volume+.1)),e.setState(function(){return{songCurrentTime:i.currentTime}})}}else var s=10*r.time,o=setInterval(function(){s-=1,e.setState(function(){return{counter:s}},function(){e.state.counter<=0&&(e.nextPhase(),clearInterval(o))})},100)}},{key:"saveGame",value:function(e){this.props.gameFunc.update(e)}},{key:"nextPhase",value:function(){var e=this.props.game;this.setState({questionPlaying:!1}),e.phase="level_completed",this.saveGame(e)}},{key:"render",value:function(){var e=this.props,t=e.game,a=e.gameFunc,n=this.state,i=n.tracks,s=n.questions,o=n.questionPlaying,l=n.songCurrentTime,c=n.songDuration,m=n.playlists,u=n.progress,h=n.counter,d=n.progressText;if("gameplay"===t.phase&&!o)return r.a.createElement("div",{style:{marginTop:30}},r.a.createElement(C.b,{style:{fontSize:28,padding:15,fontWeight:400}},d),r.a.createElement(ir,{progress:u}));var p,g=s[t.minigame.currentq];if("level_completed"===t.phase)return r.a.createElement(nr,{game:t,playlists:m,gameFunc:a,tracks:i,question:g,nextQuestion:this.nextQuestion});g.time&&(p=(10*g.time-h)/10);switch(g.qtype){case"track_owner":case"artist":case"genre":return r.a.createElement("div",null,r.a.createElement(vr,{text:g.text,track:Object(pa.a)({},g.track,{currentTime:l,duration:c})}));case"popularity":case"tempo":case"energy":case"valence":case"danceability":case"totalTracks":return r.a.createElement("div",null,r.a.createElement(vr,{text:g.text,track:{img:jn,currentTime:p,duration:g.time}}));default:return null}}}]),t}(n.Component),Nr=Object($.createMuiTheme)({palette:{type:"dark",primary:{main:"#1DB954"},secondary:{main:"#fff"}},overrides:{MuiButton:{root:{borderRadius:500,padding:"11px 44px",color:"#fff",letterSpacing:".16em",WebkitTransition:"none 33ms cubic-bezier(.3,0,.7,1)",transition:"none 33ms cubic-bezier(.3,0,.7,1)",WebkitTransitionProperty:"all",transitionProperty:"all",touchAction:"manipulation",willChange:"transform",lineHeight:1.6,minWidth:130,margin:10,fontWeight:300,fontSize:11,"&:hover":{WebkitTransition:"none 33ms cubic-bezier(.3,0,0,1)",transition:"none 33ms cubic-bezier(.3,0,0,1)",WebkitTransitionProperty:"all",transitionProperty:"all",WebkitTransform:"scale(1.06)",transform:"scale(1.06)"}},textPrimary:{backgroundColor:"#1DB954",color:"#fff","&:hover":{backgroundColor:"#1ed760"}},textSecondary:{backgroundColor:"rgba(24,24,24,.7)","&:hover":{backgroundColor:"rgba(24,24,24,.7)",webkitBoxShadow:"inset 0 0 0 2px #fff, 0 0 0 1px rgba(0,0,0,0)",boxShadow:"inset 0 0 0 2px #fff, 0 0 0 1px rgba(0,0,0,0)"},webkitBoxShadow:"inset 0 0 0 2px #b3b3b3",boxShadow:"inset 0 0 0 2px #b3b3b3"}}}}),zr=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.game,a=e.gameFunc;switch(t.gametype){case"snake":return r.a.createElement("div",{className:"host-container"},"setup"===t.phase&&r.a.createElement(En,{game:t,gameFunc:a}),"connection"===t.phase&&r.a.createElement(Mt,{game:t,gameFunc:a}),"starting"===t.phase&&r.a.createElement(da,{game:t,gameFunc:a}),"gameplay"===t.phase&&r.a.createElement(Vt,{game:t,gameFunc:a}),"final_result"===t.phase&&r.a.createElement(oa,{game:t,gameFunc:a}),"end"===t.phase&&r.a.createElement(la,{game:t,gameFunc:a}));case"tetris":return r.a.createElement("div",{className:"host-container"},"setup"===t.phase&&r.a.createElement(Gt,{game:t,gameFunc:a}),"connection"===t.phase&&r.a.createElement(Mt,{game:t,gameFunc:a}),"starting"===t.phase&&r.a.createElement(At,{game:t,gameFunc:a}),"gameplay"===t.phase&&r.a.createElement(Ut,{game:t,gameFunc:a}),"final_result"===t.phase&&r.a.createElement(oa,{game:t,gameFunc:a}),"end"===t.phase&&r.a.createElement(la,{game:t,gameFunc:a}));case"golf":return r.a.createElement("div",{className:"host-container"},"setup"===t.phase&&r.a.createElement(wn,{game:t,gameFunc:a}),"connection"===t.phase&&r.a.createElement(Mt,{game:t,gameFunc:a}),"starting"===t.phase&&r.a.createElement(bn,{game:t,gameFunc:a}),("gameplay"===t.phase||"level_completed"===t.phase)&&r.a.createElement(yn,{game:t,gameFunc:a}),"final_result"===t.phase&&r.a.createElement(oa,{game:t,gameFunc:a}),"end"===t.phase&&r.a.createElement(la,{game:t,gameFunc:a}));case"spotify":return document.querySelector("body").classList.add("dark-mode"),r.a.createElement($.MuiThemeProvider,{theme:Nr},r.a.createElement("div",{className:"host-container"},"setup"===t.phase&&r.a.createElement(Sn,{game:t,gameFunc:a}),"connection"===t.phase&&r.a.createElement(zn,{game:t,gameFunc:a}),("gameplay"===t.phase||"level_completed"===t.phase)&&r.a.createElement(Pr,{game:t,gameFunc:a}),"final_result"===t.phase&&r.a.createElement(oa,{game:t,gameFunc:a}),"end"===t.phase&&r.a.createElement(la,{game:t,gameFunc:a})));default:return null}}}]),t}(n.PureComponent);var Tr=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.state={game:{},gameId:localStorage.getItem("RecentGameId")||"",password:"",isRedirected:Date.now()-localStorage.getItem("spotifytoken_timestamp")<2e3},a.updateGame=a.updateGame.bind(Object(h.a)(Object(h.a)(a))),a.initGameListiner=a.initGameListiner.bind(Object(h.a)(Object(h.a)(a))),a.restartGame=a.restartGame.bind(Object(h.a)(Object(h.a)(a))),a.quitGame=a.quitGame.bind(Object(h.a)(Object(h.a)(a))),a.endGame=a.endGame.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.state,t=e.gameId;e.isRedirected&&this.joinGame(t)}},{key:"updateGame",value:function(e){var t=this.props.showSnackbar,a=this.state.game;v.database().ref("games/".concat(a.key)).update(e,function(e){if(e){t({variant:"error",message:"Unexpected internal error"})}})}},{key:"restartGame",value:function(){var e={players:[],phase:"setup"};this.updateGame(e)}},{key:"quitGame",value:function(){var e=this.props.toggleHeader;this.updateGame({phase:null}),e(!0)}},{key:"endGame",value:function(){this.updateGame({phase:"final_result"})}},{key:"joinGame",value:function(e){var t=this.state.password,a=this.props,n=a.showSnackbar,r=a.toggleHeader,i=this;!function(e,t){v.database().ref("games").orderByChild("gameId").equalTo(e).once("value",t)}(e,function(e){if(e.val()){var a;if(e.forEach(function(e){a=e.val()}),a.password===t)i.initGameListiner(a.key),r();else{n({variant:"error",message:"Could not find matching game"})}}else{n({variant:"info",message:"No game found"})}})}},{key:"initGameListiner",value:function(e){var t=v.database().ref("games/".concat(e)),a=this;t.on("value",function(e){var t=e.val();t.phase||(t.phase="setup"),t?a.setState({game:t}):a.setState({game:""})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.gameId,n=t.password,i=t.game,s=t.isRedirected,o=this.props,l=(o.showSnackbar,o.toggleHeader,{update:this.updateGame,restart:this.restartGame,end:this.endGame,quit:this.quitGame});return!i.phase&&s?r.a.createElement("div",null,r.a.createElement("span",null,"Loading...")):i.phase?r.a.createElement("div",{className:"page-container host-page"},"quiz"===i.gametype&&r.a.createElement(Tt,{game:i,gameFunc:l}),"snake"===i.gametype&&r.a.createElement(zr,{game:i,gameFunc:l}),"tetris"===i.gametype&&r.a.createElement(zr,{game:i,gameFunc:l}),"golf"===i.gametype&&r.a.createElement(zr,{game:i,gameFunc:l}),"spotify"===i.gametype&&r.a.createElement(zr,{game:i,gameFunc:l})):r.a.createElement("div",{className:"page-container host-page"},r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Game PIN",name:"Game ID",value:a,margin:"normal",onChange:this.handleChange("gameId")})),r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Password",type:"password",name:"password",margin:"normal",value:n,onChange:this.handleChange("password")})),r.a.createElement(I.a,{onClick:function(){return e.joinGame(a)},variant:"contained"},"Host"))}}]),t}(n.Component),Gr=a(105),Mr=a.n(Gr),Ar=a(229),Ir=a.n(Ar),Fr=a(353),_r=a.n(Fr),Dr=a(354),Qr=a.n(Dr),Br=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.state={name:"",authId:"",playerCreated:!1},a.createPlayer=a.createPlayer.bind(Object(h.a)(Object(h.a)(a))),a.generateName=a.generateName.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){!this.props.playerKey&&this.props.game.quiz.nameGenerator&&this.props.addPlayer(this.generatePlayer())}},{key:"createPlayer",value:function(){var e={name:this.state.name,score:0};this.props.addPlayer(e),this.setState({playerCreated:!0})}},{key:"generatePlayer",value:function(){return{name:this.generateName(),score:0}}},{key:"generateName",value:function(){var e=["adamant","adroit","amatory","animistic","antic","arcadian","baleful","bellicose","bilious","boorish","calamitous","caustic","cerulean","comely","concomitant","contumacious","corpulent","crapulous","defamatory","didactic","dilatory","dowdy","efficacious","effulgent","egregious","endemic","equanimous","execrable","fastidious","feckless","fecund","friable","fulsome","garrulous","guileless","gustatory","heuristic","histrionic","hubristic","incendiary","insidious","insolent","intransigent","inveterate","invidious","irksome","jejune","jocular","judicious","lachrymose","limpid","loquacious","luminous","mannered","mendacious","meretricious","minatory","mordant","munificent","nefarious","noxious","obtuse","parsimonious","pendulous","pernicious","pervasive","petulant","platitudinous","precipitate","propitious","puckish","querulous","quiescent","rebarbative","recalcitant","redolent","rhadamanthine","risible","ruminative","sagacious","salubrious","sartorial","sclerotic","serpentine","spasmodic","strident","taciturn","tenacious","tremulous","trenchant","turbulent","turgid","ubiquitous","uxorious","verdant","voluble","voracious","wheedling","withering","zealous"],t=["ninja","chair","pancake","statue","unicorn","rainbows","laser","senor","bunny","captain","nibblets","cupcake","carrot","gnomes","glitter","potato","salad","toejam","curtains","beets","toilet","exorcism","stick figures","mermaid eggs","sea barnacles","dragons","jellybeans","snakes","dolls","bushes","cookies","apples","ice cream","ukulele","kazoo","banjo","opera singer","circus","trampoline","carousel","carnival","locomotive","hot air balloon","praying mantis","animator","artisan","artist","colorist","inker","coppersmith","director","designer","flatter","stylist","leadman","limner","make-up artist","model","musician","penciller","producer","scenographer","set decorator","silversmith","teacher","auto mechanic","beader","bobbin boy","clerk of the chapel","filling station attendant","foreman","maintenance engineering","mechanic","miller","moldmaker","panel beater","patternmaker","plant operator","plumber","sawfiler","shop foreman","soaper","stationary engineer","wheelwright","woodworkers"],a="",n=[];this.props.game.players&&(n=Object.values(this.props.game.players).map(function(e){return e.name}));for(var r=0;r<20;r++){var i="";if(i=r>10?e[Math.floor(Math.random()*e.length)]+" "+e[Math.floor(Math.random()*e.length)]+" "+t[Math.floor(Math.random()*t.length)]:e[Math.floor(Math.random()*e.length)]+" "+t[Math.floor(Math.random()*t.length)],!(n.indexOf(i)>-1)){a=i;break}}return a}},{key:"render",value:function(){var e=this.props.game.players,t="";e&&this.props.playerKey&&(t=e[this.props.playerKey].name);var a=[];return e&&(a=Object.values(e)),this.props.game.quiz.remoteMode?r.a.createElement("div",{className:"phase-container"},t&&r.a.createElement("div",null,r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(C.b,{variant:"h5"},"Welcome ",r.a.createElement("span",{className:"dynamic-text"},t),"! ")),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{paragraph:!0,variant:"subtitle1"},"Players in lobby"),r.a.createElement(x.a,{container:!0},a.map(function(e,t){return r.a.createElement(x.a,{key:e.key,item:!0,md:3,xs:6},r.a.createElement(C.b,{paragraph:!0,variant:"body1"},e.name))}))),r.a.createElement("div",{className:"quiz-bottom-section"},r.a.createElement(C.b,{paragraph:!0,variant:"subtitle1"},"Waiting for the host to start the game"))),!t&&r.a.createElement("div",null,r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Name",name:"name",value:this.state.name,margin:"normal",onChange:this.handleChange("name")})),r.a.createElement(I.a,{onClick:this.createPlayer,variant:"contained"},"done"))):r.a.createElement("div",{className:"phase-container"},t&&r.a.createElement("div",null,r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"h5"},"Welcome ",r.a.createElement("span",{className:"dynamic-text"},t),"!"),r.a.createElement(C.b,{variant:"subtitle1"}," Watch the screen, your name should show.")),r.a.createElement("div",{className:"quiz-bottom-section"})),!t&&r.a.createElement("div",null,r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Name",name:"name",value:this.state.name,margin:"normal",onChange:this.handleChange("name")})),r.a.createElement(I.a,{onClick:this.createPlayer,variant:"contained"},"done")))}}]),t}(n.Component),Lr=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.props.game.quiz.remoteMode?r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(C.b,{variant:"h5"},"Starting quiz")),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(Qe,{speed:"slow"})),r.a.createElement("div",{className:"quiz-bottom-section"})):r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"h5"},"Starting quiz...")),r.a.createElement("div",{className:"quiz-bottom-section"}))}}]),t}(n.Component),Wr=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.props.game.quiz.remoteMode?r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(C.b,{variant:"h5"},"Loading question")),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(Qe,{speed:"slow"})),r.a.createElement("div",{className:"quiz-bottom-section"})):r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"h5"},"Look at the screen.")),r.a.createElement("div",{className:"quiz-bottom-section"}))}}]),t}(n.Component),Kr=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.props.game.quiz.remoteMode?r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"h5"},this.props.game.quiz.questions[this.props.game.quiz.currentQuestion].question)),r.a.createElement("div",{className:"quiz-bottom-section"})):r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"h5"},"Look at the question on the screen!")),r.a.createElement("div",{className:"quiz-bottom-section"}))}}]),t}(n.Component),Rr=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).answerQuestion=function(e){a.setState({selectedAnswer:e,hasAnswered:!0});var t=Date.now()-a.state.startTime,n=0;if(a.state.question.correctAnswers.indexOf(e)>-1){switch(a.state.question.difficulty){case"easy":n+=100;break;case"medium":n+=200;break;case"hard":n+=300;break;case void 0:n+=200}if(a.props.game.quiz.timelimit&&a.state.question.timelimit){var r=t/(1e3*a.state.question.timelimit);n+=Math.floor(n/Math.max(.2,r)/10)}}var i={answer:e,score:n,answerTime:t,questionId:a.state.question.id};a.props.saveAnswer(i)},a.state={counter:0,question:{},hasAnswered:!1,selectedAnswer:""},a.answerQuestion=a.answerQuestion.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.game.quiz.questions[this.props.game.quiz.currentQuestion];this.setState({question:e,startTime:Date.now()})}},{key:"render",value:function(){var e=this,t=[];return this.props.game&&(t=this.props.game.quiz.questions[this.props.game.quiz.currentQuestion].answers),this.props.game.quiz.remoteMode?this.state.hasAnswered?r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(C.b,{paragraph:!0,variant:"h5"},this.props.game.quiz.questions[this.props.game.quiz.currentQuestion].question)),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"body1"},"You answered: ",r.a.createElement("span",{className:"dynamic-text"},this.state.selectedAnswer))),r.a.createElement("div",{className:"quiz-bottom-section"})):r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(C.b,{variant:"h5"},this.props.game.quiz.questions[this.props.game.quiz.currentQuestion].question)),r.a.createElement("div",{className:"quiz-middle-and-bottom-section"},r.a.createElement(x.a,{container:!0,spacing:8,className:"full-height"},t.map(function(t,a){return r.a.createElement(x.a,{key:a,item:!0,xs:6},r.a.createElement(at,{answer:t,index:a,answerQuestion:e.answerQuestion,remoteMode:!0}))})))):this.state.hasAnswered?r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"body1"},"You answered: ",r.a.createElement("span",{className:"dynamic-text"},this.state.selectedAnswer))),r.a.createElement("div",{className:"quiz-bottom-section"})):r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-complete-section"},r.a.createElement(x.a,{container:!0,spacing:8,className:"full-height"},t.map(function(t,a){return r.a.createElement(x.a,{key:a,item:!0,xs:6},r.a.createElement(at,{answer:t,index:a,answerQuestion:e.answerQuestion}))}))))}}]),t}(n.Component),Hr=a(108),Vr=a.n(Hr),Ur=a(109),Yr=a.n(Ur),Jr=a(110),Zr=a.n(Jr),Xr=a(87),$r=a.n(Xr),ei=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t,n){a.setState({expanded:!!n&&e})}},a.state={expanded:null},a.getPlayerAnswerData=a.getPlayerAnswerData.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getPlayerAnswerData",value:function(){for(var e=[],t=this.props.game.players[this.props.playerKey],a=0;a<this.props.game.quiz.questions.length;a++){var n={question:{},score:0,time:0,answer:""},r=this.props.game.quiz.questions[a];t.answers[r.id]?(n.score=t.answers[r.id].score,n.answer=t.answers[r.id].answer,n.time=t.answers[r.id].answerTime):(n.score=0,n.answer="no answer",n.time=0),n.question=r,e.push(n)}return e}},{key:"render",value:function(){var e=this;if(this.props.game.quiz.remoteMode){var t=this.getPlayerAnswerData();return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(C.b,{variant:"h5"},"Quiz finished")),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"subtitle1"},"You finished",r.a.createElement("span",{className:"dynamic-text"},"2nd")," with a score of  ",r.a.createElement("span",{className:"dynamic-text"},"560")),r.a.createElement(Vr.a,null,r.a.createElement(Yr.a,{expandIcon:r.a.createElement($r.a,null)},r.a.createElement(C.b,null,"Final scoretable")),r.a.createElement(Zr.a,null,r.a.createElement("div",null,r.a.createElement(pt,{game:this.props.game})))),r.a.createElement(Vr.a,null,r.a.createElement(Yr.a,{expandIcon:r.a.createElement($r.a,null)},r.a.createElement(C.b,null,"Your own data")),r.a.createElement(Zr.a,{style:{display:"block"}},t.map(function(t,a){return r.a.createElement(Vr.a,{key:t.question.id,expanded:e.state.expanded===t.question.id,onChange:e.handleChange(t.question.id)},r.a.createElement(Yr.a,{expandIcon:r.a.createElement($r.a,null)},r.a.createElement(C.b,{variant:"subtitle1"},t.question.question),r.a.createElement(C.b,{variant:"subtitle2"},t.score,"pt")),r.a.createElement(Zr.a,null,r.a.createElement(C.b,null,"Your answer: ",t.answer),r.a.createElement(C.b,null,"Your time: ",t.time/1e3,"sec"),r.a.createElement(C.b,{variant:"subtitle1",align:"left"},"Correct answers"),r.a.createElement(ce.a,null,t.question.correctAnswers.map(function(e,t){return r.a.createElement(ue.a,{key:e},r.a.createElement(de.a,{primary:e}))})),r.a.createElement(C.b,{variant:"subtitle1",align:"left"},"Wrong answers"),r.a.createElement(ce.a,null,t.question.wrongAnswers.map(function(e,t){return r.a.createElement(ue.a,{key:e},r.a.createElement(de.a,{primary:e}))}))))})))),r.a.createElement("div",{className:"quiz-bottom-section"}))}return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"h5"},"Look at the screen.")),r.a.createElement("div",{className:"quiz-bottom-section"}))}}]),t}(n.Component);function ti(e){var t=e.playerData,a=t.hasAnswered&&0===t.currentQuestionScore,n=t.currentQuestionScore>0;return r.a.createElement("div",null,n>0&&r.a.createElement(C.b,{variant:"h5"},"Correct answer!"),a&&r.a.createElement(C.b,{variant:"h5"},"Wrong answer!"),!t.hasAnswered&&r.a.createElement(C.b,{variant:"h5"},"You did not answer the question"),t.hasAnswered&&r.a.createElement("div",null,r.a.createElement(C.b,{variant:"body1"},r.a.createElement("div",null,r.a.createElement("span",null,"Score: ")," ",r.a.createElement("span",{className:"dynamic-text"},t.currentQuestionScore)),r.a.createElement("div",null,r.a.createElement("span",null,"Time: ")," ",r.a.createElement("span",{className:"dynamic-text"},t.answerTime)),r.a.createElement("div",null,r.a.createElement("span",null,"Total score: ")," ",r.a.createElement("span",{className:"dynamic-text"},t.totalScore)))),t.oldLeaderboardPosition!==t.newLeaderboardPosition&&r.a.createElement("div",null,r.a.createElement(C.b,{variant:"body1"},r.a.createElement("span",null,"Old position:"),r.a.createElement("span",null," ",t.oldLeaderboardPosition),r.a.createElement("span",null,"New position: "),r.a.createElement("span",null,t.newLeaderboardPosition))),t.oldLeaderboardPosition===t.newLeaderboardPosition&&r.a.createElement("div",null,r.a.createElement(C.b,{variant:"body1"},r.a.createElement("span",null,"Position: "),r.a.createElement("span",null," ",t.newLeaderboardPosition))))}var ai=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).getPlayerAnswerData=a.getPlayerAnswerData.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getPlayerAnswerData",value:function(){for(var e=this.props,t=e.game,a=e.playerKey,n={totalScore:0,currentQuestionScore:0,newLeaderboardPosition:1,oldLeaderboardPosition:1,answerTime:0,hasAnswered:!1},r=t.quiz.questions[t.quiz.currentQuestion],i=t.players[a],s=0;s<t.quiz.questions.length;s++){var o=t.quiz.questions[s],l=!!i.answers&&i.answers[o.id];l&&(l.questionId===r.id&&(n.hasAnswered=!0,n.currentQuestionScore=l.score,n.answerTime=l.answerTime),n.totalScore+=l.score)}for(var c=t.players?Object.keys(t.players):[],m=0;m<c.length;m++)if(c[m]!==i.key){for(var u=t.players[c[m]],h=0,d=0,p=0;p<t.quiz.questions.length;p++){var g=t.quiz.questions[p],f=!!u.answers&&u.answers[g.id];f&&(f.questionId===r.id&&(d=f.score),h+=f.score)}h>n.totalScore&&(n.newLeaderboardPosition+=1),h-d>n.totalScore-n.currentQuestionScore&&(n.oldLeaderboardPosition+=1)}return n}},{key:"render",value:function(){var e=this.props.game,t=this.getPlayerAnswerData();if(e.quiz.remoteMode){var a;e&&(a=e.quiz.questions[e.quiz.currentQuestion]);var n=a.answers;return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"},r.a.createElement(ti,{playerData:t})),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(x.a,{container:!0},r.a.createElement(x.a,{item:!0,md:6,xs:12},r.a.createElement("div",{className:"quiz-answer-chart"},r.a.createElement(vt,{game:e}))),r.a.createElement(x.a,{item:!0,md:6,xs:12},r.a.createElement("div",null,r.a.createElement(Pt,{game:e}))))),r.a.createElement("div",{className:"quiz-bottom-section"},r.a.createElement(x.a,{container:!0},n.map(function(e,t){return r.a.createElement(x.a,{key:e,item:!0,xs:6},r.a.createElement(at,{answer:e,index:t}))}))))}return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(ti,{playerData:t})),r.a.createElement("div",{className:"quiz-bottom-section"},r.a.createElement(C.b,{variant:"subtitle1"},"Look at the screen to se overall player results")))}}]),t}(n.Component),ni=(n.Component,function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a.saveAnswer=a.saveAnswer.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"saveAnswer",value:function(e){var t=this,a=this.props.game.quiz.questions[this.props.game.quiz.currentQuestion].id;v.database().ref("/games/"+t.props.game.key+"/players/"+this.props.playerKey+"/answers/"+a).set(e,function(e){if(e){t.props.showSnackbar({variant:"error",message:"Unexpected internal error"})}else{t.props.showSnackbar({variant:"success",message:"Successfully updated player!"})}})}},{key:"render",value:function(){var e="final_result"===this.props.game.phase||"end"===this.props.game.phase;return r.a.createElement("div",{className:"play-container"},"connection"===this.props.game.phase&&r.a.createElement(Br,{game:this.props.game,addPlayer:this.props.createPlayer,playerKey:this.props.playerKey}),"starting"===this.props.game.phase&&r.a.createElement(Lr,{game:this.props.game,updatePlayer:this.props.updatePlayer}),"awaiting_question"===this.props.game.phase&&r.a.createElement(Wr,{game:this.props.game,updatePlayer:this.props.updatePlayer}),"show_question"===this.props.game.phase&&r.a.createElement(Kr,{game:this.props.game,updatePlayer:this.props.updatePlayer}),"answer"===this.props.game.phase&&r.a.createElement(Rr,{game:this.props.game,saveAnswer:this.saveAnswer,playerKey:this.props.playerKey}),"result_question"===this.props.game.phase&&r.a.createElement(ai,{game:this.props.game,updatePlayer:this.props.updatePlayer,playerKey:this.props.playerKey}),e&&r.a.createElement(ei,{game:this.props.game,updatePlayer:this.props.updatePlayer,playerKey:this.props.playerKey}))}}]),t}(n.Component));var ri,ii,si=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.state={name:""},a.createPlayer=a.createPlayer.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.playerKey,a=e.game,n=e.addPlayer;!t&&a.minigame.nameGenerator&&n(this.generatePlayer())}},{key:"createPlayer",value:function(){var e=this.state.name;(0,this.props.addPlayer)({name:e,score:0})}},{key:"generatePlayer",value:function(){var e=this.props.game,t=[];return e.players&&(t=Object.values(e.players).map(function(e){return e.name})),{name:function(e){for(var t=["rutig,","antik","arg","lugn","friterad","hemlig","lycklig","gammal","rutten","smidig","vegansk","stark","full","giftig","djurig","artig","smutsig","dum","smart","stilig","snabb","l\xe5ngsam","seg","blygsam","envis","cool","tuff","sp\xe4nnande","farlig"],a=["ninja","stol","pankaka","staty","enh\xf6rning","regnb\xe5ge","kanin","kapten","cupcake","morot","potatis","salad","gardin","toalett","streckgubbe","drake","farmor","mormor","farfar","morfar","mellanchef","r\xf6rmokare","bilf\xf6rs\xe4ljare","skogshuggare","pension\xe4r","cirkus","studdsmatta","clown","mellanchef","busschaff\xf6r","luftballong","boss","tiger"],n="",r=0;r<20;r++){var i="";if(i=r>10?"".concat(t[Math.floor(Math.random()*t.length)]," ").concat(t[Math.floor(Math.random()*t.length)]," ").concat(a[Math.floor(Math.random()*a.length)]):"".concat(t[Math.floor(Math.random()*t.length)]," ").concat(a[Math.floor(Math.random()*a.length)]),!(e.indexOf(i)>-1)){n=i;break}}return n}(t),score:0}}},{key:"render",value:function(){var e=this.props,t=e.game,a=e.playerKey,n=this.state.name,i="";return t.players&&a&&t.players[a]&&(i=t.players[a].name),r.a.createElement("div",{className:"phase-container"},i?r.a.createElement("div",null,r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"h5"},r.a.createElement("span",null,"Welcome "),r.a.createElement("span",{className:"dynamic-text"},i)),r.a.createElement(C.b,{variant:"subtitle1"}," Watch the screen, your name should show.")),r.a.createElement("div",{className:"quiz-bottom-section"})):r.a.createElement("div",null,r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Name",name:"name",value:n,margin:"normal",onChange:this.handleChange("name")})),r.a.createElement(I.a,{onClick:this.createPlayer,variant:"contained"},"done")))}}]),t}(n.Component),oi=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"h5"},"Starting game...")),r.a.createElement("div",{className:"quiz-bottom-section"}))}}]),t}(n.Component),li=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"h5"},"Look at the screen. playerKey")),r.a.createElement("div",{className:"quiz-bottom-section"}))}}]),t}(n.Component),ci=a(228),mi=a.n(ci),ui=a(227),hi=a.n(ui),di=a(226),pi=a.n(di),gi=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleAction=a.handleAction.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"handleAction",value:function(e){var t=this.props,a=t.playerKey,n=t.game,r=n.players[a];v.database().ref("/games/".concat(n.key,"/minigame/snakes/").concat(r.snakeId,"/move")).set(e,function(e){e&&console.log("error updated snake move")})}},{key:"render",value:function(){var e=this,t=this.props,a=t.game,i=t.playerKey,s=a.players[i],o=a.minigame.snakes[s.snakeId],l=o.actions,c=1===o.playerKeys.length?s.name:o.name;return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"player-controlls-container"},l.map(function(t){return r.a.createElement(n.Fragment,{key:t},s.controlActions.includes(t)?r.a.createElement(I.a,{key:t,className:"player-controlls-action player-controlls-".concat(t),onClick:function(){e.handleAction(t)},style:{backgroundColor:o.color}},"up"===t&&r.a.createElement(pi.a,{className:"player-controlls-icon"}),"down"===t&&r.a.createElement($r.a,{className:"player-controlls-icon"}),"right"===t&&r.a.createElement(hi.a,{className:"player-controlls-icon"}),"left"===t&&r.a.createElement(mi.a,{className:"player-controlls-icon"})):r.a.createElement(I.a,{key:t,className:"player-controlls-action player-controlls-".concat(t),style:{backgroundColor:o.color,opacity:.3}},"up"===t&&r.a.createElement(pi.a,{className:"player-controlls-icon"}),"down"===t&&r.a.createElement($r.a,{className:"player-controlls-icon"}),"right"===t&&r.a.createElement(hi.a,{className:"player-controlls-icon"}),"left"===t&&r.a.createElement(mi.a,{className:"player-controlls-icon"})))}),r.a.createElement("div",{className:"player-controlls-action player-controlls-middle"},r.a.createElement(C.b,{variant:"body1"},c))))}}]),t}(n.Component),fi=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"phase-container"},"TetrisController.js h\xe4r  ska jag visa knappar f\xf6r moves. och en metod h\xe4r som tar knapptrycket och updaterar en specifik property i firebase baserat p\xe5 gameid, playerkey etc. m\xe5ste ha med snakeId in i dnena kommmponent?")}}]),t}(n.Component),vi=a(171),yi=a.n(vi),bi=a(346),Ei=a.n(bi),wi=(a(798),a(347)),ki=a.n(wi),Oi=a(348),ji=a.n(Oi),xi=a(349),Ci=a.n(xi),Si=a(350),qi=a.n(Si),Pi=a(351),Ni=a.n(Pi);var zi=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleClick=function(e){a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a.handleChange=function(e){return function(t){var n;a.setState((n={},Object(T.a)(n,e,t.target.value),Object(T.a)(n,"anchorEl",null),n))}},a.handleChangeSelect=function(e){a.setState(Object(T.a)({},e.target.name,e.target.value))};var n=Math.floor(window.innerHeight-180),r=Math.floor(window.innerWidth),i={wood:ki.a,iron:ji.a,putt:Ci.a};return a.state={highestAcceleration:0,isSwinging:!1,swingData:[],clubIndex:0,round:1,canvasHeight:n,strokes:0,canvasWidth:r,anchorEl:null,clubIcons:i},a.renderFrame=a.renderFrame.bind(Object(h.a)(Object(h.a)(a))),a.saveSwing=a.saveSwing.bind(Object(h.a)(Object(h.a)(a))),a.testSwing=a.testSwing.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){return t.round!==e.game.minigame.round?{round:e.game.minigame.round,strokes:0}:null}}]),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;ri=document.getElementById("swingcanvas"),(ii=ri.getContext("2d")).translate(.5,.5);var t=this;ri.addEventListener("touchstart",function(e){var a=e||window.event;a.preventDefault(),a.stopPropagation(),t.setState(function(){return{highestAcceleration:0,swingData:[],isSwinging:!0}})},!1),ri.addEventListener("touchend",function(a){var n=a||window.event;n.preventDefault(),n.stopPropagation();var r=t.state,i=r.highestAcceleration,s=r.clubIndex;t.setState(function(){return{isSwinging:!1}}),e.saveSwing(i,s)},!1),window.addEventListener("devicemotion",function(e){var a=e||window.event;a.preventDefault(),a.stopPropagation();var n=t.state,r=n.isSwinging,i=n.swingData,s=n.highestAcceleration;n.clubIndex;if(r){var o=a.acceleration,l=o.x,c=o.y,m=o.z;i.push({x:Math.round(2*l),y:Math.round(2*c),z:Math.round(2*m)});var u=Math.abs(l),h=Math.abs(m),d=Math.floor(u+h);d>s?t.setState(function(){return{highestAcceleration:d,swingData:i}}):t.setState({swingData:i})}},!0),this.renderFrame()}},{key:"shouldComponentUpdate",value:function(e,t){var a=this.state,n=(a.swingData,a.isSwinging),r=a.strokes,i=a.anchorEl,s=a.clubIndex;if(t.isSwinging!==n)return!0;if(t.strokes!==r)return!0;if(t.anchorEl!==i)return!0;if(t.clubIndex!==s)return!0;var o=this.props,l=o.game,c=o.playerKey;if(e.game.phase!==l.phase)return!0;var m=l.players[c],u=e.game.players[c];return m.state!==u.state}},{key:"testSwing",value:function(){var e=Math.floor(100*Math.random())+10;this.saveSwing(e,2,!0)}},{key:"saveSwing",value:function(e,t,a){var n=this.props,r=n.playerKey,i=n.game,s=this.state.swingData;if("STILL"===i.players[r].state)if("gameplay"===i.phase)if(!function(e){return e.length<10}(s)||a){var o=cn(Ha[t],e);this.setState(function(e){return{strokes:e.strokes+1}}),v.database().ref("/games/".concat(i.key,"/players/").concat(r,"/swing")).set(o,function(e){e?console.log("error updated swing move"):console.log("saved swing success")})}else alert("invalid swing");else alert("game is not playing");else alert("ball is not still")}},{key:"renderFrame",value:function(){var e=this.props,t=e.game,a=e.playerKey,n=(e.classes,this.state),r=n.swingData,i=n.strokes;if(ii){var s=t.players[a];ii.lineWidth=4;var o=new Image;o.src="https://i.imgur.com/DE8oR5A.png",o.onload=function(){ii.clearRect(0,0,ri.width,ri.height),ii.drawImage(o,0,0,ri.width,ri.height);var e,a,n=new Image;n.onload=function(){ii.globalAlpha=.3,ii.drawImage(n,ri.width/4,ri.height/4,ri.width/2,ri.width/2),ii.globalAlpha=1},n.src=Ni.a,function(e){for(var t=e.length,a={y:ri.height/2-2*Wa,x:ri.width/2},n=0;n<t;n++){var r=a.y+Math.round(e[n].z),i=a.x+Math.round(e[n].x);ii.beginPath(),ii.moveTo(a.x,a.y),ii.lineTo(i,r),ii.stroke(),a.y=r,a.x=i}}(r),e=ri.width,a=ri.height,t.minigame.levelColor,ii.fillStyle=Ka,ii.fillRect(0,a-Wa,e,Wa),"STILL"===s.state?(function(e,t,a){ii.font="28px roboto",ii.fillStyle="#000000",ii.textAlign="center",ii.fillText("Slag: ".concat(a),e,t)}(ri.width/2,48,i),function(e,t,a,n,r){ii.lineWidth=1,ii.fillStyle=a,ii.strokeStyle=n,ii.beginPath(),ii.arc(e,t,Wa,0,2*Math.PI),ii.fill(),ii.closePath(),ii.beginPath(),ii.arc(e,t,Wa-ii.lineWidth/2,0,2*Math.PI),ii.stroke(),ii.closePath()}(ri.width/2,ri.height-2*Wa+4,s.color,"gray"),function(e,t,a){ii.font="24px roboto",ii.fillStyle="#000000",ii.textAlign="center",ii.fillText("Distance: ".concat(a," yards"),e,t)}(ri.width/2,24,s.distance)):"SCORED"===s.state&&function(e,t,a,n){ii.font="22px roboto",ii.fillStyle="#000000",ii.textAlign="center",ii.fillText("You scored with ".concat(n," strokes in ").concat(a.scoreTime," seconds"),e,t)}(ri.width/2,36,s,i)}}}},{key:"render",value:function(){var e=this,t=this.props,a=t.game,n=(t.playerKey,t.classes),i=this.state,s=i.highestAcceleration,o=(i.isSwinging,i.canvasHeight),l=i.canvasWidth,c=i.clubIndex,m=i.anchorEl,u=i.clubIcons,h=Boolean(m),d=Ha[c];return this.renderFrame(),r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:n.container},r.a.createElement("canvas",{id:"swingcanvas",className:n.canvas,height:o,width:l}),r.a.createElement("div",{className:n.clubwrapper},r.a.createElement(I.a,{"aria-owns":h?"club-menu":void 0,"aria-haspopup":"true",style:{marginLeft:"-20px",marginRight:"-20px"},onClick:this.handleClick},r.a.createElement("img",{src:qi.a,alt:"choose club",height:"100"})),r.a.createElement(yi.a,{id:"club-menu",anchorEl:m,open:h,onClose:this.handleClose},Ha.map(function(t){return r.a.createElement(Q.a,{onClick:e.handleChange("clubIndex"),key:t.id,value:t.id},r.a.createElement("img",{src:u[t.type],alt:t.name,className:n.menuitemicon}),t.name)})),r.a.createElement(C.b,{variant:"body2",style:{display:"grid",paddingBottom:"8px"}},r.a.createElement("span",null,d.name),r.a.createElement("img",{src:u[d.type],alt:"club",height:"60"}))),r.a.createElement("div",{className:n.footer,style:{backgroundColor:a.minigame.levelColor}},r.a.createElement(Ei.a,{minValue:0,height:174,startColor:"green",ringWidth:40,segments:10,needleTransitionDuration:50,needleTransition:"easeLinear",textColor:"ghostwhite",needleColor:"ghostwhite",endColor:"red",currentValueText:"${value} m/s",maxValue:100,value:s/2})),r.a.createElement("button",{style:{position:"absolute",top:"0",left:"0"},type:"button",onClick:this.testSwing},"swing")))}}]),t}(n.Component),Ti=Object($.withStyles)(function(e){return{container:{height:"100vh",width:"100vw"},canvas:{},header:{height:80},footer:{height:180,marginTop:"-4px"},clubwrapper:{display:"flex",marginTop:"-120px",position:"absolute",alignItems:"flex-end"},menuitemicon:{height:"100%",paddingRight:10}}})(zi);var Gi=Object($.withStyles)(function(e){return{img:{height:64,webkitBboxShadow:"0 0 10px rgba(0,0,0,.3)",boxShadow:"0 0 10px rgba(0,0,0,.3)"},listitem:{},primary:{fontSize:16},dot:{fontSize:"11px",padding:"0 8px"},root:{backgroundColor:"inherit"},header:{backgroundColor:"#282828",padding:10,marginBottom:10}}})(function(e){var t=e.classes,a=e.playlists,n=e.setSelection;if(!a)return null;var i=a.map(function(e){return{name:(t=e).name,id:t.id,img:t.images.length>0?t.images[0]:jn,totalSongs:t.tracks.total,owner:t.owner.display_name};var t});return r.a.createElement("div",null,r.a.createElement(C.b,{className:t.header,variant:"subtitle1"},"Select a playlist"),r.a.createElement(ce.a,{className:t.root},r.a.createElement(x.a,{container:!0},i.map(function(e){return r.a.createElement(x.a,{item:!0,md:4,xs:12,key:e.id},r.a.createElement(ue.a,{button:!0,onClick:function(){return n(e.id)},className:t.listitem},r.a.createElement("img",{src:e.img.url,alt:e.name,className:t.img,onError:function(e){e.target.onerror=null,e.target.src=jn}}),r.a.createElement(de.a,{classes:{primary:t.primary},primary:e.name,secondary:r.a.createElement("span",null,"by ".concat(e.owner),r.a.createElement("span",{className:t.dot},"\u2022"),"".concat(e.totalSongs," songs"))})))}))))}),Mi=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.state={name:"",selectedPlaylist:"",spotifyUser:null,avatar:null,playlists:[],invalidSpotifyToken:!localStorage.getItem("spotifytoken")||Date.now()-localStorage.getItem("spotifytoken_timestamp")>kn},a.createPlayer=a.createPlayer.bind(Object(h.a)(Object(h.a)(a))),a.setPlaylist=a.setPlaylist.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(Mn.a)(Gn.a.mark(function e(){var t,a,n,r,i,s,o,l,c,m,u,h,d,p,g,f;return Gn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.game,a=this.state.invalidSpotifyToken,n=localStorage.getItem("spotifytoken"),a&&("https://accounts.spotify.com/authorize",r=window.location.origin+window.location.pathname,localStorage.setItem("spotify_type","play"),localStorage.setItem("RecentGameIdPlay",t.gameId),window.location="".concat("https://accounts.spotify.com/authorize","?client_id=").concat(On,"&redirect_uri=").concat(r,"&scope=").concat(Cn.join("%20"),"&response_type=token&show_dialog=true")),(i=new Headers).append("Authorization","Bearer ".concat(n)),s={method:"GET",headers:i},e.next=9,fetch("https://api.spotify.com/v1/me",s);case 9:return o=e.sent,e.next=12,o.json();case 12:l=e.sent,c=!0,m=0,u=50,h=[];case 17:if(!c){e.next=28;break}return e.next=20,fetch("https://api.spotify.com/v1/users/".concat(l.id,"/playlists?limit=").concat(u,"&offset=").concat(m),s);case 20:return d=e.sent,e.next=23,d.json();case 23:p=e.sent,h.push.apply(h,Object(z.a)(p.items)),p.items.length<u?c=!1:m+=u,e.next=17;break;case 28:g=Object.values(t.players||{}).map(function(e){return e.playlist}),f=h.filter(function(e){return!g.includes(e.id)&&pr(e)}),this.setState(function(){return{playlists:f,name:l.display_name,avatar:l.images.length>0?l.images[0].url:null}});case 31:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setPlaylist",value:function(e){this.createPlayer(e)}},{key:"createPlayer",value:function(e){var t=this.state,a=t.name,n=t.avatar;(0,this.props.addPlayer)({name:a,playlist:e,score:0,avatar:n}),this.setState({selectedPlaylist:e})}},{key:"render",value:function(){var e=this.props,t=e.game,a=e.playerKey,n=this.state,i=n.playlists,s=n.selectedPlaylist;if(n.invalidSpotifyToken)return r.a.createElement("span",null,"Loading...");var o="";return t.players&&a&&t.players[a]&&(o=t.players[a].name),r.a.createElement("div",{className:"phase-container"},s?r.a.createElement("div",null,r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"},r.a.createElement(C.b,{variant:"h5"},r.a.createElement("span",null,"V\xe4lkommen "),r.a.createElement("span",{className:"dynamic-text"},o)),r.a.createElement(C.b,{variant:"subtitle1",style:{marginTop:15}},"Ditt namn syns nu p\xe5 spelsk\xe4rmen. N\xe4r spelet startar kommer fr\xe5gor att presenteras och du svarar h\xe4r p\xe5 din enhet. Du kan v\xe4lja ett eller flera svarsalternativ. Du f\xe5r ett po\xe4ng f\xf6r varje r\xe4tt svar och ett minus f\xf6r varje felaktigt svar. Du kan inte f\xe5 minuspo\xe4ng p\xe5 en fr\xe5ga.")),r.a.createElement("div",{className:"quiz-bottom-section"})):r.a.createElement("div",null,r.a.createElement(Gi,{setSelection:this.setPlaylist,playlists:i})))}}]),t}(n.Component),Ai=a(352),Ii=a.n(Ai),Fi=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.toggleSearch=function(){a.setState(function(e){return{showSearch:!e.showSearch,searchInput:""}})},a.state={answer:["default"],searchInput:"",showSearch:!1},a.saveAnswer=a.saveAnswer.bind(Object(h.a)(Object(h.a)(a))),a.toggleOption=a.toggleOption.bind(Object(h.a)(Object(h.a)(a))),a.toggleSearch=a.toggleSearch.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){this.saveAnswer()}},{key:"toggleOption",value:function(e){this.setState(function(t){return t.answer.includes(e)?{answer:t.answer.filter(function(t){return t!==e})}:{answer:Object(z.a)(t.answer).concat([e])}})}},{key:"saveAnswer",value:function(){var e=this.state.answer,t=this.props,a=t.game,n=t.playerKey,r={answer:e,question:a.minigame.currentq,playerKey:n};v.database().ref("/games/".concat(a.key,"/answers")).push(r,function(e){e&&alert("error saving answer".concat(e))})}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.game,i=this.state,s=i.answer,o=i.searchInput,l=i.showSearch,c=Object.values(n.players),m=c.length>11,u=c.filter(function(e){return s.includes(e.playerKey)||e.name.toLowerCase().includes(o.toLowerCase())});return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:a.container},r.a.createElement(x.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",className:a.headcontainer},r.a.createElement(x.a,{item:!0},r.a.createElement(C.b,{className:a.header,variant:"subtitle1"},"Markera ditt svar")),r.a.createElement(x.a,{item:!0},l?r.a.createElement(M.a,{value:o,placeholder:"S\xf6k",onChange:this.handleChange("searchInput")}):r.a.createElement(ie.a,{key:"close","aria-label":"Close",color:"inherit",className:a.close,onClick:this.toggleSearch},r.a.createElement(Ii.a,{className:a.icon})))),r.a.createElement(ce.a,{dense:m,className:a.root},r.a.createElement(x.a,{container:!0},u.map(function(t){return r.a.createElement(x.a,{key:t.key,item:!0,md:4,xs:m?6:12},r.a.createElement(ue.a,{button:!0,onClick:function(){return e.toggleOption(t.key)},className:a.listitem},r.a.createElement(Xn.a,null,t.avatar?r.a.createElement(Bn.a,{alt:t.name,src:t.avatar}):r.a.createElement(Bn.a,null,r.a.createElement(Pn.a,null))),s.includes(t.key)?r.a.createElement(de.a,{className:m?a.itemtextDense:a.itemtext,primary:t.name}):r.a.createElement(de.a,{className:m?a.itemtextDense:a.itemtext,secondary:t.name}),r.a.createElement(Mr.a,null,r.a.createElement(Me.a,{onClick:function(){return e.toggleOption(t.key)},color:"primary",checked:s.includes(t.key)}))))})))))}}]),t}(n.Component),_i=Object($.withStyles)(function(e){return{root:{width:"100%"},itemtext:{overflow:"hidden"},header:{padding:10},itemtextDense:{paddingLeft:2,paddingRight:2,overflow:"hidden"},listitem:{paddingLeft:12,paddingRight:38},container:{height:"100vh",width:"100vw"},headcontainer:{backgroundColor:"#282828",marginBottom:10}}})(Fi),Di=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){this.props.game;return r.a.createElement("div",{className:"phase-container"},r.a.createElement("div",{className:"quiz-top-section"}),r.a.createElement("div",{className:"quiz-middle-section"}),r.a.createElement("div",{className:"quiz-bottom-section"},r.a.createElement(C.b,{variant:"subtitle1"},"Kolla p\xe5 spelskr\xe4men f\xf6r att se st\xe4llningen")))}}]),t}(n.Component),Qi=Object($.createMuiTheme)({palette:{type:"dark",primary:{main:"#1DB954"},secondary:{main:"#fff"}},overrides:{MuiButton:{root:{borderRadius:500,padding:"11px 44px",color:"#fff",letterSpacing:".16em",WebkitTransition:"none 33ms cubic-bezier(.3,0,.7,1)",transition:"none 33ms cubic-bezier(.3,0,.7,1)",WebkitTransitionProperty:"all",transitionProperty:"all",touchAction:"manipulation",willChange:"transform",lineHeight:1.6,minWidth:130,margin:10,fontWeight:300,fontSize:11,"&:hover":{WebkitTransition:"none 33ms cubic-bezier(.3,0,0,1)",transition:"none 33ms cubic-bezier(.3,0,0,1)",WebkitTransitionProperty:"all",transitionProperty:"all",WebkitTransform:"scale(1.06)",transform:"scale(1.06)"}},textPrimary:{backgroundColor:"#1DB954",color:"#fff","&:hover":{backgroundColor:"#1ed760"}},textSecondary:{backgroundColor:"rgba(24,24,24,.7)","&:hover":{backgroundColor:"rgba(24,24,24,.7)",webkitBoxShadow:"inset 0 0 0 2px #fff, 0 0 0 1px rgba(0,0,0,0)",boxShadow:"inset 0 0 0 2px #fff, 0 0 0 1px rgba(0,0,0,0)"},webkitBoxShadow:"inset 0 0 0 2px #b3b3b3",boxShadow:"inset 0 0 0 2px #b3b3b3"}}}}),Bi=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.game,a=e.playerKey,n=e.createPlayer,i="final_result"===t.phase||"end"===t.phase;switch(t.gametype){case"snake":return r.a.createElement("div",{className:"play-container"},"connection"===t.phase&&r.a.createElement(si,{game:t,addPlayer:n,playerKey:a}),"starting"===t.phase&&r.a.createElement(oi,{game:t}),"gameplay"===t.phase&&r.a.createElement(gi,{game:t,playerKey:a}),i&&r.a.createElement(li,{game:t,playerKey:a}));case"tetris":return r.a.createElement("div",{className:"play-container"},"connection"===t.phase&&r.a.createElement(si,{game:t,addPlayer:n,playerKey:a}),"starting"===t.phase&&r.a.createElement(oi,{game:t}),"gameplay"===t.phase&&r.a.createElement(fi,{game:t}),i&&r.a.createElement(li,{game:t,playerKey:a}));case"golf":return r.a.createElement("div",{className:"play-container"},"connection"===t.phase&&r.a.createElement(si,{game:t,addPlayer:n,playerKey:a}),"starting"===t.phase&&r.a.createElement(oi,{game:t}),("gameplay"===t.phase||"level_completed"===t.phase)&&r.a.createElement(Ti,{game:t,playerKey:a}),i&&r.a.createElement(li,{game:t,playerKey:a}));case"spotify":return document.querySelector("body").classList.add("dark-mode"),r.a.createElement($.MuiThemeProvider,{theme:Qi},r.a.createElement("div",{className:"play-container"},"connection"===t.phase&&r.a.createElement(Mi,{game:t,addPlayer:n,playerKey:a}),"gameplay"===t.phase&&r.a.createElement(_i,{game:t,playerKey:a}),"level_completed"===t.phase&&r.a.createElement(Di,{game:t,playerKey:a}),i&&r.a.createElement(li,{game:t,playerKey:a})));default:return null}}}]),t}(n.PureComponent);function Li(e,t){v.database().ref("games").orderByChild("gameId").equalTo(e).once("value",t)}var Wi=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(T.a)({},e,t.target.value))}},a.state={game:{},gameId:"",recentGameId:localStorage.getItem("RecentGameIdPlay")||"",playerKey:"",recentGame:null,isRedirected:Date.now()-localStorage.getItem("spotifytoken_timestamp")<2e3},a.createPlayer=a.createPlayer.bind(Object(h.a)(Object(h.a)(a))),a.joinGame=a.joinGame.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state,a=t.recentGameId;t.isRedirected&&this.joinGame(a),a&&Li(a,function(t){var a;t.val()&&(t.forEach(function(e){a=e.val()}),"IN_PROGRESS"===a.status&&e.setState({recentGame:a}))})}},{key:"joinGame",value:function(e){var t=this.props,a=t.showSnackbar,n=t.toggleHeader,r=this;Li(e,function(e){if(e.val()){var t;if(e.forEach(function(e){t=e.val()}),"connection"===t.phase){var i=localStorage.getItem("RecentPlayerKey");i&&t.players&&t.players[i]&&r.setState({playerKey:i}),r.initGameListiner(t.key);a({variant:"success",message:"Connected to game"}),n(!1)}else if("setup"===t.phase){a({variant:"error",message:"Game is not yet started"})}else{var s=localStorage.getItem("RecentPlayerKey");if(s&&t.players&&t.players[s]){r.setState({playerKey:s}),localStorage.setItem("RecentGameIdPlay",t.gameId),r.initGameListiner(t.key);a({variant:"success",message:"Connected to game"}),n(!1)}else{a({variant:"error",message:"Game is in progress"})}}}else{a({variant:"info",message:"No game found"})}})}},{key:"initGameListiner",value:function(e){var t=v.database().ref("games/".concat(e)),a=this;t.on("value",function(e){var t=e.val();t?a.setState({game:t}):a.setState({game:""})})}},{key:"createPlayer",value:function(e){var t=this.state.game,a=this.props.showSnackbar,n=v.database().ref("/games/".concat(t.key,"/players")).push(),r=Object.assign({key:n.key},e),i=this;n.set(r,function(e){if(e){a({variant:"error",message:"Unexpected internal error"})}else i.setState({playerKey:r.key}),localStorage.setItem("RecentPlayerKey",r.key)})}},{key:"render",value:function(){var e=this,t=this.state,a=t.game,n=t.playerKey,i=t.gameId,s=t.recentGameId,o=t.recentGame,l=t.isRedirected,c=this.props.showSnackbar,m={golf:r.a.createElement(_r.a,null),spotify:r.a.createElement(Qr.a,null),quiz:r.a.createElement(Ir.a,null),snake:r.a.createElement(Ir.a,null)};return!a.phase&&l?r.a.createElement("div",null,r.a.createElement("span",null,"Loading...")):a.phase?r.a.createElement("div",{className:"page-container play-page"},"quiz"===a.gametype&&r.a.createElement(ni,{game:a,createPlayer:this.createPlayer,playerKey:n,showSnackbar:c}),"snake"===a.gametype&&r.a.createElement(Bi,{game:a,createPlayer:this.createPlayer,playerKey:n,showSnackbar:c}),"tetris"===a.gametype&&r.a.createElement(Bi,{game:a,createPlayer:this.createPlayer,playerKey:n,showSnackbar:c}),"golf"===a.gametype&&r.a.createElement(Bi,{game:a,createPlayer:this.createPlayer,playerKey:n,showSnackbar:c}),"spotify"===a.gametype&&r.a.createElement(Bi,{game:a,createPlayer:this.createPlayer,playerKey:n,showSnackbar:c})):r.a.createElement("div",{className:"page-container play-page"},r.a.createElement("div",null,r.a.createElement(L.a,null,r.a.createElement(M.a,{label:"Game PIN",name:"Game ID",value:i,margin:"normal",onChange:this.handleChange("gameId")})),r.a.createElement(I.a,{onClick:function(){return e.joinGame(i)},variant:"contained"},"Join")),o&&r.a.createElement("div",null,r.a.createElement(ce.a,null,r.a.createElement(ue.a,null,r.a.createElement(Xn.a,null,r.a.createElement(Bn.a,null,m[o.gametype])),r.a.createElement(de.a,{primary:o.title,secondary:o.gameId}),r.a.createElement(Mr.a,null,r.a.createElement(ie.a,{"aria-label":"reconnect",onClick:function(){return e.joinGame(s)}},r.a.createElement(C.b,null,"reconnect")))))))}}]),t}(n.Component),Ki=a(811),Ri=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={};var n=localStorage.getItem("spotifytoken_timestamp"),r=localStorage.getItem("spotify_type");return Date.now()-n<2e3&&r&&e.history.push("/".concat(r)),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"app-page home-page"},r.a.createElement(x.a,{container:!0,spacing:24},r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(C.b,{variant:"h3"},"Welcome to stagehoot")),r.a.createElement(x.a,{item:!0,xs:12,sm:6},r.a.createElement(y.a,{to:"/play"},r.a.createElement(C.a,{className:"card-button"},r.a.createElement(q.a,{title:"Play"}),r.a.createElement(N.a,null,r.a.createElement(C.b,{variant:"subtitle1",align:"center"},"Connect to a game as player"))))),r.a.createElement(x.a,{item:!0,xs:12,sm:6},r.a.createElement(y.a,{to:"/host"},r.a.createElement(C.a,{className:"card-button"},r.a.createElement(q.a,{title:"Host"}),r.a.createElement(N.a,null,r.a.createElement(C.b,{variant:"subtitle1",align:"center"},"Host a created game using game pin"))))),r.a.createElement(x.a,{item:!0,xs:12},r.a.createElement(y.a,{to:"/create"},r.a.createElement(C.a,{className:"card-button"},r.a.createElement(q.a,{title:"Create"}),r.a.createElement(N.a,null,r.a.createElement(C.b,{variant:"subtitle1",align:"center"},"Setup a new game and recive a related game pin")))))))}}]),t}(n.Component),Hi=Object(Ki.a)(Ri),Vi=a(364),Ui=a(357),Yi=a.n(Ui),Ji=a(359),Zi=a.n(Ji),Xi=a(360),$i=a.n(Xi),es=a(363),ts=a.n(es),as=a(361),ns=a.n(as),rs=a(362),is=a.n(rs),ss=a(172),os=a.n(ss),ls=a(131),cs=a.n(ls),ms=a(358),us=a.n(ms),hs={success:Yi.a,warning:us.a,error:Zi.a,info:$i.a};var ds=Object($.withStyles)(function(e){return{success:{backgroundColor:ns.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.dark},warning:{backgroundColor:is.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing.unit},message:{display:"flex",alignItems:"center"}}})(function(e){var t=e.classes,a=e.message,n=e.onClose,i=e.variant,s=Object(Vi.a)(e,["classes","message","onClose","variant"]),o=hs[i];return r.a.createElement(cs.a,Object.assign({className:t[i],"aria-describedby":"client-snackbar",message:r.a.createElement("span",{id:"client-snackbar",className:t.message},r.a.createElement(o,{className:te()(t.icon,t.iconVariant)}),a),action:[r.a.createElement(ie.a,{key:"close","aria-label":"Close",color:"inherit",className:t.close,onClick:n},r.a.createElement(ts.a,{className:t.icon}))]},s))}),ps=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).handleClose=function(e){var t=a.props.hideSnackbar;"clickaway"!==e&&t()},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.snack;return r.a.createElement("div",null,r.a.createElement(os.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:e.open,autoHideDuration:6e3,onClose:this.handleClose},r.a.createElement(ds,{onClose:this.handleClose,variant:e.variant,message:e.message})))}}]),t}(r.a.Component),gs=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={snack:"",showHeader:!0};var n=window.location.hash.substring(1).split("&").reduce(function(e,t){if(t){var a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}return e},{});return window.location.hash="",n.access_token&&(localStorage.setItem("spotifytoken",n.access_token),localStorage.setItem("spotifytoken_timestamp",Date.now())),a.showSnackbar=a.showSnackbar.bind(Object(h.a)(Object(h.a)(a))),a.hideSnackbar=a.hideSnackbar.bind(Object(h.a)(Object(h.a)(a))),a.toggleHeader=a.toggleHeader.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"hideSnackbar",value:function(){var e=this.state.snack;e.open=!1,this.setState({snack:e})}},{key:"showSnackbar",value:function(e){e.open=!0,this.setState({snack:e})}},{key:"toggleHeader",value:function(e){this.setState({showHeader:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(d.a,null,r.a.createElement("div",{className:"App"},this.state.showHeader&&r.a.createElement(O,null),r.a.createElement("div",{id:"content"},r.a.createElement(p.a,{exact:!0,path:"/play",render:function(){return r.a.createElement(Wi,{showSnackbar:e.showSnackbar,toggleHeader:e.toggleHeader})}}),r.a.createElement(p.a,{exact:!0,path:"/host",render:function(){return r.a.createElement(Tr,{showSnackbar:e.showSnackbar,toggleHeader:e.toggleHeader})}}),r.a.createElement(p.a,{exact:!0,path:"/create",render:function(){return r.a.createElement(Fe,{showSnackbar:e.showSnackbar})}}),r.a.createElement(p.a,{exact:!0,path:"/",render:function(){return r.a.createElement(Hi,null)}})),this.state.snack&&r.a.createElement(ps,{snack:this.state.snack,hideSnackbar:this.hideSnackbar})))}}]),t}(n.Component);s.a.render(r.a.createElement(gs,null),document.getElementById("root"))}},[[406,2,1]]]);
//# sourceMappingURL=main.29af4c45.chunk.js.map